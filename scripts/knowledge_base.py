"""
Comprehensive Bash Command Knowledge Base

This module provides a structured database of bash commands, operators, and concepts
for educational purposes. All content is curated for learning bash from real usage patterns.
"""

from typing import Dict, Set, List, Any

# Command categories with their associated utilities
CATEGORY_MAPPINGS: Dict[str, Set[str]] = {
    "File System": {
        "ls", "cd", "pwd", "mkdir", "rmdir", "rm", "cp", "mv", "touch",
        "cat", "less", "more", "head", "tail", "file", "stat", "ln",
        "readlink", "realpath", "basename", "dirname", "tree", "du", "df",
        "mount", "umount", "fdisk", "mkfs", "fsck", "lsblk", "blkid",
        "find", "locate", "updatedb", "which", "whereis", "type",
    },
    "Text Processing": {
        "grep", "egrep", "fgrep", "sed", "awk", "gawk", "cut", "paste",
        "sort", "uniq", "wc", "tr", "tee", "xargs", "split", "csplit",
        "join", "comm", "diff", "patch", "cmp", "od", "hexdump", "xxd",
        "strings", "expand", "unexpand", "fold", "fmt", "pr", "nl",
        "column", "rev", "shuf", "head", "tail", "tac",
    },
    "Git": {
        "git", "gh", "hub", "tig", "gitk", "git-lfs",
    },
    "Package Management": {
        "apt", "apt-get", "apt-cache", "dpkg", "snap", "flatpak",
        "yum", "dnf", "rpm", "zypper", "pacman", "yay", "paru",
        "brew", "port", "pkg", "apk",
        "npm", "npx", "yarn", "pnpm", "bun",
        "pip", "pip3", "pipx", "conda", "poetry", "uv",
        "cargo", "rustup", "gem", "bundle", "composer", "go",
        "nuget", "dotnet", "mvn", "gradle",
    },
    "Process & System": {
        "ps", "top", "htop", "btop", "atop", "kill", "killall", "pkill",
        "pgrep", "nice", "renice", "nohup", "bg", "fg", "jobs", "disown",
        "screen", "tmux", "byobu", "systemctl", "service", "journalctl",
        "dmesg", "uptime", "free", "vmstat", "iostat", "mpstat", "sar",
        "lsof", "fuser", "strace", "ltrace", "perf", "time", "timeout",
        "watch", "wait", "sleep", "cron", "crontab", "at", "batch",
        "shutdown", "reboot", "halt", "poweroff", "init", "runlevel",
        "uname", "hostname", "hostnamectl", "timedatectl", "localectl",
    },
    "Networking": {
        "curl", "wget", "httpie", "http", "ssh", "scp", "sftp", "rsync",
        "ftp", "tftp", "nc", "netcat", "ncat", "socat", "telnet",
        "ping", "traceroute", "tracepath", "mtr", "dig", "nslookup", "host",
        "ip", "ifconfig", "route", "netstat", "ss", "arp", "arping",
        "iptables", "nft", "ufw", "firewall-cmd", "tcpdump", "wireshark",
        "nmap", "masscan", "nikto", "whois", "openssl", "certbot",
    },
    "Permissions": {
        "chmod", "chown", "chgrp", "umask", "getfacl", "setfacl",
        "sudo", "su", "doas", "chroot", "newgrp", "id", "whoami",
        "groups", "users", "who", "w", "last", "lastlog", "finger",
        "useradd", "userdel", "usermod", "groupadd", "groupdel", "groupmod",
        "passwd", "chpasswd", "pwck", "grpck", "vipw", "vigr",
    },
    "Compression": {
        "tar", "gzip", "gunzip", "bzip2", "bunzip2", "xz", "unxz",
        "zip", "unzip", "7z", "7za", "rar", "unrar", "zstd",
        "compress", "uncompress", "lz4", "lzop", "zcat", "bzcat", "xzcat",
    },
    "Search & Navigation": {
        "find", "locate", "mlocate", "plocate", "updatedb", "which",
        "whereis", "type", "command", "hash", "apropos", "whatis", "man",
        "info", "help", "ag", "rg", "ripgrep", "ack", "fzf", "fd",
        "tree", "exa", "lsd", "broot", "ranger", "mc", "nnn", "lf",
    },
    "Development": {
        "make", "cmake", "ninja", "meson", "autoconf", "automake",
        "gcc", "g++", "clang", "clang++", "cc", "ld", "as", "ar",
        "python", "python3", "python2", "node", "deno", "bun",
        "ruby", "perl", "php", "java", "javac", "kotlin", "scala",
        "go", "rust", "rustc", "cargo", "swift", "swiftc",
        "gdb", "lldb", "valgrind", "objdump", "nm", "readelf", "ldd",
        "docker", "docker-compose", "podman", "kubectl", "helm", "minikube",
        "vagrant", "terraform", "ansible", "puppet", "chef",
        "code", "vim", "nvim", "nano", "emacs", "ed", "ex", "vi",
        "jq", "yq", "xmllint", "xsltproc", "jsonnet",
    },
    "Shell Builtins": {
        "echo", "printf", "read", "source", ".", "exec", "eval", "set",
        "unset", "export", "declare", "local", "readonly", "typeset",
        "alias", "unalias", "builtin", "command", "enable", "hash",
        "cd", "pwd", "pushd", "popd", "dirs", "shopt", "bind",
        "history", "fc", "true", "false", "test", "[", "[[", "exit",
        "return", "break", "continue", "shift", "getopts", "trap",
        "ulimit", "times", "let", ":", "compgen", "complete", "compopt",
        "cmd.exe", "cmd", "start", "where", "type",
        "session-slides", "learn-bash", "bash-learner", "claude",
    },
}

# Build reverse mapping: command -> category
COMMAND_TO_CATEGORY: Dict[str, str] = {}
for category, commands in CATEGORY_MAPPINGS.items():
    for cmd in commands:
        COMMAND_TO_CATEGORY[cmd] = category

# Operators and special constructs that increase complexity
PIPE_OPERATORS = {"|", "|&"}
REDIRECT_OPERATORS = {">", ">>", "<", "<<", "<<<", "2>", "2>>", "&>", "&>>", "2>&1", ">&2"}
COMPOUND_OPERATORS = {"&&", "||", ";"}
SUBSHELL_MARKERS = {"$(", "`", "(", ")"}
PROCESS_SUBSTITUTION = {"<(", ">("}

# Command patterns that indicate higher complexity
LOOP_KEYWORDS = {"for", "while", "until", "do", "done"}
CONDITIONAL_KEYWORDS = {"if", "then", "else", "elif", "fi", "case", "esac"}
FUNCTION_KEYWORDS = {"function", "()"}

# Common flag patterns by complexity contribution
SIMPLE_FLAGS = {"-h", "--help", "-v", "--version", "-q", "--quiet"}
MODERATE_FLAGS = {"-r", "-R", "--recursive", "-f", "--force", "-a", "--all"}
COMPLEX_FLAGS = {"-e", "--regex", "-P", "--perl-regexp", "-E", "--extended-regexp"}

# Categories ordered by typical learning progression
LEARNING_ORDER: List[str] = [
    "Shell Builtins",
    "File System",
    "Search & Navigation",
    "Text Processing",
    "Permissions",
    "Compression",
    "Process & System",
    "Git",
    "Package Management",
    "Development",
    "Networking",
]

def get_category(command: str) -> str:
    """Get the category for a given base command."""
    return COMMAND_TO_CATEGORY.get(command, "Unknown")

def get_all_categories() -> List[str]:
    """Get all category names in learning order."""
    return LEARNING_ORDER.copy()

def get_commands_in_category(category: str) -> Set[str]:
    """Get all commands in a specific category."""
    return CATEGORY_MAPPINGS.get(category, set()).copy()


# =============================================================================
# COMPREHENSIVE COMMAND DATABASE
# =============================================================================

COMMAND_DB: Dict[str, Dict[str, Any]] = {
    "ls": {
        "description": "List directory contents with various formatting and filtering options. Essential for orienting yourself in the filesystem - use flags like -l for detailed permissions/sizes, -a to reveal hidden dotfiles, and -t to sort by modification time.",
        "man_url": "https://man7.org/linux/man-pages/man1/ls.1.html",
        "flags": {
            "-l": "Long format with permissions, owner, size, and modification time",
            "-a": "Show all files including hidden (dotfiles)",
            "-A": "Show almost all (exclude . and ..)",
            "-h": "Human-readable sizes (1K, 234M, 2G)",
            "-R": "Recursive listing of subdirectories",
            "-t": "Sort by modification time, newest first",
            "-r": "Reverse sort order",
            "-S": "Sort by file size, largest first",
            "-1": "One file per line",
            "-d": "List directories themselves, not their contents",
        
            "-i": "Show inode numbers",
            "--group-directories-first": "List directories before files",
        },
        "common_patterns": ["ls -la", "ls -lah", "ls -lt", "ls *.txt", "ls -d */"],
        "use_cases": [
            "Quickly see what files exist in a directory before operating on them",
            "Check file permissions and ownership with ls -la",
            "Find recently modified files with ls -lt to debug or audit changes",
        ],
        "gotchas": [
            "ls output is meant for humans, not scripts - use find or glob patterns in scripts instead, since ls behaves unpredictably with special characters in filenames",
            "Hidden files (starting with .) are invisible by default - you must pass -a or -A to see them",
        ],
        "related": ["find", "tree", "dir"],
        "difficulty": "beginner",
    },
    "cd": {
        "description": "Change the current working directory, which affects all subsequent commands that use relative paths. This is the primary way you navigate the filesystem in a shell session - cd alone goes home, cd - returns to your previous directory, and cd .. moves up one level.",
        "man_url": "https://man7.org/linux/man-pages/man1/cd.1p.html",
        "flags": {
            "-": "Change to previous directory ($OLDPWD)",
            "-P": "Use physical directory structure (resolve symlinks)",
            "-L": "Use logical directory structure (follow symlinks, default)",
        },
        "common_patterns": ["cd ~", "cd ..", "cd -", "cd /path/to/dir"],
        "use_cases": [
            "Navigate into a project directory before running build commands",
            "Use cd - to toggle between two directories you are working in simultaneously",
            "Jump to your home directory with cd or cd ~ to access personal config files",
        ],
        "gotchas": [
            "cd in a subshell or script does not affect the parent shell - if you run cd inside a pipeline or $(), your prompt stays where it was",
            "Forgetting to quote paths with spaces will split the argument and fail - use cd \"my folder\" not cd my folder",
        ],
        "related": ["pushd", "popd", "pwd"],
        "difficulty": "beginner",
    },
    "pwd": {
        "description": "Print the absolute path of your current working directory, giving you an unambiguous location in the filesystem. Especially useful in scripts to capture the working directory into a variable, or to confirm where you are after a complex series of cd commands.",
        "man_url": "https://man7.org/linux/man-pages/man1/pwd.1.html",
        "flags": {
            "-L": "Print logical path (with symlinks)",
            "-P": "Print physical path (resolved symlinks)",
        },
        "common_patterns": ["pwd", "echo $(pwd)"],
        "use_cases": [
            "Verify your location before running destructive commands like rm -rf",
            "Capture the current directory in a script variable with DIR=$(pwd) for later reference",
            "Debug path issues when relative paths are not resolving as expected",
        ],
        "gotchas": [
            "pwd -P resolves symlinks to show the physical path, while the default may show the logical path through symlinks - this distinction matters when symlinking build directories",
            "In some shells, pwd is a built-in that may behave differently from /bin/pwd regarding symlink resolution",
        ],
        "related": ["cd", "realpath", "dirname"],
        "difficulty": "beginner",
    },
    "find": {
        "description": "Recursively search for files and directories matching criteria like name, type, size, modification time, and permissions - the Swiss Army knife of filesystem queries. Unlike ls, find walks entire directory trees and can execute commands on each match via -exec, making it indispensable for batch operations.",
        "man_url": "https://man7.org/linux/man-pages/man1/find.1.html",
        "flags": {
            "-name": "Match filename pattern (case-sensitive)",
            "-iname": "Match filename pattern (case-insensitive)",
            "-type": "File type: f=file, d=directory, l=symlink",
            "-size": "File size (+10M = larger than 10MB)",
            "-mtime": "Modified time in days (-1 = last 24h)",
            "-exec": "Execute command on each match",
            "-delete": "Delete matching files",
            "-maxdepth": "Maximum directory depth to search",
            "-empty": "Match empty files or directories",
            "-print0": "Print with null delimiter (for xargs -0)",
        
            "-newer": "Find files newer than a reference file",
            "-regextype": "Specify regex dialect for -regex (posix-extended, etc.)",
        },
        "common_patterns": [
            "find . -name '*.py'",
            "find . -type f -name '*.log' -delete",
            "find . -mtime -1",
            "find . -size +100M",
            "find . -name '*.txt' -exec grep -l 'pattern' {} \\;",
        ],
        "use_cases": [
            "Find all .log files older than 30 days for cleanup with find /var/log -name '*.log' -mtime +30",
            "Locate files by size to find space hogs with find / -size +100M",
            "Batch-rename or batch-process files using -exec or piping to xargs",
        ],
        "gotchas": [
            "Forgetting -name quotes leads to shell glob expansion before find sees the pattern - always quote patterns like '*.txt'",
            "Using -exec with {} \\; runs one process per match which is slow - use -exec {} + or pipe to xargs for batching",
        ],
        "related": ["locate", "xargs", "ls"],
        "difficulty": "intermediate",
    },
    "tree": {
        "description": "Display directory structure as a tree",
        "man_url": "https://linux.die.net/man/1/tree",
        "flags": {
            "-L": "Limit depth of directory tree",
            "-a": "Show all files including hidden",
            "-d": "List directories only",
            "-h": "Print size in human-readable format",
            "-I": "Exclude pattern from listing",
            "--gitignore": "Filter using .gitignore rules",
        },
        "common_patterns": ["tree -L 2", "tree -d", "tree -a -I 'node_modules|.git'"],
    
        "use_cases": [
            "Visualize directory structure: tree -L 2",
            "Show only directories: tree -d",
            "Show files with sizes: tree -sh --du",
        ],
        "gotchas": [
            "tree is not installed by default on many systems -- install it via package manager",
            "Running tree on large directories without -L produces enormous output",
            "tree output is not easily parseable -- use find for scripting",
        ],
        "related": ["ls", "find", "du", "exa"],
        "difficulty": "beginner",
    },
    "du": {
        "description": "Estimate the disk space used by files and directories, recursively summarizing subdirectory sizes to help you find what is consuming storage. Use -h for human-readable sizes, -s for a summary total, and --max-depth to control recursion level.",
        "man_url": "https://man7.org/linux/man-pages/man1/du.1.html",
        "flags": {
            "-h": "Human-readable sizes",
            "-s": "Summary only (total for each argument)",
            "-a": "Show all files, not just directories",
            "-c": "Produce grand total",
            "--max-depth": "Maximum directory depth",
        
            "--exclude": "Exclude files matching a pattern",
        },
        "common_patterns": ["du -sh *", "du -sh .", "du -h --max-depth=1", "du -sh */ | sort -h"],
        "use_cases": [
            "Find the largest directories with du -sh */ | sort -rh | head -10 to diagnose disk space issues",
            "Get the total size of a project with du -sh project/ for a quick summary",
            "Identify space hogs at a specific depth with du -h --max-depth=2 /home/ to balance detail and readability",
        ],
        "gotchas": [
            "du reports disk usage (allocated blocks) not file size - a 1-byte file may show as 4K due to filesystem block size",
            "du follows symlinks by default on some systems, which can count the same data twice - use -P to avoid following symlinks",
        ],
        "related": ["df", "ncdu", "ls"],
        "difficulty": "beginner",
    },
    "df": {
        "description": "Report how much disk space is available and used on all mounted filesystems, giving you a quick overview of storage capacity across your system. Use -h for human-readable output and -i for inode usage, which can be exhausted even when disk space remains.",
        "man_url": "https://man7.org/linux/man-pages/man1/df.1.html",
        "flags": {
            "-h": "Human-readable sizes",
            "-T": "Show filesystem type",
            "-i": "Show inode information instead of block usage",
        
            "--total": "Show a grand total at the bottom",
        },
        "common_patterns": ["df -h", "df -hT", "df -h /"],
        "use_cases": [
            "Check available disk space on all mounts with df -h for a quick system overview",
            "Monitor a specific mount point with df -h /home to see how a particular partition is filling up",
            "Check inode usage with df -i when you are running out of files despite having free space",
        ],
        "gotchas": [
            "df shows filesystem-level space, which includes reserved blocks (typically 5% reserved for root) - available space may be less than total minus used",
            "df reports mounted filesystem usage, so unmounted partitions or network drives will not appear unless they are currently mounted",
        ],
        "related": ["du", "mount", "lsblk"],
        "difficulty": "beginner",
    },
    "mkdir": {
        "description": "Create new directories in the filesystem - use the -p flag to create the entire parent chain at once and suppress errors if the directory already exists. This is one of the first commands you learn, but the -p flag is what makes it robust in scripts.",
        "man_url": "https://man7.org/linux/man-pages/man1/mkdir.1.html",
        "flags": {
            "-p": "Create parent directories as needed, no error if exists",
            "-v": "Verbose, print each directory created",
            "-m": "Set permission mode (like chmod)",
        },
        "common_patterns": ["mkdir -p src/components/ui", "mkdir -pv new/nested/dir"],
        "use_cases": [
            "Create a nested project structure in one command with mkdir -p src/{components,utils,tests}",
            "Safely ensure a directory exists in a script with mkdir -p /var/log/myapp before writing logs",
            "Create multiple directories at once with mkdir dir1 dir2 dir3",
        ],
        "gotchas": [
            "Without -p, mkdir fails if parent directories do not exist or if the target already exists, which breaks scripts",
            "Permissions of newly created directories are affected by your umask - use -m to set explicit permissions like mkdir -m 755 secure_dir",
        ],
        "related": ["rmdir", "install", "touch"],
        "difficulty": "beginner",
    },
    "rm": {
        "description": "Remove files and directories permanently - there is no trash can or undo in the shell, so deleted files are gone for good unless you have backups. Use -r for recursive directory removal and -f to force without prompting, but combine them with extreme caution.",
        "man_url": "https://man7.org/linux/man-pages/man1/rm.1.html",
        "flags": {
            "-r": "Remove directories recursively",
            "-f": "Force, ignore nonexistent files, never prompt",
            "-i": "Interactive, prompt before each removal",
            "-v": "Verbose, explain what is being done",
        
            "-I": "Prompt once before removing more than 3 files or recursing",
            "--preserve-root": "Refuse to operate on / (default on modern GNU rm)",
        },
        "common_patterns": ["rm file.txt", "rm -rf directory/", "rm -i *.log"],
        "use_cases": [
            "Delete a specific file with rm unwanted_file.txt",
            "Remove a directory and all its contents with rm -rf build/ to clean build artifacts",
            "Interactively confirm each deletion with rm -i *.tmp to avoid accidental removal",
        ],
        "gotchas": [
            "rm -rf with a variable like rm -rf $DIR/ is catastrophic if DIR is empty or unset - it becomes rm -rf / which destroys everything; always quote and validate variables",
            "There is no recycle bin - rm is permanent; consider using trash-cli or aliasing rm to a safer wrapper on shared systems",
        ],
        "related": ["rmdir", "find", "shred"],
        "difficulty": "beginner",
    },
    "cp": {
        "description": "Copy files and directories from source to destination, creating a new independent copy of the data. Use -r for recursive directory copies, -p to preserve permissions and timestamps, and -a for archival copies that maintain all file attributes and symlinks.",
        "man_url": "https://man7.org/linux/man-pages/man1/cp.1.html",
        "flags": {
            "-r": "Copy directories recursively",
            "-a": "Archive mode (preserve all: -dR --preserve=all)",
            "-i": "Interactive, prompt before overwrite",
            "-n": "No clobber, don't overwrite existing",
            "-u": "Update, copy only when source is newer",
            "-v": "Verbose, explain what is being done",
        
            "--reflink": "Use copy-on-write if supported by the filesystem (instant, space-efficient)",
        },
        "common_patterns": ["cp file.txt backup.txt", "cp -r src/ dest/", "cp -a project/ backup/"],
        "use_cases": [
            "Make a backup of a config before editing with cp config.yaml config.yaml.bak",
            "Copy an entire directory tree with cp -a project/ project_backup/",
            "Copy multiple files into a directory with cp file1.txt file2.txt dest/",
        ],
        "gotchas": [
            "Forgetting -r when copying directories silently skips them or errors out - always use cp -r for directory copies",
            "cp overwrites the destination without warning by default - use cp -i for interactive confirmation or cp -n to never overwrite",
        ],
        "related": ["mv", "rsync", "scp"],
        "difficulty": "beginner",
    },
    "mv": {
        "description": "Move files or directories to a new location, or rename them in place - unlike cp, the original is removed after the move. On the same filesystem, mv is nearly instant because it only updates directory entries rather than copying data.",
        "man_url": "https://man7.org/linux/man-pages/man1/mv.1.html",
        "flags": {
            "-i": "Interactive, prompt before overwrite",
            "-n": "No clobber, don't overwrite existing",
            "-u": "Update, move only when source is newer",
            "-v": "Verbose, explain what is being done",
        
            "-t": "Specify the target directory (useful with xargs)",
        },
        "common_patterns": ["mv old.txt new.txt", "mv file.txt directory/", "mv -v *.log archive/"],
        "use_cases": [
            "Rename a file with mv old_name.py new_name.py",
            "Move files into an organized directory structure with mv *.jpg photos/",
            "Bulk-rename with a loop like for f in *.txt; do mv \"$f\" \"${f%.txt}.md\"; done",
        ],
        "gotchas": [
            "mv overwrites the destination without warning by default - use mv -i to prompt before overwriting or mv -n to never overwrite",
            "Moving files across filesystems is actually a copy-then-delete, which is slower and can fail mid-way leaving files in both locations",
        ],
        "related": ["cp", "rename", "rsync"],
        "difficulty": "beginner",
    },
    "touch": {
        "description": "Create an empty file if it does not exist, or update the access and modification timestamps of an existing file without changing its contents. Most commonly used to create placeholder files, but its timestamp-updating behavior is essential for build systems and make targets.",
        "man_url": "https://man7.org/linux/man-pages/man1/touch.1.html",
        "flags": {
            "-a": "Change only access time",
            "-m": "Change only modification time",
            "-c": "Don't create file if it doesn't exist",
            "-d": "Parse string and use instead of current time",
        
            "-t": "Use specified timestamp [[CC]YY]MMDDhhmm[.ss] instead of current time",
            "-r": "Use the timestamps of a reference file instead of current time",
        },
        "common_patterns": ["touch newfile.txt", "touch -c existing.txt"],
        "use_cases": [
            "Create a new empty file quickly with touch newfile.py before editing it",
            "Update a file's timestamp to trigger a build system rebuild with touch Makefile",
            "Create multiple placeholder files at once with touch file{1..10}.txt using brace expansion",
        ],
        "gotchas": [
            "touch will not truncate or overwrite an existing file - it only updates timestamps, so it is always safe to run on existing files",
            "If you need a file with specific content, use echo or printf instead - touch only creates empty files",
        ],
        "related": ["mkdir", "stat", "date"],
        "difficulty": "beginner",
    },
    "ln": {
        "description": "Create links between files (hard or symbolic)",
        "man_url": "https://man7.org/linux/man-pages/man1/ln.1.html",
        "flags": {
            "-s": "Create symbolic (soft) link",
            "-f": "Force, remove existing destination files",
            "-r": "Create relative symbolic link",
            "-v": "Verbose, print name of each linked file",
        
            "-n": "Treat LINK_NAME as a normal file if it is a symlink to a directory (important for overwriting symlinks to dirs)",
            "-t": "Specify the target directory (useful with xargs)",
            "-b": "Make a backup of each existing destination file",
        },
        "common_patterns": ["ln -s /path/to/target linkname", "ln -sf target link"],
    
        "use_cases": [
            "Create a symlink to a config file: ln -s /etc/nginx/sites-available/mysite /etc/nginx/sites-enabled/",
            "Create a version-independent symlink: ln -s python3.11 /usr/local/bin/python3",
            "Replace an existing symlink atomically: ln -sf /new/target linkname",
            "Create a relative symlink: ln -sr ../shared/lib.sh lib.sh",
        ],
        "gotchas": [
            "Hard links cannot cross filesystem boundaries -- use symbolic links (-s) for cross-device linking",
            "Hard links cannot point to directories (to prevent filesystem loops) -- only symlinks can",
            "Symlinks can become dangling (broken) if the target is moved or deleted -- the link still exists but points nowhere",
            "Without -s, ln creates hard links, which share the same inode -- deleting the original does not break the link",
            "ln TARGET LINK_NAME order is the opposite of cp -- the target comes FIRST, the link name comes SECOND",
        ],
        "related": ["readlink", "realpath", "cp", "stat"],
        "difficulty": "intermediate",
    },
    "cat": {
        "description": "Concatenate one or more files and write their contents to standard output - the simplest way to display file contents or combine multiple files into one stream. While often used to view single files, its real purpose is concatenation, and for large files you should prefer less, head, or tail.",
        "man_url": "https://man7.org/linux/man-pages/man1/cat.1.html",
        "flags": {
            "-n": "Number all output lines",
            "-b": "Number non-blank output lines",
            "-s": "Squeeze multiple blank lines into one",
            "-A": "Show all (equivalent to -vET)",
        },
        "common_patterns": ["cat file.txt", "cat -n script.sh", "cat file1.txt file2.txt > combined.txt"],
        "use_cases": [
            "Display a small config file quickly with cat config.json to review its contents",
            "Concatenate multiple files into one with cat part1.sql part2.sql > full.sql",
            "Feed file content into a pipeline with cat data.txt | grep 'pattern' (though redirection is more efficient)",
        ],
        "gotchas": [
            "Useless Use of Cat (UUOC) is a common antipattern - cat file | grep x is less efficient than grep x file since it spawns an unnecessary process",
            "cat will happily dump binary files to your terminal, potentially garbling your session - use file command first to check type",
        ],
        "related": ["less", "head", "tail"],
        "difficulty": "beginner",
    },
    "grep": {
        "description": "Search for lines matching a pattern (string or regular expression) within files or piped input - the workhorse of text searching in Unix. Use -r for recursive directory searches, -i for case-insensitive matching, -n for line numbers, and -E for extended regex.",
        "man_url": "https://man7.org/linux/man-pages/man1/grep.1.html",
        "flags": {
            "-i": "Case-insensitive matching",
            "-v": "Invert match (show non-matching lines)",
            "-r": "Recursive search in directories",
            "-l": "List filenames with matches only",
            "-n": "Show line numbers",
            "-c": "Count matching lines",
            "-w": "Match whole words only",
            "-P": "Use Perl-compatible regular expressions (PCRE)",
            "-E": "Extended regex (same as egrep)",
            "-F": "Fixed string matching (no regex interpretation)",
            "-o": "Show only matching part of line",
            "-A": "Show N lines after match",
            "-B": "Show N lines before match",
            "-C": "Show N lines of context (before and after)",
            "-h": "Suppress filename prefix in output",
            "-H": "Always show filename prefix",
            "-q": "Quiet mode, only return exit status",
            "--include": "Search only files matching pattern",
            "--exclude": "Skip files matching pattern",
        },
        "common_patterns": [
            "grep 'pattern' file.txt",
            "grep -r 'TODO' src/",
            "grep -rn 'function' --include='*.js'",
            "grep -i 'error' log.txt",
            "grep -v '^#' config.txt",
        ],
        "use_cases": [
            "Search an entire codebase for a function name with grep -rn 'functionName' src/",
            "Filter log files for error messages with grep -i 'error|warning' app.log",
            "Count occurrences of a pattern with grep -c 'pattern' file to get quick statistics",
        ],
        "gotchas": [
            "Basic grep uses BRE where + and | need escaping - use grep -E (or egrep) for extended regex to avoid confusion",
            "grep returns exit code 1 when no matches are found, which will trigger set -e failures in scripts - handle this with || true if zero matches is acceptable",
        ],
        "related": ["ripgrep", "awk", "sed"],
        "difficulty": "beginner",
    },
    "sed": {
        "description": "A stream editor that reads input line by line, applies transformation rules (substitution, deletion, insertion), and writes the result - perfect for automated text edits without opening a file. Most commonly used for find-and-replace with sed 's/old/new/g', but also supports line addressing, deletion, and multi-command scripts.",
        "man_url": "https://man7.org/linux/man-pages/man1/sed.1.html",
        "flags": {
            "-i": "Edit files in place",
            "-e": "Add script/expression to commands",
            "-n": "Suppress automatic printing",
            "-E": "Use extended regular expressions (portable)",
        
            "-z": "Use NUL as line separator for processing NUL-delimited data",
        },
        "common_patterns": [
            "sed 's/old/new/' file.txt",
            "sed 's/old/new/g' file.txt",
            "sed -i 's/old/new/g' file.txt",
            "sed -n '10,20p' file.txt",
            "sed '/pattern/d' file.txt",
        ],
        "use_cases": [
            "Find and replace a string across a file with sed -i 's/old_api/new_api/g' config.yaml",
            "Delete lines matching a pattern with sed '/DEBUG/d' logfile to clean output",
            "Extract a range of lines by number with sed -n '10,20p' file for quick inspection",
        ],
        "gotchas": [
            "sed -i behaves differently on macOS (BSD) vs Linux (GNU) - macOS requires sed -i '' while GNU uses sed -i, which causes cross-platform script failures",
            "Forgetting the g flag in s/old/new/ only replaces the first occurrence on each line, not all of them",
        ],
        "related": ["awk", "tr", "perl"],
        "difficulty": "intermediate",
    },
    "awk": {
        "description": "A full pattern-matching and text-processing language that excels at column-based data extraction and transformation - think of it as a programmable filter for structured text. Each line is automatically split into fields ($1, $2, etc.) by whitespace, making it ideal for parsing command output, CSV-like data, and log files.",
        "man_url": "https://man7.org/linux/man-pages/man1/awk.1p.html",
        "flags": {
            "-F": "Set field separator",
            "-v": "Assign variable before execution",
            "-f": "Read program from file",
        },
        "common_patterns": [
            "awk '{print $1}' file.txt",
            "awk -F',' '{print $1, $3}' data.csv",
            "awk '/pattern/ {print}' file.txt",
            "awk '{sum += $1} END {print sum}' numbers.txt",
        ],
        "use_cases": [
            "Extract a specific column from command output like ps aux | awk '{print $2, $11}' to get PIDs and commands",
            "Sum a numeric column in a file with awk '{sum+=$3} END{print sum}' data.txt for quick calculations",
            "Filter and reformat log lines with conditional logic like awk '$9 >= 500 {print $1, $7}' access.log to find HTTP errors",
        ],
        "gotchas": [
            "Single quotes are essential around the awk program to prevent the shell from interpreting $ field references as shell variables",
            "awk field splitting defaults to whitespace - for CSV or TSV, you must set -F',' or -F'\\t' explicitly or fields will be wrong",
        ],
        "related": ["sed", "cut", "perl"],
        "difficulty": "advanced",
    },
    "sort": {
        "description": "Sort lines of text alphabetically, numerically, or by custom fields and delimiters - a fundamental building block in Unix pipelines, often paired with uniq to count unique occurrences or with head/tail to find extremes. Supports reverse order (-r), numeric sorting (-n), human-readable sizes (-h), and field-based sorting (-k).",
        "man_url": "https://man7.org/linux/man-pages/man1/sort.1.html",
        "flags": {
            "-r": "Reverse sort order",
            "-n": "Numeric sort",
            "-h": "Human numeric sort (2K, 1G)",
            "-k": "Sort by specific field/key",
            "-t": "Field separator",
            "-u": "Output only unique lines",
        
            "-V": "Version-number sort (e.g., 1.2 before 1.10)",
            "-S": "Set the main-memory buffer size for large sorts",
            "-s": "Stabilize sort by disabling last-resort comparison",
        },
        "common_patterns": ["sort file.txt", "sort -r file.txt", "sort -n numbers.txt", "du -sh * | sort -h"],
        "use_cases": [
            "Sort a file numerically by the third column with sort -t',' -k3 -n data.csv for CSV processing",
            "Find the top 10 largest files with du -sh * | sort -rh | head -10",
            "Remove duplicates from sorted output by piping to sort -u instead of sort | uniq",
        ],
        "gotchas": [
            "Default sort is lexicographic, not numeric - sort puts '9' after '80' alphabetically; use -n for numeric ordering",
            "Locale settings affect sort order - set LC_ALL=C for consistent byte-order sorting in scripts, especially when comparing output across machines",
        ],
        "related": ["uniq", "tsort", "shuf"],
        "difficulty": "beginner",
    },
    "uniq": {
        "description": "Filter out or report adjacent duplicate lines in input, typically used after sort since uniq only detects consecutive duplicates. Use -c to prefix lines with occurrence counts, -d to show only duplicates, and -u to show only unique lines.",
        "man_url": "https://man7.org/linux/man-pages/man1/uniq.1.html",
        "flags": {
            "-c": "Prefix lines by count of occurrences",
            "-d": "Only print duplicate lines",
            "-u": "Only print unique lines",
            "-i": "Case-insensitive comparison",
        },
        "common_patterns": ["sort file.txt | uniq", "sort file.txt | uniq -c", "sort file.txt | uniq -c | sort -rn"],
        "use_cases": [
            "Count word frequency with sort words.txt | uniq -c | sort -rn to find the most common entries",
            "Find duplicate lines in a sorted file with sort file.txt | uniq -d",
            "Remove consecutive duplicate log entries with uniq logfile.txt to collapse repeated messages",
        ],
        "gotchas": [
            "uniq only removes adjacent duplicates - if duplicates are not consecutive, you must sort first or they will not be detected",
            "uniq -c output has leading whitespace before the count, which can break parsing - use awk or trim the whitespace in downstream processing",
        ],
        "related": ["sort", "comm", "wc"],
        "difficulty": "beginner",
    },
    "wc": {
        "description": "Count lines, words, and bytes (or characters) in files or standard input - a quick measurement tool for gauging file sizes and content volume. Use -l for line count only (the most common usage), -w for words, and -c for bytes.",
        "man_url": "https://man7.org/linux/man-pages/man1/wc.1.html",
        "flags": {
            "-l": "Print line count only",
            "-w": "Print word count only",
            "-c": "Print byte count only",
            "-m": "Print character count only",
        
            "-L": "Print length of the longest line",
        },
        "common_patterns": ["wc file.txt", "wc -l file.txt", "wc -l *.py"],
        "use_cases": [
            "Count lines in a file with wc -l data.csv to verify expected row counts after data processing",
            "Count the number of files in a directory with ls | wc -l for a quick tally",
            "Measure the size of command output with some_command | wc -c to see how much data was produced",
        ],
        "gotchas": [
            "wc -l counts newline characters, so a file without a trailing newline reports one fewer line than you might expect",
            "Using ls | wc -l to count files is unreliable if filenames contain newlines - use find . -maxdepth 1 | wc -l or an array-based approach instead",
        ],
        "related": ["sort", "uniq", "awk"],
        "difficulty": "beginner",
    },
    "head": {
        "description": "Output the first N lines (default 10) of a file or stdin, useful for quickly previewing file contents or truncating pipeline output. Often used with sort to get the top results, or to sample the structure of a data file before processing it in full.",
        "man_url": "https://man7.org/linux/man-pages/man1/head.1.html",
        "flags": {
            "-n": "Print first N lines (or -N for all but last N)",
            "-c": "Print first N bytes",
        
            "-q": "Suppress headers when printing multiple files",
        },
        "common_patterns": ["head file.txt", "head -n 20 file.txt"],
        "use_cases": [
            "Preview the first few lines of a CSV to check column headers with head -1 data.csv",
            "Get the top 5 results from a sorted pipeline with sort -rn scores.txt | head -5",
            "Sample a large log file to understand its format with head -50 huge_log.txt",
        ],
        "gotchas": [
            "head -n -K means 'all lines except the last K' on GNU systems but is not supported on BSD/macOS, causing portability issues",
            "For binary files, head will output bytes that garble your terminal - use file to check the type first",
        ],
        "related": ["tail", "less", "cat"],
        "difficulty": "beginner",
    },
    "tail": {
        "description": "Output the last N lines (default 10) of a file or stdin, with the invaluable -f flag for following a file as it grows in real time. The go-to tool for monitoring active log files and seeing the most recent entries in any file.",
        "man_url": "https://man7.org/linux/man-pages/man1/tail.1.html",
        "flags": {
            "-n": "Print last N lines (or +N for lines from N onward)",
            "-f": "Follow file as it grows",
            "-F": "Follow with retry (handles log rotation)",
        
            "-c": "Output the last N bytes instead of lines",
            "--pid": "Terminate after process PID dies (useful with -f)",
        },
        "common_patterns": ["tail file.txt", "tail -n 50 file.txt", "tail -f logfile.log"],
        "use_cases": [
            "Follow a log file in real time with tail -f /var/log/syslog to watch for new entries",
            "See the last 100 lines of a log with tail -100 app.log for recent activity",
            "Skip a header line and output the rest with tail -n +2 data.csv to process data without the header",
        ],
        "gotchas": [
            "tail -f follows the file descriptor, not the filename - if the file is rotated (renamed and recreated), use tail -F which reopens by name",
            "tail -n +N means 'start from line N' (inclusive) which is confusingly different from tail -N meaning 'last N lines'",
        ],
        "related": ["head", "less", "multitail"],
        "difficulty": "beginner",
    },
    "cut": {
        "description": "Extract specific columns or character positions from each line of input, acting as a lightweight field selector for delimited text data. Use -d to set the delimiter (default is tab) and -f to specify which fields to extract, making it ideal for quick column extraction from CSV or TSV files.",
        "man_url": "https://man7.org/linux/man-pages/man1/cut.1.html",
        "flags": {
            "-d": "Use delimiter instead of TAB",
            "-f": "Select fields (1,3 or 1-3)",
            "-c": "Select characters",
        
            "--complement": "Invert the selection (print all fields except specified)",
            "--output-delimiter": "Use a different delimiter for output",
        },
        "common_patterns": ["cut -d',' -f1,3 data.csv", "cut -d':' -f1 /etc/passwd"],
        "use_cases": [
            "Extract the first and third columns from a CSV with cut -d',' -f1,3 data.csv",
            "Pull usernames from /etc/passwd with cut -d: -f1 /etc/passwd",
            "Extract a range of characters from fixed-width data with cut -c1-10 records.txt",
        ],
        "gotchas": [
            "cut uses tab as the default delimiter, not space - for space-delimited data, use cut -d' ' explicitly or consider awk which handles multiple spaces",
            "cut cannot reorder fields - cut -f3,1 outputs fields 1 then 3, not 3 then 1; use awk if you need to rearrange columns",
        ],
        "related": ["awk", "paste", "tr"],
        "difficulty": "beginner",
    },
    "tr": {
        "description": "Translate, squeeze, or delete characters from standard input, operating on individual characters rather than words or lines. Use it for quick character-level transformations like case conversion, whitespace normalization, or removing unwanted characters from pipeline data.",
        "man_url": "https://man7.org/linux/man-pages/man1/tr.1.html",
        "flags": {
            "-d": "Delete characters in SET1",
            "-s": "Squeeze repeated characters",
            "-c": "Use complement of SET1",
        },
        "common_patterns": ["tr 'a-z' 'A-Z'", "tr -d '\\n'", "tr -s ' '"],
        "use_cases": [
            "Convert lowercase to uppercase with echo 'hello' | tr 'a-z' 'A-Z'",
            "Remove all digits from input with tr -d '0-9' to strip numeric data",
            "Squeeze repeated whitespace into single spaces with tr -s ' ' to normalize messy column data",
        ],
        "gotchas": [
            "tr operates on characters, not strings - tr 'abc' 'xyz' replaces a->x, b->y, c->z individually, it does not replace the string 'abc' with 'xyz'",
            "tr only reads from stdin, not from files directly - use tr < file.txt or cat file.txt | tr, not tr file.txt",
        ],
        "related": ["sed", "cut", "awk"],
        "difficulty": "beginner",
    },
    "diff": {
        "description": "Compare two files line by line and show the differences, essential for code reviews, verifying changes, and creating patch files. Use -u for unified format (the standard for patches and code review), --color for readable terminal output, and -r for recursive directory comparison.",
        "man_url": "https://man7.org/linux/man-pages/man1/diff.1.html",
        "flags": {
            "-u": "Unified format (most common)",
            "-r": "Recursive directory comparison",
            "-q": "Report only when files differ",
            "-i": "Ignore case differences",
            "--color": "Colorize output",
        },
        "common_patterns": ["diff file1.txt file2.txt", "diff -u original.txt modified.txt"],
        "use_cases": [
            "Compare two versions of a file with diff -u old.py new.py to see exactly what changed",
            "Compare entire directory trees with diff -r dir1/ dir2/ to find all differences across a project",
            "Create a patch file with diff -u original.c modified.c > fix.patch for sharing changes without the full file",
        ],
        "gotchas": [
            "diff exits with status 1 when files differ (not an error) and 0 when identical - in scripts with set -e, this exit code will cause unexpected termination",
            "Binary files report only that they differ without showing content - use specialized tools like hexdump or xxd for binary comparison",
        ],
        "related": ["patch", "vimdiff", "colordiff"],
        "difficulty": "intermediate",
    },
    "jq": {
        "description": "A lightweight command-line JSON processor that parses, filters, transforms, and formats JSON data using a powerful query language. Indispensable for working with REST APIs, configuration files, and any JSON-structured data in shell scripts and pipelines.",
        "man_url": "https://stedolan.github.io/jq/manual/",
        "flags": {
            "-r": "Raw output (no quotes for strings)",
            "-c": "Compact output (one line)",
            "-s": "Slurp mode (read entire input as array)",
            "-S": "Sort object keys",
            "--arg": "Set variable to string value",
        
            "-e": "Set exit status based on output (false/null -> exit 1)",
            "--argjson": "Set variable to a JSON value (not string)",
            "--slurpfile": "Read entire file as JSON value into a variable",
            "--rawfile": "Read entire file as a raw string into a variable",
            "-n": "Do not read input, use null as input",
            "--indent": "Set indentation level (default 2)",
        },
        "common_patterns": [
            "jq '.' file.json",
            "jq '.name' file.json",
            "jq -r '.items[]' file.json",
            "curl -s url | jq '.'",
        ],
        "use_cases": [
            "Pretty-print JSON from an API with curl -s api.example.com/data | jq '.' for readable output",
            "Extract a specific field with jq '.users[].name' data.json to pull names from an array",
            "Transform JSON structure with jq '{name: .full_name, id: .user_id}' to reshape data for another tool",
        ],
        "gotchas": [
            "jq is not installed by default on most systems - install it with your package manager (apt, brew, etc.) before relying on it in scripts",
            "String interpolation in jq uses \\() not ${} - mixing up shell and jq variable syntax is a common source of errors",
        ],
        "related": ["yq", "python", "fx"],
        "difficulty": "intermediate",
    },
    "tee": {
        "description": "Read from standard input and write to both standard output and one or more files simultaneously, allowing you to save pipeline output while still seeing it or passing it along. The -a flag appends instead of overwriting, which is essential for logging scenarios.",
        "man_url": "https://man7.org/linux/man-pages/man1/tee.1.html",
        "flags": {
            "-a": "Append to files instead of overwriting",
        
            "-p": "Diagnose errors writing to non-pipes (GNU extension)",
        },
        "common_patterns": ["echo 'text' | tee file.txt", "command | tee output.log"],
        "use_cases": [
            "Save command output to a file while still viewing it with ls -la | tee directory_listing.txt",
            "Write to a file requiring sudo by piping through tee with echo 'config line' | sudo tee /etc/config.conf",
            "Log pipeline output at an intermediate stage with cmd1 | tee debug.log | cmd2 for debugging",
        ],
        "gotchas": [
            "tee overwrites the target file by default - use tee -a to append, especially when running in a loop or repeatedly",
            "Using tee to write to files owned by root requires sudo tee, not tee with sudo on the pipeline - echo 'data' | sudo tee file works where sudo echo 'data' > file does not",
        ],
        "related": ["script", "cat", "redirect"],
        "difficulty": "intermediate",
    },
    "xargs": {
        "description": "Read items from standard input and execute a command with those items as arguments - the glue that connects commands that produce output with commands that expect arguments. Essential when you need to act on a list of files or values, especially from find, grep, or other pipeline producers.",
        "man_url": "https://man7.org/linux/man-pages/man1/xargs.1.html",
        "flags": {
            "-0": "Input items terminated by null (for find -print0)",
            "-n": "Use at most N arguments per command",
            "-I": "Replace string in command with input",
            "-P": "Run N processes in parallel",
        
            "-t": "Print each command before executing (trace mode)",
        },
        "common_patterns": [
            "find . -name '*.log' | xargs rm",
            "find . -name '*.txt' -print0 | xargs -0 grep 'pattern'",
            "echo 'a b c' | xargs -n 1 echo",
        ],
        "use_cases": [
            "Delete files found by find with find . -name '*.tmp' | xargs rm to batch the deletions efficiently",
            "Run parallel operations with xargs -P 4 to process items concurrently across 4 workers",
            "Handle filenames with spaces using find . -name '*.log' -print0 | xargs -0 gzip for null-delimited safety",
        ],
        "gotchas": [
            "Filenames with spaces, quotes, or newlines break xargs by default - always use -0 with find -print0 or -d '\\n' to handle special characters",
            "xargs has a maximum argument length limit (ARG_MAX) - for very large file lists, it automatically batches, but be aware this means the command runs multiple times",
        ],
        "related": ["find", "parallel", "tee"],
        "difficulty": "intermediate",
    },
    "git": {
        "description": "A distributed version control system that tracks changes to files and coordinates work among multiple contributors - the backbone of modern software development workflows. Every developer should know the core cycle: git add to stage, git commit to snapshot, git push to share, and git pull to sync.",
        "man_url": "https://git-scm.com/docs",
        "flags": {
            "--version": "Print git version",
            "-C": "Run as if started in specified directory",
            "--force": "Override safety checks and force the operation",
            "-f": "Force operation (shorthand for --force)",
            "--no-verify": "Skip pre-commit and commit-msg hooks",
            "--amend": "Replace the tip of the current branch with a new commit",
            "-m": "Specify commit message inline",
            "-a": "Automatically stage modified and deleted files",
            "-b": "Create and switch to a new branch",
            "-d": "Delete a branch",
            "-D": "Force delete a branch even if not fully merged",
            "--all": "Apply to all branches or remotes",
            "--oneline": "Compact one-line log format",
            "--graph": "Show ASCII graph of branch and merge history",
            "-u": "Set upstream tracking branch",
            "--hard": "Reset working tree and index to match target",
            "--soft": "Reset only HEAD, keep staged changes",
            "-p": "Interactively choose hunks to stage",
            "--stat": "Show diffstat summary of changes",
        
            "bisect": "Binary search through history to find a bug-introducing commit",
            "reflog": "Show log of all ref updates (recovery tool for lost commits)",
            "worktree": "Manage multiple working trees attached to the same repository",
        },
        "subcommands": {
            "init": "Create empty repository",
            "clone": "Clone repository",
            "add": "Add file contents to staging",
            "commit": "Record changes",
            "status": "Show working tree status",
            "diff": "Show changes",
            "log": "Show commit logs",
            "branch": "Manage branches",
            "checkout": "Switch branches",
            "merge": "Join histories",
            "pull": "Fetch and integrate",
            "push": "Update remote",
            "stash": "Stash changes",
        },
        "common_patterns": [
            "git init",
            "git clone url",
            "git add .",
            "git commit -m 'message'",
            "git status",
            "git log --oneline",
            "git branch -a",
            "git checkout -b new-branch",
            "git pull origin main",
            "git push origin main",
        ],
        "use_cases": [
            "Track changes in a project with git init, git add ., git commit -m 'initial commit'",
            "Collaborate via branching with git checkout -b feature-branch, make changes, then merge back",
            "Investigate when a bug was introduced using git bisect or git log --oneline --graph for visual history",
        ],
        "gotchas": [
            "git add . stages everything including unintended files - use .gitignore and review with git status before committing",
            "Force-pushing (git push --force) rewrites remote history and can destroy teammates' work - use --force-with-lease as a safer alternative",
        ],
        "related": ["gh", "svn", "mercurial"],
        "difficulty": "intermediate",
    },
    "npm": {
        "description": "The default package manager for Node.js that installs dependencies, runs scripts, and manages project metadata via package.json. Beyond installing packages, npm scripts (npm run build, npm test) serve as the standard task runner for JavaScript projects.",
        "man_url": "https://docs.npmjs.com/cli",
        "flags": {
            "-g": "Install globally",
            "--save-dev": "Save to devDependencies",
            "-D": "Save to devDependencies (shorthand)",
            "-y": "Accept defaults for init",
        
            "ci": "Clean install from lockfile only, ideal for CI/CD pipelines",
            "outdated": "Check for outdated packages",
            "audit": "Run a security audit of installed dependencies",
            "link": "Symlink a local package for development testing",
            "pack": "Create a tarball of the package without publishing",
            "exec": "Run a command from a local or remote npm package",
            "--legacy-peer-deps": "Ignore peerDependency conflicts during install",
            "--omit=dev": "Skip devDependencies during install (replaces --production)",
            "cache clean --force": "Clear the npm cache when troubleshooting installs",
        },
        "subcommands": {
            "init": "Create package.json",
            "install": "Install dependencies",
            "run": "Run scripts",
            "test": "Run test script",
            "build": "Run build script",
        },
        "common_patterns": [
            "npm init -y",
            "npm install",
            "npm install package-name",
            "npm install -D typescript",
            "npm run build",
        ],
        "use_cases": [
            "Initialize a new project with npm init -y and install dependencies with npm install express",
            "Run project scripts defined in package.json like npm test or npm run build",
            "Audit dependencies for known vulnerabilities with npm audit and fix them with npm audit fix",
        ],
        "gotchas": [
            "npm install without --save-dev puts everything in dependencies - use --save-dev for test/build tools to keep production installs lean",
            "Running npm install without a lockfile or with different npm versions can produce different dependency trees - always commit package-lock.json",
        ],
        "related": ["yarn", "pnpm", "npx"],
        "difficulty": "beginner",
    },
    "npx": {
        "description": "Execute npm package binaries",
        "man_url": "https://docs.npmjs.com/cli/commands/npx",
        "flags": {
            "-y": "Auto-confirm package installation",
            "--no-install": "Error if package not installed",
        
            "-p": "Specify additional packages to install alongside the command",
            "--no": "Refuse to install any packages not already present",
            "-c": "Execute a string as a shell command with the package available",
        },
        "common_patterns": ["npx create-react-app my-app", "npx typescript --init", "npx eslint ."],
    
        "use_cases": [
            "Run a package without installing it globally: npx create-react-app my-app",
            "Execute a specific version of a tool: npx node@18 --version",
            "Run a locally installed binary: npx jest --coverage",
            "Initialize a project with a scaffolding tool: npx degit user/repo my-project",
        ],
        "gotchas": [
            "npx downloads packages to a temporary cache and executes them -- this means it may run arbitrary code from npm; always verify what you are running",
            "If the package is not installed locally, npx prompts for confirmation (use -y to auto-confirm or --no to reject)",
            "npx resolves commands from local node_modules/.bin first, then global, then downloads -- behavior can be surprising if a local version differs from what you expect",
        ],
        "related": ["npm", "yarn", "pnpm", "bun"],
        "difficulty": "beginner",
    },
    "pip": {
        "description": "The standard package installer for Python that downloads and installs packages from PyPI (Python Package Index) and manages project dependencies. Always use pip inside a virtual environment to avoid polluting system Python and to keep project dependencies isolated.",
        "man_url": "https://pip.pypa.io/en/stable/",
        "flags": {
            "-r": "Install from requirements file",
            "-e": "Install in editable/development mode",
            "--upgrade": "Upgrade packages",
            "-U": "Upgrade packages (shorthand)",
        
            "--user": "Install to the user site-packages directory",
            "--no-deps": "Do not install package dependencies",
            "--pre": "Include pre-release and development versions",
            "--index-url": "Use a custom package index URL",
            "--trusted-host": "Trust a host for package downloads (skip SSL)",
            "show": "Show information about installed packages",
            "check": "Verify installed packages have compatible dependencies",
            "download": "Download packages without installing",
        },
        "common_patterns": [
            "pip install package-name",
            "pip install -r requirements.txt",
            "pip freeze > requirements.txt",
            "pip list",
        ],
        "use_cases": [
            "Install a package with pip install requests and pin versions with pip install requests==2.31.0",
            "Export current environment dependencies with pip freeze > requirements.txt for reproducibility",
            "Install all project dependencies from a requirements file with pip install -r requirements.txt",
        ],
        "gotchas": [
            "Installing without a virtual environment modifies system Python packages and can break OS tools - always use python -m venv or conda first",
            "pip install upgrades are not automatic - use pip install --upgrade package to get the latest version; pip install alone skips already-installed packages",
        ],
        "related": ["pipenv", "poetry", "conda"],
        "difficulty": "beginner",
    },
    "apt": {
        "description": "Debian/Ubuntu package manager",
        "man_url": "https://manpages.ubuntu.com/manpages/man8/apt.8.html",
        "flags": {
            "-y": "Automatic yes to prompts",
            "-q": "Quiet output",
        
            "--no-install-recommends": "Do not install recommended packages as dependencies",
            "--fix-broken": "Attempt to fix broken dependencies",
            "-f": "Alias for --fix-broken",
            "--dry-run": "Simulate the operation without making changes",
        },
        "common_patterns": ["apt update", "apt upgrade -y", "apt install package-name"],
    
        "use_cases": [
            "Update package list and upgrade all packages: apt update && apt upgrade -y",
            "Search for packages matching a keyword: apt search nginx",
            "Show detailed information about a package before installing: apt show package-name",
            "List all installed packages for auditing: apt list --installed",
            "Remove a package and its configuration files: apt purge package-name",
        ],
        "gotchas": [
            "apt is designed for interactive terminal use; scripts should use apt-get for a stable CLI interface that will not change output format between releases",
            "Running apt without sudo gives permission errors -- most operations require root",
            "apt update only refreshes the package index; it does not install anything -- you must follow with apt upgrade to actually apply updates",
            "apt autoremove can remove packages that other software still depends on if dependency metadata is stale -- review the list before confirming",
        ],
        "related": ["apt-get", "apt-cache", "dpkg", "snap"],
        "difficulty": "beginner",
    },
    "brew": {
        "description": "macOS/Linux package manager (Homebrew)",
        "man_url": "https://docs.brew.sh/Manpage",
        "flags": {
            "--cask": "Operate on cask (macOS apps)",
        
            "install": "Install a formula or cask",
            "uninstall": "Remove an installed formula or cask",
            "upgrade": "Upgrade outdated formulae and casks",
            "update": "Fetch the newest version of Homebrew and all formulae",
            "search": "Search for formulae and casks",
            "info": "Display information about a formula or cask",
            "doctor": "Check your system for potential problems",
            "list": "List all installed formulae and casks",
            "pin": "Pin a formula to prevent upgrades",
            "unpin": "Unpin a formula to allow upgrades",
            "cleanup": "Remove old versions of installed formulae",
            "tap": "Add a third-party repository of formulae",
            "services": "Manage background services with macOS launchd",
        },
        "common_patterns": ["brew install package-name", "brew update", "brew upgrade"],
    
        "use_cases": [
            "Install a command-line tool: brew install wget",
            "Install a macOS GUI application: brew install --cask firefox",
            "Update Homebrew and upgrade all packages: brew update && brew upgrade",
            "Search for available packages: brew search keyword",
            "List installed packages and check for issues: brew list && brew doctor",
            "Pin a formula to prevent it from being upgraded: brew pin postgresql",
        ],
        "gotchas": [
            "brew update refreshes the formula index; brew upgrade actually installs newer versions -- mixing them up leads to confusion",
            "Homebrew installs into /opt/homebrew on Apple Silicon and /usr/local on Intel Macs -- scripts referencing hardcoded paths may break across architectures",
            "brew doctor reports potential issues and should be run when things break -- it catches common problems like outdated Xcode CLT",
            "Cask apps (--cask) are macOS .app bundles, not CLI tools -- they go to /Applications and may require manual updates",
        ],
        "related": ["port", "apt", "dnf"],
        "difficulty": "beginner",
    },
    "cargo": {
        "description": "Rust package manager and build tool",
        "man_url": "https://doc.rust-lang.org/cargo/",
        "flags": {
            "--release": "Build in release mode with optimizations",
        
            "new": "Create a new Cargo project (binary or library)",
            "init": "Initialize Cargo in an existing directory",
            "build": "Compile the current project",
            "run": "Build and execute the binary",
            "test": "Run the test suite",
            "check": "Analyze code without producing binary output",
            "clippy": "Run the Clippy linter for idiomatic Rust suggestions",
            "fmt": "Format source code according to Rust style guidelines",
            "doc": "Generate HTML documentation for the project",
            "add": "Add a dependency to Cargo.toml",
            "remove": "Remove a dependency from Cargo.toml",
            "publish": "Publish the crate to crates.io",
            "bench": "Run benchmarks",
            "update": "Update Cargo.lock to latest compatible versions",
            "--workspace": "Operate on all workspace members",
        },
        "common_patterns": ["cargo new project-name", "cargo build", "cargo run", "cargo test"],
    
        "use_cases": [
            "Create a new Rust project: cargo new my-project",
            "Build the project in debug mode: cargo build",
            "Build an optimized release binary: cargo build --release",
            "Run tests: cargo test",
            "Add a dependency from crates.io: cargo add serde",
            "Check code without producing a binary (fast feedback): cargo check",
            "Generate and open documentation: cargo doc --open",
        ],
        "gotchas": [
            "cargo build defaults to debug mode with no optimizations -- always use --release for production builds or benchmarks",
            "Cargo.lock should be committed for binaries but not for libraries -- libraries let downstream consumers resolve versions",
            "cargo update updates Cargo.lock to latest compatible versions but does not change Cargo.toml version constraints",
            "Large dependency trees can make initial builds slow -- use cargo check instead of cargo build during development for faster feedback",
        ],
        "related": ["rustup", "rustc"],
        "difficulty": "intermediate",
    },
    "ps": {
        "description": "Display information about currently running processes, including their PIDs, resource usage, and command lines - the first step in diagnosing what is running on your system. Use ps aux for a full system snapshot or ps -ef for a standard POSIX listing, and pipe to grep to find specific processes.",
        "man_url": "https://man7.org/linux/man-pages/man1/ps.1.html",
        "flags": {
            "-e": "Select all processes",
            "-f": "Full-format listing",
            "-u": "Select by effective user",
            "aux": "BSD-style all users, detailed",
        
            "-ef": "Show all processes with full format (UNIX style)",
            "--forest": "Show process tree hierarchy",
            "-o": "Custom output format: ps -o pid,user,%cpu,%mem,cmd",
        },
        "common_patterns": ["ps aux", "ps -ef", "ps aux | grep process-name"],
        "use_cases": [
            "Find a specific running process with ps aux | grep nginx to check if a service is alive",
            "See all processes for the current user with ps -u $USER to identify runaway jobs",
            "Get a tree view of process hierarchy with ps auxf (Linux) to understand parent-child relationships",
        ],
        "gotchas": [
            "ps shows a snapshot in time, not live data - use top or htop for real-time monitoring of process resource usage",
            "BSD-style flags (ps aux) and POSIX-style flags (ps -ef) produce different output formats - pick one style and use it consistently",
        ],
        "related": ["top", "htop", "kill"],
        "difficulty": "beginner",
    },
    "kill": {
        "description": "Send signals to processes by PID, most commonly used to terminate misbehaving or stuck processes. The default signal is SIGTERM (15) which asks a process to shut down gracefully, while SIGKILL (9) forcibly terminates it as a last resort.",
        "man_url": "https://man7.org/linux/man-pages/man1/kill.1.html",
        "flags": {
            "-9": "SIGKILL - force kill",
            "-15": "SIGTERM - terminate (default)",
            "-l": "List signal names",
        
            "-L": "List signals in a table format with numbers",
            "-s": "Specify signal by name (e.g., -s TERM)",
            "--timeout": "Send follow-up signal after specified milliseconds if process survives",
        },
        "common_patterns": ["kill PID", "kill -9 PID"],
        "use_cases": [
            "Gracefully stop a process with kill PID which sends SIGTERM and allows cleanup",
            "Force-kill an unresponsive process with kill -9 PID when SIGTERM is ignored",
            "Send a reload signal to a daemon with kill -HUP PID to reload configuration without restarting",
        ],
        "gotchas": [
            "kill -9 should be a last resort because it prevents the process from cleaning up resources like temp files, database connections, and lock files",
            "kill requires the PID, not the process name - use pkill or killall to signal processes by name instead",
        ],
        "related": ["pkill", "killall", "ps"],
        "difficulty": "beginner",
    },
    "top": {
        "description": "Display and update sorted process information",
        "man_url": "https://man7.org/linux/man-pages/man1/top.1.html",
        "flags": {
            "-b": "Batch mode (for piping output)",
            "-n": "Number of iterations",
            "-u": "Filter by user",
        
            "-d": "Set refresh interval in seconds",
            "-p": "Monitor only specific PIDs",
            "-H": "Show individual threads",
            "-c": "Show full command line instead of just the command name",
            "-o": "Sort by a specific field",
        },
        "common_patterns": ["top", "top -u username"],
    
        "use_cases": [
            "Monitor CPU and memory usage in real time to find resource-hungry processes",
            "Find the process consuming the most CPU: run top then press P to sort by CPU",
            "Script batch monitoring: top -b -n 1 | head -20 for a snapshot",
            "Filter to a specific user's processes: top -u www-data",
        ],
        "gotchas": [
            "The %CPU column in top shows per-core percentage, so a multithreaded process can show over 100%",
            "Memory readings can be confusing: 'used' includes buffer/cache; check 'avail' for actual available memory",
            "top's interactive keys (P, M, T for sorting, k for kill, 1 for per-CPU) are essential but undiscoverable without reading help (press h)",
        ],
        "related": ["htop", "btop", "ps", "kill"],
        "difficulty": "beginner",
    },
    "env": {
        "description": "Display, set, or remove environment variables",
        "man_url": "https://man7.org/linux/man-pages/man1/env.1.html",
        "flags": {
            "-i": "Start with empty environment",
            "-u": "Remove variable from environment",
        
            "-0": "Null-terminate output lines (for use with xargs -0)",
            "-S": "Split a single string into arguments (useful in shebangs)",
        },
        "common_patterns": ["env", "env | grep PATH", "env VAR=value command"],
    
        "use_cases": [
            "Display all environment variables: env",
            "Filter environment variables: env | grep PATH",
            "Run a command with a modified environment: env VAR=value command",
            "Run a command with a clean environment: env -i /bin/bash",
            "Set environment for a single command without affecting current shell: env LANG=C sort file.txt",
        ],
        "gotchas": [
            "env -i starts with an empty environment, which can break most commands since PATH, HOME, and other critical variables are unset",
            "env is commonly used in shebang lines (#!/usr/bin/env python3) to find commands in PATH regardless of installation location",
            "env shows exported variables only, not shell-local variables -- use set to see all variables",
        ],
        "related": ["export", "printenv", "set"],
        "difficulty": "beginner",
    },
    "export": {
        "description": "Set environment variables for child processes",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "flags": {
            "-p": "Display all exported variables",
            "-n": "Remove export property",
        
            "-f": "Export a shell function, not a variable",
        },
        "common_patterns": ["export PATH=$PATH:/new/path", "export NODE_ENV=production"],
    
        "use_cases": [
            "Set PATH for child processes: export PATH=\"$PATH:/usr/local/go/bin\"",
            "Configure application behavior: export NODE_ENV=production",
            "Pass credentials to subcommands: export AWS_PROFILE=staging",
            "List all exported variables: export -p",
        ],
        "gotchas": [
            "export only affects child processes -- it does NOT send variables back to the parent shell",
            "export -n removes the export attribute but keeps the variable defined locally",
            "Variables set without export are shell-local and invisible to commands you run",
            "Exporting in a subshell (pipe, $(...)) does not affect the parent -- the subshell's environment is discarded",
        ],
        "related": ["declare", "set", "unset", "env"],
        "difficulty": "beginner",
    },
    "which": {
        "description": "Locate command executable in PATH",
        "man_url": "https://man7.org/linux/man-pages/man1/which.1.html",
        "flags": {
            "-a": "Print all matches in PATH",
        },
        "common_patterns": ["which python", "which -a python"],
    
        "use_cases": [
            "Find where a command lives: which python3",
            "Check if a command is installed: which docker || echo 'docker not found'",
            "Find all versions in PATH: which -a python",
            "Verify which version runs by default: which node",
        ],
        "gotchas": [
            "which only searches PATH for external executables -- it does not find shell builtins, functions, or aliases",
            "Prefer 'command -v' or 'type' in scripts -- which is not POSIX standard and behavior varies across systems",
            "On some systems, which is a shell script that parses alias output, which can give unexpected results",
            "which may show different results than what actually runs if there are aliases or functions shadowing the command",
        ],
        "related": ["whereis", "type", "command", "hash"],
        "difficulty": "beginner",
    },
    "curl": {
        "description": "Transfer data to or from a server using URLs, supporting HTTP, HTTPS, FTP, and many other protocols - the go-to tool for testing APIs, downloading files, and debugging web requests from the command line. With flags like -X for method, -H for headers, -d for data, and -o for output, curl can simulate virtually any HTTP interaction.",
        "man_url": "https://curl.se/docs/manpage.html",
        "flags": {
            "-X": "Request method (GET, POST, PUT, DELETE)",
            "-H": "Add header",
            "-d": "Send data in request body",
            "-o": "Write output to file",
            "-O": "Write to file named like remote",
            "-L": "Follow redirects",
            "-s": "Silent mode",
            "-v": "Verbose output",
            "-i": "Include response headers",
            "-I": "Fetch headers only (HEAD request)",
        
            "-k": "Allow insecure SSL connections (skip certificate verification)",
        },
        "common_patterns": [
            "curl https://api.example.com",
            "curl -s https://api.example.com | jq '.'",
            "curl -X POST -H 'Content-Type: application/json' -d '{\"key\":\"value\"}' url",
            "curl -o output.html https://example.com",
            "curl -L https://shortened.url",
        ],
        "use_cases": [
            "Test a REST API endpoint with curl -X POST -H 'Content-Type: application/json' -d '{\"key\":\"val\"}' https://api.example.com/data",
            "Download a file with curl -O https://example.com/installer.sh",
            "Debug HTTP responses including headers with curl -v https://example.com to see the full request/response exchange",
        ],
        "gotchas": [
            "curl does not follow redirects by default - add -L to follow 301/302 redirects, otherwise you get an empty or unexpected response",
            "curl exits with status 0 even on HTTP 404/500 errors - use --fail or -f to make curl return a non-zero exit code on server errors",
        ],
        "related": ["wget", "httpie", "fetch"],
        "difficulty": "intermediate",
    },
    "wget": {
        "description": "Download files from the web non-interactively, with built-in support for retrying, recursion, and resuming interrupted downloads - ideal for scripted downloads and mirroring websites. Unlike curl, wget follows redirects and saves to files by default, making it simpler for straightforward download tasks.",
        "man_url": "https://www.gnu.org/software/wget/manual/wget.html",
        "flags": {
            "-O": "Write to specified file",
            "-q": "Quiet mode",
            "-c": "Continue interrupted download",
            "-r": "Recursive download",
        
            "-b": "Run in background after startup",
            "--mirror": "Shortcut for -r -N -l inf --no-remove-listing",
        },
        "common_patterns": ["wget https://example.com/file.zip", "wget -O output.zip url"],
        "use_cases": [
            "Download a file with automatic filename detection using wget https://example.com/data.csv",
            "Mirror an entire website for offline browsing with wget -m -p -k https://example.com",
            "Resume a partially downloaded large file with wget -c https://example.com/bigfile.iso",
        ],
        "gotchas": [
            "wget is not installed by default on macOS - you need to install it via Homebrew with brew install wget",
            "Recursive downloads with wget -r can consume enormous disk space and bandwidth if depth is not limited with -l",
        ],
        "related": ["curl", "aria2", "scp"],
        "difficulty": "beginner",
    },
    "ssh": {
        "description": "Securely connect to remote machines over an encrypted channel for interactive shell sessions, command execution, and tunneling. Beyond simple logins, ssh enables port forwarding (-L, -R), agent forwarding (-A), config-based connection profiles, and serves as the transport layer for scp, rsync, and git.",
        "man_url": "https://man.openbsd.org/ssh",
        "flags": {
            "-p": "Port to connect to",
            "-i": "Identity file (private key)",
            "-v": "Verbose mode",
            "-L": "Local port forwarding",
            "-D": "Dynamic port forwarding (SOCKS proxy)",
        
            "-R": "Remote port forwarding",
            "-N": "Do not execute a remote command (useful for tunnels only)",
            "-J": "Jump host (proxy jump) for connecting through a bastion",
        },
        "common_patterns": ["ssh user@host", "ssh -p 2222 user@host", "ssh -i ~/.ssh/key.pem user@host"],
        "use_cases": [
            "Log into a remote server with ssh user@hostname for interactive administration",
            "Run a single command remotely without an interactive session using ssh user@host 'df -h'",
            "Create an SSH tunnel to access a remote database locally with ssh -L 5432:localhost:5432 user@dbserver",
        ],
        "gotchas": [
            "Strict host key checking will reject connections to servers whose keys have changed - this protects against MITM attacks, so do not blindly disable it without understanding why the key changed",
            "Forgetting to set correct permissions on ~/.ssh/config (644) and private keys (600) causes ssh to refuse to use them",
        ],
        "related": ["scp", "rsync", "ssh-keygen"],
        "difficulty": "intermediate",
    },
    "scp": {
        "description": "Secure copy over SSH",
        "man_url": "https://man.openbsd.org/scp",
        "flags": {
            "-r": "Recursive copy directories",
            "-P": "Port to connect to",
            "-i": "Identity file",
        
            "-C": "Enable compression during transfer",
            "-l": "Limit bandwidth in Kbit/s",
            "-3": "Copy between two remote hosts through the local machine",
            "-o": "Pass SSH options (e.g., -o StrictHostKeyChecking=no)",
        },
        "common_patterns": ["scp file.txt user@host:/path/", "scp -r directory/ user@host:/path/"],
    
        "use_cases": [
            "Copy a file to a remote server: scp file.txt user@host:/remote/path/",
            "Copy a directory recursively: scp -r project/ user@host:/deploy/",
            "Copy between two remote hosts through your local machine: scp user1@host1:file user2@host2:/path/",
            "Use a specific SSH key: scp -i ~/.ssh/deploy_key file.txt user@host:/path/",
        ],
        "gotchas": [
            "scp is considered deprecated by OpenSSH in favor of sftp or rsync -- it has known limitations with filename handling",
            "scp copies the entire file every time; rsync only transfers differences and is much faster for repeated transfers",
            "The -P flag (uppercase) specifies the port, unlike ssh which uses -p (lowercase)",
            "Wildcards in remote paths must be quoted to prevent local shell expansion: scp 'user@host:/path/*.log' .",
        ],
        "related": ["sftp", "rsync", "ssh"],
        "difficulty": "beginner",
    },
    "rsync": {
        "description": "An efficient file synchronization tool that transfers only the differences between source and destination, making it dramatically faster than cp for repeated transfers. Supports local and remote (SSH) transfers, preserves permissions and timestamps, and provides dry-run mode for safe previewing.",
        "man_url": "https://rsync.samba.org/documentation.html",
        "flags": {
            "-a": "Archive mode (preserves everything)",
            "-v": "Verbose output",
            "-z": "Compress during transfer",
            "-n": "Dry run",
            "--delete": "Delete extraneous files from destination",
            "-P": "Show progress and allow resume",
        
            "--progress": "Show progress during transfer",
            "--dry-run": "Show what would be transferred without actually doing it",
        },
        "common_patterns": ["rsync -av source/ destination/", "rsync -avz source/ user@host:/destination/"],
        "use_cases": [
            "Sync a project to a remote server with rsync -avz ./project/ user@server:/deploy/ using compression",
            "Create incremental backups with rsync -a --delete source/ backup/ that mirrors the source exactly",
            "Preview what would change without actually transferring with rsync -avzn (dry-run) to verify before committing",
        ],
        "gotchas": [
            "Trailing slashes on source paths matter enormously - rsync dir/ copies contents, while rsync dir copies the directory itself into the destination",
            "The --delete flag removes files in the destination that do not exist in the source - use --dry-run first to avoid accidentally deleting important files",
        ],
        "related": ["scp", "cp", "rclone"],
        "difficulty": "intermediate",
    },
    "chmod": {
        "description": "Change file permissions (read, write, execute) for the owner, group, and others - controls who can access, modify, or run a file. Supports both symbolic notation (chmod u+x script.sh) and octal notation (chmod 755 script.sh), with -R for recursive changes.",
        "man_url": "https://man7.org/linux/man-pages/man1/chmod.1.html",
        "flags": {
            "-R": "Recursive change",
            "-v": "Verbose, show changes",
        
            "--reference": "Copy permissions from a reference file",
        },
        "common_patterns": ["chmod 755 script.sh", "chmod +x script.sh", "chmod -R 644 directory/"],
        "use_cases": [
            "Make a script executable with chmod +x deploy.sh so you can run it directly",
            "Secure a private key file with chmod 600 ~/.ssh/id_rsa so only you can read it",
            "Recursively fix web directory permissions with chmod -R 755 public_html/",
        ],
        "gotchas": [
            "chmod 777 gives everyone full access and is almost always a security mistake - use the most restrictive permissions that still work",
            "On directories, execute permission means the ability to traverse into (cd) the directory, not run it - a directory without +x is inaccessible even if readable",
        ],
        "related": ["chown", "chgrp", "umask"],
        "difficulty": "intermediate",
    },
    "chown": {
        "description": "Change the owner and/or group of files and directories, controlling which user and group the filesystem associates with the file. Typically requires root privileges (sudo) and is essential when deploying applications, fixing permission issues after copying files, or setting up shared directories.",
        "man_url": "https://man7.org/linux/man-pages/man1/chown.1.html",
        "flags": {
            "-R": "Recursive change",
            "-v": "Verbose, show changes",
        
            "-h": "Change the symlink itself rather than the dereferenced file",
            "--from": "Only change ownership if current owner:group matches",
            "--reference": "Use the owner/group of a reference file",
        },
        "common_patterns": ["chown user file.txt", "chown user:group file.txt", "chown -R user:group directory/"],
        "use_cases": [
            "Fix ownership after extracting an archive with sudo chown -R www-data:www-data /var/www/",
            "Transfer file ownership to another user with sudo chown newuser:newgroup file.txt",
            "Recursively set ownership for a deployed application with sudo chown -R appuser:appgroup /opt/myapp/",
        ],
        "gotchas": [
            "Only root can change file ownership - running chown without sudo will fail for files you do not own",
            "Changing ownership of symlinks requires -h flag; without it, chown follows the symlink and changes the target file's ownership instead",
        ],
        "related": ["chmod", "chgrp", "id"],
        "difficulty": "intermediate",
    },
    "tar": {
        "description": "Create and extract archive files that bundle multiple files and directories into a single file, optionally with compression. The flags c (create), x (extract), z (gzip), j (bzip2), and f (file) combine to form common patterns like tar czf archive.tar.gz dir/ and tar xzf archive.tar.gz.",
        "man_url": "https://man7.org/linux/man-pages/man1/tar.1.html",
        "flags": {
            "-c": "Create archive",
            "-x": "Extract archive",
            "-t": "List archive contents",
            "-f": "Archive filename",
            "-v": "Verbose output",
            "-z": "Filter through gzip",
            "-j": "Filter through bzip2",
            "-C": "Change to directory before operation",
        
            "--strip-components": "Strip N leading path components on extraction",
            "--exclude": "Exclude files matching a pattern",
            "-J": "Use xz compression (best ratio, slower)",
            "--totals": "Print total bytes written after creating archive",
        },
        "common_patterns": [
            "tar -cvf archive.tar directory/",
            "tar -xvf archive.tar",
            "tar -czvf archive.tar.gz directory/",
            "tar -xzvf archive.tar.gz",
        ],
        "use_cases": [
            "Create a compressed backup with tar czf backup.tar.gz project/ for portable archiving",
            "Extract a downloaded archive with tar xzf package.tar.gz into the current directory",
            "List contents of an archive without extracting with tar tzf archive.tar.gz to inspect before unpacking",
        ],
        "gotchas": [
            "The f flag must come last (or next to the filename) since it expects the archive name as its argument - tar czf is correct, tar cfz will misinterpret the filename",
            "tar extracts relative to the current directory by default - always check contents with tar tf first to avoid polluting your directory with unexpected files",
        ],
        "related": ["gzip", "zip", "unzip"],
        "difficulty": "intermediate",
    },
    "gzip": {
        "description": "Compress files with LZ77 algorithm",
        "man_url": "https://man7.org/linux/man-pages/man1/gzip.1.html",
        "flags": {
            "-d": "Decompress",
            "-k": "Keep original file",
            "-v": "Verbose output",
            "-9": "Best compression",
        
            "-c": "Write to stdout, keep original files",
            "-r": "Recursively compress files in a directory",
            "-l": "List compression statistics",
            "-t": "Test compressed file integrity",
            "-f": "Force compression even if output file exists",
            "-1": "Fastest compression (least compression ratio)",
            "-6": "Default compression level (balanced)",
        },
        "common_patterns": ["gzip file.txt", "gzip -d file.txt.gz", "gunzip file.txt.gz"],
    
        "use_cases": [
            "Compress a file (replaces original with .gz): gzip file.txt",
            "Compress while keeping the original: gzip -k file.txt",
            "Compress with best compression ratio: gzip -9 file.txt",
            "Decompress a .gz file: gzip -d file.txt.gz",
            "Compress all files in a directory recursively: gzip -r directory/",
            "View compression ratio without decompressing: gzip -l file.txt.gz",
        ],
        "gotchas": [
            "gzip replaces the original file by default -- use -k to keep the original, or redirect: gzip -c file > file.gz",
            "gzip only compresses single files; it does not create archives of multiple files -- use tar czf for multiple files",
            "gzip compression level (-1 to -9) trades speed for compression ratio; the default -6 is usually a good balance",
        ],
        "related": ["gunzip", "zcat", "bzip2", "xz", "zstd"],
        "difficulty": "beginner",
    },
    "zip": {
        "description": "Package and compress files",
        "man_url": "https://linux.die.net/man/1/zip",
        "flags": {
            "-r": "Recursive, include directories",
            "-e": "Encrypt with password",
            "-9": "Best compression",
        
            "-j": "Junk (do not record) directory names -- store just the filenames",
            "-u": "Update existing entries only if newer",
            "-d": "Delete entries from a zip archive",
            "-x": "Exclude files matching the given patterns",
            "-q": "Quiet mode (suppress output)",
            "-0": "Store only (no compression)",
            "-T": "Test archive integrity after creation",
            "-s": "Create a split archive with specified size",
        },
        "common_patterns": ["zip archive.zip file1 file2", "zip -r archive.zip directory/"],
    
        "use_cases": [
            "Create a zip archive from multiple files: zip archive.zip file1.txt file2.txt",
            "Recursively zip a directory: zip -r archive.zip directory/",
            "Add files to an existing zip archive: zip archive.zip newfile.txt",
            "Create a password-protected zip: zip -e secure.zip secrets.txt",
            "Exclude specific patterns: zip -r archive.zip dir/ -x '*.log'",
        ],
        "gotchas": [
            "zip does not compress as well as gzip, bzip2, or xz for individual files -- its advantage is the archive format that Windows and macOS natively support",
            "zip -r is required for directories; without -r, zip only adds files in the current directory level",
            "zip encryption (-e) uses the legacy ZipCrypto algorithm which is weak -- use 7z or gpg for real security",
            "File permissions and symlinks may not be preserved in zip archives across different operating systems",
        ],
        "related": ["unzip", "tar", "gzip", "7z"],
        "difficulty": "beginner",
    },
    "unzip": {
        "description": "Extract compressed files from zip archive",
        "man_url": "https://linux.die.net/man/1/unzip",
        "flags": {
            "-l": "List archive contents",
            "-d": "Extract to directory",
            "-o": "Overwrite without prompting",
        
            "-q": "Quiet mode (suppress output except errors)",
            "-n": "Never overwrite existing files",
            "-j": "Junk paths (extract flat without directory structure)",
            "-p": "Extract to stdout (for piping)",
            "-Z": "Display archive information in zipinfo format",
        },
        "common_patterns": ["unzip archive.zip", "unzip archive.zip -d destination/"],
    
        "use_cases": [
            "Extract all files from a zip archive: unzip archive.zip",
            "Extract to a specific directory: unzip archive.zip -d /tmp/output",
            "List contents of a zip without extracting: unzip -l archive.zip",
            "Extract only specific files: unzip archive.zip '*.txt'",
            "Test archive integrity: unzip -t archive.zip",
        ],
        "gotchas": [
            "unzip extracts to the current directory by default, which can be messy -- always use -d to specify a target directory",
            "unzip will prompt before overwriting existing files unless -o (overwrite) is passed",
            "Zip archives created on Windows may have filenames in non-UTF-8 encoding, causing garbled names on Linux -- use unzip -O CP437 as a workaround",
            "unzip cannot handle .gz or .tar.gz files -- those require gunzip or tar xzf respectively",
        ],
        "related": ["zip", "tar", "7z"],
        "difficulty": "beginner",
    },
    "node": {
        "description": "JavaScript runtime built on V8",
        "man_url": "https://nodejs.org/docs/latest/api/cli.html",
        "flags": {
            "-v": "Print Node.js version",
            "-e": "Evaluate script",
            "--inspect": "Enable inspector agent",
        
            "--watch": "Watch for file changes and restart automatically (Node 18+)",
            "--experimental-modules": "Enable ES module support (legacy, now default)",
            "-p": "Evaluate and print an expression (shorthand for -e with console.log)",
            "--max-old-space-size": "Set the V8 heap memory limit in MB (default ~1.5GB)",
            "-r": "Preload a module before executing the script",
            "--env-file": "Load environment variables from a .env file (Node 20+)",
        },
        "common_patterns": ["node script.js", "node -e 'console.log(process.version)'"],
    
        "use_cases": [
            "Run a JavaScript file with node app.js",
            "Start a quick REPL for testing with node (interactive mode)",
            "Evaluate an expression inline with node -e 'console.log(process.version)'",
            "Debug a script with Chrome DevTools with node --inspect-brk app.js then open chrome://inspect",
        ],
        "gotchas": [
            "Node.js uses CommonJS (require) by default -- to use ES modules (import/export) either use .mjs extension or set \"type\": \"module\" in package.json",
            "The --inspect flag opens a debug port (9229) -- never expose this in production as it allows arbitrary code execution",
            "Node.js is single-threaded for JavaScript execution -- CPU-intensive work blocks the event loop and should use worker_threads",
            "Unhandled promise rejections will crash Node.js in newer versions -- always add .catch() or use try/catch with async/await",
        ],
        "related": ["npm", "npx", "deno", "bun"],
        "difficulty": "beginner",
    },
    "python": {
        "description": "The Python interpreter that runs scripts, starts interactive REPL sessions, and serves as the entry point for Python-based tools and applications. Use python -m to run installed modules as scripts (like python -m venv, python -m http.server) and python -c for quick one-liner evaluations.",
        "man_url": "https://docs.python.org/3/using/cmdline.html",
        "flags": {
            "-V": "Print Python version",
            "-c": "Execute command string",
            "-m": "Run module as script",
        
            "-W": "Warning control (error, ignore, default, all)",
            "-X": "Set implementation-specific options (e.g., -X dev for dev mode with extra checks)",
            "-q": "Quiet mode: suppress copyright and version messages on startup",
            "-O": "Optimize: remove assert statements and __debug__-guarded code",
            "-S": "Do not import the site module on startup (faster but no user site-packages)",
        },
        "common_patterns": ["python script.py", "python -m http.server 8000", "python -m venv venv"],
        "use_cases": [
            "Run a script with python script.py or start an interactive session with just python for quick testing",
            "Spin up a quick local web server with python -m http.server 8000 to serve files from the current directory",
            "Create a virtual environment with python -m venv .venv to isolate project dependencies",
        ],
        "gotchas": [
            "On many systems, python points to Python 2 while python3 points to Python 3 - always verify with python --version and use python3 explicitly if needed",
            "Running python without arguments starts the REPL which can be confusing in scripts - always provide a script path or -c flag in automated contexts",
        ],
        "related": ["pip", "ipython", "conda"],
        "difficulty": "beginner",
    },
    "docker": {
        "description": "Build, ship, and run applications in lightweight isolated containers that package code with all its dependencies, ensuring consistent behavior across environments. The core workflow involves building images from Dockerfiles, running containers from those images, and managing container lifecycle with start/stop/rm.",
        "man_url": "https://docs.docker.com/engine/reference/commandline/docker/",
        "flags": {
            "-v": "Bind mount a volume",
            "-p": "Publish port",
            "-d": "Detached mode",
            "-it": "Interactive with TTY",
            "-e": "Set environment variable",
            "--name": "Assign name to container",
            "--rm": "Remove container when stopped",
        
            "system prune": "Remove all unused data (images, containers, networks)",
            "exec -it": "Open interactive shell in a running container",
            "stats": "Show live resource usage of running containers",
            "inspect": "Return detailed JSON metadata about containers or images",
        },
        "common_patterns": [
            "docker run -it ubuntu bash",
            "docker run -d -p 8080:80 nginx",
            "docker ps",
            "docker images",
            "docker build -t myapp .",
        ],
        "use_cases": [
            "Run a database for local development with docker run -d -p 5432:5432 postgres without installing anything",
            "Build and test an application in a clean environment with docker build -t myapp . && docker run myapp",
            "Use docker compose to orchestrate multi-container applications like a web server, database, and cache together",
        ],
        "gotchas": [
            "Containers are ephemeral by default - data inside a container is lost when it is removed; use volumes (-v) to persist data",
            "Docker images accumulate quickly and consume disk space - regularly run docker system prune to reclaim space from unused images, containers, and volumes",
        ],
        "related": ["podman", "docker-compose", "kubectl"],
        "difficulty": "intermediate",
    },
    "echo": {
        "description": "Display text or variables",
        "man_url": "https://man7.org/linux/man-pages/man1/echo.1.html",
        "flags": {
            "-n": "Don't output trailing newline",
            "-e": "Enable interpretation of backslash escapes",
        
            "-E": "Disable interpretation of backslash escapes (default in bash)",
        },
        "common_patterns": ["echo 'Hello World'", "echo $PATH", "echo -n 'no newline'"],
    
        "use_cases": [
            "Print variable values for debugging: echo \"Value is: $MY_VAR\"",
            "Write content to files: echo 'config_line' >> config.txt",
            "Print colored output in terminals: echo -e '\033[31mError\033[0m'",
            "Generate simple text output in scripts for user feedback",
        ],
        "gotchas": [
            "echo -e interpretation varies between shells and systems -- use printf for portable escape handling",
            "echo without quotes on a variable with spaces causes word splitting: echo $var vs echo \"$var\"",
            "echo -n may print literal '-n' in some shells (dash, POSIX sh) instead of suppressing the newline",
            "If the string starts with a dash, echo may interpret it as an option -- use printf '%s\n' instead",
        ],
        "related": ["printf", "cat", "tee"],
        "difficulty": "beginner",
    },
    "date": {
        "description": "Display or set system date and time",
        "man_url": "https://man7.org/linux/man-pages/man1/date.1.html",
        "flags": {
            "-u": "UTC time",
            "-d": "Display specified date",
            "-I": "ISO 8601 format",
        
            "+%FORMAT": "Display date using custom format string",
            "-R": "Output RFC 2822 formatted date",
            "--rfc-3339": "Output RFC 3339 formatted date",
            "-r": "Display last modification time of a file",
        },
        "common_patterns": ["date", "date +%Y-%m-%d", "date '+%Y-%m-%d %H:%M:%S'"],
    
        "use_cases": [
            "Display current date and time: date",
            "Format date for filenames: date +%Y-%m-%d_%H%M%S",
            "Get ISO 8601 formatted date: date -I or date --iso-8601",
            "Display a specific date: date -d 'next Friday'",
            "Calculate time differences: date -d '3 days ago' +%Y-%m-%d",
            "Get Unix epoch timestamp: date +%s",
        ],
        "gotchas": [
            "The -d flag (display a specific date) is a GNU extension and does not work on macOS/BSD -- use gdate from coreutils or the -v flag on macOS instead",
            "date format specifiers are case-sensitive: %m is month, %M is minute; %d is day-of-month, %D is mm/dd/yy",
            "Setting the system date (date -s) requires root privileges and does not update the hardware clock -- use hwclock to sync",
        ],
        "related": ["cal", "timedatectl", "hwclock"],
        "difficulty": "beginner",
    },
    "sleep": {
        "description": "Delay for specified time",
        "man_url": "https://man7.org/linux/man-pages/man1/sleep.1.html",
        "flags": {},
        "common_patterns": ["sleep 5", "sleep 0.5", "sleep 1m"],
    
        "use_cases": [
            "Add a delay between retries in a loop: while ! curl -s host; do sleep 5; done",
            "Rate-limit requests in a script: for url in $urls; do curl $url; sleep 1; done",
            "Wait for a service to start: sleep 10 && curl http://localhost:8080/health",
        ],
        "gotchas": [
            "sleep accepts decimal values (sleep 0.5) on GNU/Linux but not on all Unix systems; check portability requirements",
            "sleep supports suffixes: s (seconds, default), m (minutes), h (hours), d (days)",
            "Using sleep in a tight loop wastes time; consider using inotifywait, systemd timers, or polling with exponential backoff instead",
        ],
        "related": ["watch", "timeout", "wait"],
        "difficulty": "beginner",
    },
    "time": {
        "description": "Measure command execution time",
        "man_url": "https://man7.org/linux/man-pages/man1/time.1.html",
        "flags": {
            "-v": "Verbose output with detailed resource usage (GNU time only)",
            "-o": "Write output to file (GNU time only)",
            "-f": "Custom output format string (GNU time only)",
        },
        "common_patterns": ["time command", "time ./script.sh"],
    
        "use_cases": [
            "Measure how long a build takes: time make -j8",
            "Compare performance of different implementations: time ./version1 vs time ./version2",
            "Identify if a slow command is CPU-bound (high user time) or I/O-bound (real >> user+sys)",
        ],
        "gotchas": [
            "Bash has a built-in 'time' keyword that behaves differently from /usr/bin/time; use \time or command time to get the external version with more options",
            "The bash builtin 'time' cannot output to a file directly; use { time command; } 2> timing.txt",
            "'real' is wall-clock time, 'user' is CPU time in user space, 'sys' is CPU time in kernel space; real > user+sys indicates I/O waits",
        ],
        "related": ["perf", "strace", "timeout"],
        "difficulty": "beginner",
    },
    "watch": {
        "description": "Execute command repeatedly and display output",
        "man_url": "https://man7.org/linux/man-pages/man1/watch.1.html",
        "flags": {
            "-n": "Interval in seconds",
            "-d": "Highlight differences",
        
            "-t": "Turn off the header showing interval and command",
            "-g": "Exit when the output of the command changes",
            "-e": "Freeze output and exit on command error",
            "-c": "Interpret ANSI color sequences",
            "-x": "Pass command to exec instead of sh -c (avoids shell interpretation)",
        },
        "common_patterns": ["watch -n 1 'date'", "watch df -h"],
    
        "use_cases": [
            "Monitor disk space usage in real time: watch -n 5 df -h",
            "Watch a deployment roll out: watch -n 2 kubectl get pods",
            "Track file changes: watch -d ls -la /path/to/dir",
            "Monitor network connections: watch -n 1 'ss -tn | wc -l'",
        ],
        "gotchas": [
            "The command must be quoted if it contains pipes or special characters: watch 'cmd1 | cmd2'",
            "watch runs the command through sh -c, so bash-specific syntax may not work; use explicit bash -c if needed",
            "The -d flag highlights changes between refreshes, making differences easy to spot",
        ],
        "related": ["tail", "timeout"],
        "difficulty": "beginner",
    },
    "history": {
        "description": "Display command history",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-History-Builtins.html",
        "flags": {
            "-c": "Clear history list",
        
            "-a": "Append the current session's new history lines to the history file",
            "-n": "Read history lines not already read from the history file into the current list",
            "-w": "Write current history list to the history file (overwrite)",
            "-r": "Read the history file and append its contents to the current history list",
            "-p": "Perform history expansion on the arguments and display the result without storing",
            "-s": "Append the arguments to the history list as a single entry (without executing)",
        },
        "common_patterns": ["history", "history | grep pattern"],
    
        "use_cases": [
            "Search previous commands: history | grep ssh",
            "Re-execute command number 42: !42",
            "Delete a sensitive entry: history -d 150",
            "Write current history to file immediately: history -w",
            "Read history from file (sync across terminals): history -r",
            "Clear all history for the session: history -c",
        ],
        "gotchas": [
            "history -c clears the in-memory history but not the file -- use history -c && history -w to clear both",
            "Passwords or secrets typed on the command line are saved in ~/.bash_history -- delete sensitive entries with history -d",
            "By default, history is written when the shell exits -- concurrent terminals can overwrite each other's history",
            "Use HISTCONTROL=ignorespace to prevent commands starting with a space from being saved",
            "HISTSIZE controls in-memory entries; HISTFILESIZE controls on-disk entries -- set both",
        ],
        "related": ["fc", "bind", "shopt"],
        "difficulty": "beginner",
    },
    "alias": {
        "description": "Create command aliases",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "flags": {
            "-p": "Print all defined aliases in a reusable format",
        },
        "common_patterns": ["alias", "alias ll='ls -la'", "alias gs='git status'"],
    
        "use_cases": [
            "Shorten frequent commands: alias gs='git status'",
            "Add safety nets: alias rm='rm -i'",
            "List all defined aliases: alias",
            "Create multi-command shortcuts: alias update='sudo apt update && sudo apt upgrade'",
        ],
        "gotchas": [
            "Aliases are NOT expanded in non-interactive shells (scripts) by default -- use shopt -s expand_aliases to enable",
            "Aliases do not accept arguments -- use a function if you need parameters",
            "Aliases are expanded at definition time, not execution time -- redefining a referenced command after the alias has no effect",
            "Alias expansion happens before other expansions, which can cause surprising interactions",
        ],
        "related": ["unalias", "function", "command", "builtin"],
        "difficulty": "beginner",
    },
    "test": {
        "description": "Evaluate conditional expression",
        "man_url": "https://man7.org/linux/man-pages/man1/test.1.html",
        "flags": {
            "-e": "File exists",
            "-f": "Is regular file",
            "-d": "Is directory",
            "-r": "Is readable",
            "-w": "Is writable",
            "-x": "Is executable",
            "-z": "String is empty",
            "-n": "String is non-empty",
        
            "-s": "True if file exists and has size greater than zero",
            "-L": "True if file is a symbolic link",
            "-p": "True if file is a named pipe (FIFO)",
            "-S": "True if file is a socket",
            "-O": "True if file is owned by the effective user ID",
            "-G": "True if file is owned by the effective group ID",
            "-nt": "True if file1 is newer than file2 (modification date)",
            "-ot": "True if file1 is older than file2",
            "-ef": "True if file1 and file2 refer to the same inode (hard links)",
        },
        "common_patterns": ["test -f file.txt && echo 'exists'", "[ -d dir ] && cd dir"],
    
        "use_cases": [
            "Check if a file exists: test -f config.yaml && source config.yaml",
            "Compare integers: test $count -gt 0",
            "Check if a variable is set: test -n \"$VAR\"",
            "Check if a string is empty: test -z \"$input\"",
        ],
        "gotchas": [
            "Unquoted variables in test cause errors with spaces or empty values: test -f $file fails if file is empty or has spaces",
            "test uses single = for string comparison (not ==, though bash's test also accepts ==)",
            "Numeric comparisons use -eq, -lt, -gt -- not < or > (which are redirections inside [ ])",
            "test and [ are identical -- [ is not special syntax, it is a command that requires a closing ]",
        ],
        "related": ["[", "[[", "if"],
        "difficulty": "beginner",
    },
    "read": {
        "description": "Read line from stdin into variable",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "flags": {
            "-p": "Prompt string",
            "-r": "Raw input (no backslash escaping)",
            "-s": "Silent mode (for passwords)",
            "-t": "Timeout in seconds",
        
            "-a": "Read words into an indexed array variable",
            "-d": "Use specified delimiter instead of newline to terminate input",
            "-n": "Read exactly N characters (does not wait for newline)",
            "-N": "Read exactly N characters, ignoring delimiters",
            "-i": "Use specified text as initial input for readline editing (with -e)",
            "-e": "Use readline for input (allows arrow keys, history in interactive use)",
            "-u": "Read from file descriptor N instead of stdin",
        },
        "common_patterns": ["read -p 'Enter name: ' name", "read -s -p 'Password: ' pass"],
    
        "use_cases": [
            "Prompt for user input: read -p 'Enter your name: ' name",
            "Read a password without echoing: read -s -p 'Password: ' pass",
            "Parse delimited data: IFS=: read -r user _ uid gid _ home shell < /etc/passwd",
            "Read a file line by line: while IFS= read -r line; do echo \"$line\"; done < file.txt",
            "Read with a timeout for non-blocking input: read -t 5 -p 'Quick! ' answer",
        ],
        "gotchas": [
            "Without -r, backslashes are treated as escape characters and consumed -- always use read -r for raw input",
            "Without setting IFS='', leading and trailing whitespace is trimmed from the input",
            "Piping into read runs it in a subshell, so variables set inside are lost: echo x | read var (var is empty after)",
            "The correct pattern for file reading is: while IFS= read -r line; do ...; done < file (not cat file | while read)",
            "read returns non-zero at EOF even if it read partial data -- check the variable, not just the exit status",
        ],
        "related": ["echo", "printf", "cat", "select"],
        "difficulty": "beginner",
    },
    "basename": {
        "description": "Strip directory and suffix from filename",
        "man_url": "https://man7.org/linux/man-pages/man1/basename.1.html",
        "flags": {
            "-s": "Remove suffix",
        
            "-a": "Support multiple arguments (print basename of each)",
            "-z": "End each output line with NUL instead of newline (for use with xargs -0)",
        },
        "common_patterns": ["basename /path/to/file.txt", "basename /path/to/file.txt .txt"],
    
        "use_cases": [
            "Extract filename from a full path: basename /home/user/documents/report.pdf",
            "Strip a known extension: basename report.pdf .pdf gives 'report'",
            "Get script name inside a script: script_name=$(basename \"$0\")",
            "Process multiple files with -a: basename -a /path/to/file1 /path/to/file2",
        ],
        "gotchas": [
            "basename is purely string manipulation -- it does not check if the file exists",
            "For extension stripping, the suffix must match exactly: basename file.tar.gz .gz gives 'file.tar', not 'file'",
            "In bash, parameter expansion can replace basename: ${path##*/} is faster than $(basename \"$path\")",
            "basename with a trailing slash on a directory path still returns the directory name",
        ],
        "related": ["dirname", "realpath", "readlink"],
        "difficulty": "beginner",
    },
    "dirname": {
        "description": "Strip last component from filename",
        "man_url": "https://man7.org/linux/man-pages/man1/dirname.1.html",
        "flags": {
            "-z": "End each output line with NUL instead of newline",
        },
        "common_patterns": ["dirname /path/to/file.txt", "cd $(dirname $0)"],
    
        "use_cases": [
            "Get the parent directory of a file: dirname /home/user/file.txt gives /home/user",
            "Navigate relative to the script's location: cd \"$(dirname \"$0\")\"",
            "Construct sibling paths: config=$(dirname \"$0\")/config.ini",
        ],
        "gotchas": [
            "dirname is purely string manipulation -- it does not check if the directory exists or resolve symlinks",
            "dirname of a bare filename (no slashes) returns '.' (the current directory)",
            "In bash, parameter expansion can replace dirname: ${path%/*} is faster than $(dirname \"$path\")",
            "dirname on a path ending with / may return the same path or the parent depending on trailing slash handling",
        ],
        "related": ["basename", "realpath", "readlink", "pwd"],
        "difficulty": "beginner",
    },
    "realpath": {
        "description": "Print resolved absolute pathname",
        "man_url": "https://man7.org/linux/man-pages/man1/realpath.1.html",
        "flags": {
            "-e": "All components must exist",
            "-s": "Don't expand symlinks",
        
            "--relative-to": "Print the path relative to a specified directory",
            "--relative-base": "Print relative paths if both are descendants of the given base, otherwise absolute",
            "-q": "Quiet mode -- suppress most error messages",
        },
        "common_patterns": ["realpath file.txt", "realpath ."],
    
        "use_cases": [
            "Get the absolute path of a file: realpath ../relative/file.txt",
            "Resolve all symlinks: realpath /usr/bin/python",
            "Normalize a messy path: realpath /home/user/../user/./docs",
            "Check if symlinks resolve without existing: realpath -m /potentially/missing/path",
        ],
        "gotchas": [
            "realpath may not be available on older systems or macOS without coreutils -- use readlink -f as an alternative",
            "realpath -e fails if any path component does not exist; realpath without -e resolves what it can",
            "realpath is not a POSIX standard utility, so it may be missing on minimal systems",
            "On macOS, install coreutils via Homebrew to get GNU realpath (grealpath)",
        ],
        "related": ["readlink", "dirname", "basename", "pwd"],
        "difficulty": "beginner",
    },
    "seq": {
        "description": "Print sequence of numbers",
        "man_url": "https://man7.org/linux/man-pages/man1/seq.1.html",
        "flags": {
            "-s": "Separator string",
            "-w": "Equalize width with leading zeros",
        
            "-f": "Use printf-style format for output numbers",
        },
        "common_patterns": ["seq 10", "seq 1 10", "seq -w 01 10"],
    
        "use_cases": [
            "Generate numbers from 1 to 10: seq 10",
            "Generate a range with step: seq 0 2 20",
            "Generate zero-padded numbers: seq -w 01 10",
            "Use a custom separator: seq -s ', ' 5",
            "Use in a for loop: for i in $(seq 1 5); do echo $i; done",
        ],
        "gotchas": [
            "seq is not POSIX -- for portability in scripts, use: for i in $(( ... )) or bash brace expansion {1..10}",
            "seq handles floating point numbers: seq 0.1 0.1 1.0 -- but rounding errors can cause unexpected results",
            "Brace expansion {1..10} is expanded at parse time and cannot use variables; seq can: seq 1 $n",
        ],
        "related": ["for", "while", "printf"],
        "difficulty": "beginner",
    },
    "stat": {
        "description": "Display detailed file or filesystem status",
        "man_url": "https://man7.org/linux/man-pages/man1/stat.1.html",
        "flags": {
            "-c": "Use specified FORMAT",
        
            "-L": "Follow symlinks (show target file info)",
            "-f": "Display filesystem status instead of file status",
            "-t": "Print information in terse (machine-parseable) form",
        },
        "common_patterns": ["stat file.txt", "stat -c '%a %n' *"],
    
        "use_cases": [
            "View complete file metadata: stat file.txt",
            "Get numeric permissions: stat -c '%a' file.txt",
            "Get file size in bytes: stat -c '%s' file.txt",
            "Check inode number: stat -c '%i' file.txt",
            "Get human-readable modification time: stat -c '%y' file.txt",
        ],
        "gotchas": [
            "stat -c (format) is GNU/Linux syntax; macOS uses stat -f with different format specifiers",
            "stat follows symlinks by default -- use -L to see the link itself (inverted logic from ls)",
            "The output format tokens (like %a, %s, %y) are completely different between Linux and macOS",
            "stat may show different block sizes depending on the filesystem (512-byte vs 4096-byte blocks)",
        ],
        "related": ["ls", "file", "touch", "chmod"],
        "difficulty": "intermediate",
    },
    "file": {
        "description": "Determine file type by examining content",
        "man_url": "https://man7.org/linux/man-pages/man1/file.1.html",
        "flags": {
            "-b": "Brief mode (don't print filename)",
            "-i": "Output MIME type strings",
        
            "-L": "Follow symbolic links",
            "-z": "Try to look inside compressed files",
            "-k": "Keep going after the first match (show all matching types)",
            "--mime-type": "Print only the MIME type without encoding",
            "--mime-encoding": "Print only the MIME encoding",
        },
        "common_patterns": ["file *", "file -i document.pdf"],
    
        "use_cases": [
            "Identify file type before processing: file downloaded_file",
            "Check MIME type for HTTP Content-Type: file -i document.pdf",
            "Verify a binary's architecture: file /usr/bin/ls",
            "Batch-check all files in a directory: file *",
            "Determine encoding of a text file: file -i textfile.txt",
        ],
        "gotchas": [
            "file examines content, not the extension -- renaming a PNG to .txt does not fool it",
            "file may not correctly identify files with unusual or corrupted headers",
            "-i on macOS gives different output format than on Linux (macOS uses --mime instead)",
            "The magic database (/usr/share/misc/magic) can be customized but rarely needs to be",
        ],
        "related": ["stat", "ls", "hexdump"],
        "difficulty": "beginner",
    },
    "less": {
        "description": "View file contents with scrolling and search",
        "man_url": "https://man7.org/linux/man-pages/man1/less.1.html",
        "flags": {
            "-N": "Show line numbers",
            "-S": "Chop long lines",
            "-R": "Show raw control characters (for colors)",
        
            "-F": "Quit immediately if the entire file fits on one screen",
            "-X": "Don't clear the screen on exit (leave content visible)",
            "-i": "Case-insensitive search (unless pattern has uppercase)",
            "-g": "Highlight only the current search match (not all matches)",
            "+G": "Start at the end of the file",
        },
        "common_patterns": ["less file.txt", "command | less"],
    
        "use_cases": [
            "View a large file with scrolling: less /var/log/syslog",
            "Search within a file: press / then type a pattern",
            "View command output: ps aux | less",
            "Follow a growing file (like tail -f): less +F logfile.log",
            "View multiple files: less file1.txt file2.txt (use :n and :p to navigate)",
        ],
        "gotchas": [
            "less loads files lazily and does not read the entire file into memory -- ideal for huge files",
            "Press q to quit, not Ctrl-C (Ctrl-C interrupts a search or input, it does not exit)",
            "Use -R to properly display colored output from commands like git diff or grep --color",
            "less interprets some escape codes by default; use -r (raw) for full binary passthrough, or -R for ANSI only",
            "Setting LESSOPEN/LESSCLOSE can make less interpret compressed files, PDFs, etc.",
        ],
        "related": ["more", "cat", "head", "tail"],
        "difficulty": "beginner",
    },
    "more": {
        "description": "View file contents one screen at a time",
        "man_url": "https://man7.org/linux/man-pages/man1/more.1.html",
        "flags": {
            "-d": "Display help message at the bottom instead of ringing bell on illegal key",
            "-s": "Squeeze multiple blank lines into one",
            "+/pattern": "Start displaying at the first line matching the pattern",
        },
        "common_patterns": ["more file.txt"],
    
        "use_cases": [
            "View a file one screen at a time: more file.txt",
            "Pipe long output for pagination: dmesg | more",
            "Start at a specific line: more +100 file.txt",
        ],
        "gotchas": [
            "more only scrolls forward, not backward -- use less if you need to scroll up",
            "more exits automatically when you reach the end of the file",
            "On most modern Linux systems, more is actually a simplified version of less",
            "more does not support searching as well as less does",
        ],
        "related": ["less", "cat", "head", "tail"],
        "difficulty": "beginner",
    },
    "clear": {
        "description": "Clear terminal screen",
        "man_url": "https://man7.org/linux/man-pages/man1/clear.1.html",
        "flags": {
            "-T": "Specify the terminal type to use instead of the TERM environment variable",
            "-V": "Print version information",
        },
        "common_patterns": ["clear"],
    
        "use_cases": [
            "Clear the terminal screen: clear",
            "Clear screen in a script for clean output presentation",
            "Clear screen and scrollback buffer: clear -x (if supported)",
        ],
        "gotchas": [
            "clear sends terminal escape codes -- it does not actually delete anything from the scrollback on all terminals",
            "Ctrl-L in bash also clears the screen but preserves the current command line (different from running clear)",
            "In scripts, printf '\033[2J\033[H' is a more portable way to clear the screen",
            "Some terminal emulators support clear -x to also clear the scrollback buffer",
        ],
        "related": ["reset", "tput"],
        "difficulty": "beginner",
    },
    "man": {
        "description": "Display manual pages for commands",
        "man_url": "https://man7.org/linux/man-pages/man1/man.1.html",
        "flags": {
            "-k": "Search manual page names and descriptions",
        
            "-a": "Display all matching man pages in sequence, not just the first",
            "-w": "Print the location of the man page file instead of displaying it",
            "-K": "Search for a string in all man pages (slow full-text search)",
        },
        "common_patterns": ["man ls", "man -k keyword"],
    
        "use_cases": [
            "Read the manual for a command: man ls",
            "Search for a keyword across all man pages: man -k compression",
            "View a specific section: man 3 printf (C library function, not shell command)",
            "View the man page for man itself: man man",
            "Display a one-line description: man -f ls (equivalent to whatis)",
        ],
        "gotchas": [
            "Man page sections matter: man printf shows the shell command; man 3 printf shows the C function",
            "man -k requires the mandb database to be built -- run sudo mandb if -k returns nothing",
            "Man pages are displayed using a pager (usually less) -- all less keybindings work inside man",
            "Some builtins (like cd, source) do not have their own man page -- use man bash and search within it",
            "MANPATH controls where man looks; if it is incorrectly set, man may not find pages",
        ],
        "related": ["info", "help", "apropos", "whatis"],
        "difficulty": "beginner",
    },
    "ping": {
        "description": "Send ICMP ECHO_REQUEST packets to network hosts",
        "man_url": "https://man7.org/linux/man-pages/man8/ping.8.html",
        "flags": {
            "-c": "Stop after N packets",
            "-i": "Interval between packets (seconds)",
        
            "-w": "Deadline timeout: exit after N seconds regardless of packet count",
            "-W": "Timeout waiting for each response in seconds",
            "-s": "Set packet data size in bytes (default 56)",
            "-t": "Set the IP time-to-live",
            "-I": "Specify source interface or address",
            "-f": "Flood ping (requires root, use carefully)",
            "-q": "Quiet output; only show summary at the end",
            "-D": "Print timestamps before each line",
        },
        "common_patterns": ["ping google.com", "ping -c 4 google.com"],
    
        "use_cases": [
            "Test basic network connectivity to a host: ping -c 4 google.com",
            "Continuously monitor a connection with timestamps: ping -D host",
            "Test with a specific packet size to check MTU issues: ping -s 1472 host",
            "Quick check if a host is alive in a script: ping -c 1 -W 2 host > /dev/null 2>&1 && echo up",
        ],
        "gotchas": [
            "Many hosts and firewalls block ICMP, so a failed ping does not necessarily mean the host is down -- the service may still be reachable",
            "On Linux, ping runs indefinitely by default; always use -c to limit count in scripts",
            "Flood ping (-f) requires root and can saturate a network link -- use with extreme caution",
            "ping results show round-trip time, not one-way latency; actual one-way delay is roughly half the RTT",
        ],
        "related": ["traceroute", "mtr", "arping"],
        "difficulty": "beginner",
    },
    "netstat": {
        "description": "Network statistics and connections",
        "man_url": "https://man7.org/linux/man-pages/man8/netstat.8.html",
        "flags": {
            "-t": "TCP connections",
            "-u": "UDP connections",
            "-l": "Listening sockets only",
            "-p": "Show PID/program name",
            "-n": "Numeric addresses (no DNS)",
        
            "-a": "Show all sockets including listening and non-listening",
            "-r": "Display the kernel routing table",
            "-s": "Display summary statistics per protocol",
            "-c": "Continuously refresh the display",
        },
        "common_patterns": ["netstat -tlnp", "netstat -an | grep LISTEN"],
    
        "use_cases": [
            "Find which process is using port 8080: netstat -tlnp | grep 8080",
            "Show all established TCP connections: netstat -tn",
            "List all listening services: netstat -tlnp",
        ],
        "gotchas": [
            "netstat is deprecated in favor of ss, which is faster and provides more information",
            "The -p flag requires root privileges to see process names for all sockets, not just your own",
            "netstat may not be installed by default on modern systems; install the net-tools package",
        ],
        "related": ["ss", "lsof", "ip"],
        "difficulty": "intermediate",
    },
    "ss": {
        "description": "Socket statistics (modern netstat replacement)",
        "man_url": "https://man7.org/linux/man-pages/man8/ss.8.html",
        "flags": {
            "-t": "TCP sockets",
            "-u": "UDP sockets",
            "-l": "Listening sockets",
            "-n": "Numeric (no resolve)",
            "-p": "Show processes",
        
            "-a": "Show both listening and non-listening sockets",
            "-s": "Print summary statistics",
            "-o": "Show timer information",
            "-e": "Show detailed socket information (uid, inode)",
            "-m": "Show socket memory usage",
            "-i": "Show internal TCP information (congestion, RTT)",
            "-K": "Forcibly close a socket",
            "-H": "Suppress header line",
        },
        "common_patterns": ["ss -tlnp", "ss -tulnp"],
    
        "use_cases": [
            "Find which process is listening on port 3000: ss -tlnp | grep 3000",
            "Show all established connections with process info: ss -tnp",
            "Display socket memory usage to debug buffer bloat: ss -tm",
            "Filter connections by state: ss state established '( dport = :443 )'",
            "Display summary statistics for all protocols: ss -s",
        ],
        "gotchas": [
            "The -p flag requires root to show processes for sockets owned by other users",
            "ss filter expressions use a different syntax than netstat grep patterns -- read the man page for the state and address filter syntax",
            "ss output columns differ from netstat; scripts that parse netstat output need rewriting",
        ],
        "related": ["netstat", "lsof", "ip"],
        "difficulty": "intermediate",
    },
    "make": {
        "description": "Build automation tool",
        "man_url": "https://www.gnu.org/software/make/manual/make.html",
        "flags": {
            "-f": "Use specified Makefile",
            "-j": "Parallel jobs",
            "-n": "Dry run",
        
            "-B": "Unconditionally make all targets (force rebuild)",
            "-C": "Change to directory before reading Makefile",
            "-k": "Keep going when some targets cannot be made",
            "-s": "Silent mode, do not echo recipes",
            "-w": "Print working directory info (useful for recursive make)",
            "-q": "Question mode: exit 0 if target is up to date, 1 if not",
            "-p": "Print the database of rules and variables (debug)",
        },
        "common_patterns": ["make", "make target", "make -j4", "make clean"],
    
        "use_cases": [
            "Build a C project with make all or just make to run the default target",
            "Clean build artifacts with make clean before a fresh rebuild",
            "Run a parallel build on all cores with make -j$(nproc) for faster compilation",
            "Perform a dry run to see what commands would execute with make -n before committing",
        ],
        "gotchas": [
            "Makefiles require actual TAB characters for recipe indentation -- spaces cause 'missing separator' errors and this is the single most common Makefile problem",
            "Variables set on the command line (make VAR=val) override values set in the Makefile -- use override directive in the Makefile to prevent this",
            "make -j without a number spawns unlimited parallel jobs which can overwhelm the system -- always specify a count like -j4 or -j$(nproc)",
            "make only rebuilds targets whose dependencies have changed -- if timestamps are wrong (e.g., after a timezone change or git checkout), use make -B to force rebuild",
        ],
        "related": ["cmake", "ninja", "gcc", "autoconf"],
        "difficulty": "intermediate",
    },
    "tsc": {
        "description": "TypeScript compiler",
        "man_url": "https://www.typescriptlang.org/docs/handbook/compiler-options.html",
        "flags": {
            "-w": "Watch mode",
            "--init": "Create tsconfig.json",
            "--noEmit": "Check without emitting",
        
            "--strict": "Enable all strict type-checking options",
            "--outDir": "Redirect output structure to the specified directory",
            "--target": "Set the JavaScript language version for output (es2015, es2020, esnext)",
            "--module": "Set the module system (commonjs, esnext, nodenext)",
            "--declaration": "Generate .d.ts declaration files",
            "--sourceMap": "Generate source map files for debugging",
            "-b": "Build mode for project references",
        },
        "common_patterns": ["tsc", "tsc --init", "tsc -w"],
    
        "use_cases": [
            "Type-check a project without emitting files with tsc --noEmit",
            "Initialize a new TypeScript project with tsc --init",
            "Watch for changes and recompile with tsc -w",
            "Compile a single file with tsc script.ts",
        ],
        "gotchas": [
            "tsc --noEmit is the standard way to use TypeScript for type checking only when a bundler (webpack, esbuild, vite) handles compilation",
            "tsc reads tsconfig.json by default -- command-line flags override tsconfig settings but file lists do not merge intuitively",
            "tsc does not bundle or minify -- it only transpiles TypeScript to JavaScript. Use a bundler for production builds",
            "strict: true in tsconfig.json enables all strict checks -- new projects should always start with this enabled",
        ],
        "related": ["node", "eslint", "prettier", "jest"],
        "difficulty": "intermediate",
    },
    "eslint": {
        "description": "JavaScript/TypeScript linter",
        "man_url": "https://eslint.org/docs/user-guide/command-line-interface",
        "flags": {
            "--fix": "Automatically fix problems",
            "--ext": "File extensions to lint",
        
            "--cache": "Only check changed files for faster linting on large projects",
            "--max-warnings": "Set max warnings before exit with error (0 for strict)",
            "--no-eslintrc": "Disable use of configuration from .eslintrc files",
            "--format": "Set output format (stylish, json, compact, etc.)",
        },
        "common_patterns": ["eslint .", "eslint --fix ."],
    
        "use_cases": [
            "Lint all JavaScript files in a project with eslint .",
            "Auto-fix linting issues with eslint --fix .",
            "Lint specific file types with eslint --ext .ts,.tsx src/",
            "Check specific rules with eslint --rule '{no-console: error}' file.js",
        ],
        "gotchas": [
            "ESLint 9+ uses flat config (eslint.config.js) by default -- the old .eslintrc format is deprecated",
            "--fix only fixes rules marked as fixable -- some issues must be resolved manually",
            "ESLint does not lint TypeScript by default -- you need @typescript-eslint/parser and plugin configured",
        ],
        "related": ["prettier", "tsc", "jest"],
        "difficulty": "beginner",
    },
    "prettier": {
        "description": "Code formatter",
        "man_url": "https://prettier.io/docs/en/cli.html",
        "flags": {
            "--write": "Write changes to file",
            "--check": "Check if files are formatted",
        
            "--single-quote": "Use single quotes instead of double quotes",
            "--trailing-comma": "Print trailing commas (all, es5, none)",
            "--tab-width": "Set the number of spaces per indentation level",
            "--ignore-path": "Specify a file to read ignore patterns from",
            "--cache": "Only format changed files for faster execution",
        },
        "common_patterns": ["prettier --write .", "prettier --check ."],
    
        "use_cases": [
            "Format all files in a project with prettier --write .",
            "Check formatting without changing files with prettier --check .",
            "Format a specific file with prettier --write src/index.ts",
        ],
        "gotchas": [
            "prettier --write modifies files in-place with no backup -- commit your changes before running",
            "Prettier is opinionated and has very few configuration options by design -- do not expect to customize every formatting decision",
            "Prettier and ESLint can conflict -- use eslint-config-prettier to disable ESLint rules that conflict with Prettier",
        ],
        "related": ["eslint", "tsc"],
        "difficulty": "beginner",
    },
    "pytest": {
        "description": "Python testing framework",
        "man_url": "https://docs.pytest.org/en/stable/reference/reference.html",
        "flags": {
            "-v": "Verbose output",
            "-x": "Stop on first failure",
            "-k": "Filter tests by expression",
            "--cov": "Coverage report",
        
            "-s": "Do not capture stdout/stderr (show print output during tests)",
            "-m": "Only run tests with specific markers (e.g., -m 'not slow')",
            "--tb": "Traceback style: short, long, line, native, no",
            "--lf": "Re-run only tests that failed last time",
            "--pdb": "Drop into the Python debugger on test failure",
            "-n": "Run tests in parallel with N workers (requires pytest-xdist)",
        },
        "common_patterns": ["pytest", "pytest -v", "pytest --cov=src"],
    
        "use_cases": [
            "Run all tests in a project with pytest",
            "Run a specific test file with pytest tests/test_auth.py",
            "Run tests matching a keyword with pytest -k 'test_login and not slow'",
            "Generate an HTML coverage report with pytest --cov=src --cov-report=html",
        ],
        "gotchas": [
            "pytest discovers tests automatically in files named test_*.py or *_test.py -- naming your test files differently will skip them silently",
            "Fixtures are powerful but can create implicit dependencies that are hard to trace -- use explicit fixture parameters",
            "pytest --cov requires the pytest-cov plugin to be installed -- it is not built into pytest",
            "Tests modify shared state (databases, files) at your peril -- pytest-xdist for parallel execution amplifies any shared-state bugs",
        ],
        "related": ["python", "tox", "coverage"],
        "difficulty": "beginner",
    },
    "jest": {
        "description": "JavaScript testing framework",
        "man_url": "https://jestjs.io/docs/cli",
        "flags": {
            "--watch": "Watch mode",
            "--coverage": "Collect coverage",
        
            "--runInBand": "Run tests serially in the current process instead of parallel workers",
            "--verbose": "Display individual test results in a hierarchy",
            "--bail": "Stop running tests after N failures (default 0 = run all)",
            "--passWithNoTests": "Exit with 0 even if no tests are found",
            "--forceExit": "Force Jest to exit after all tests complete (kills dangling handles)",
        },
        "common_patterns": ["jest", "jest --watch", "jest --coverage"],
    
        "use_cases": [
            "Run all tests with jest",
            "Run tests in watch mode during development with jest --watch",
            "Run tests matching a pattern with jest --testPathPattern='auth'",
            "Generate a coverage report with jest --coverage",
        ],
        "gotchas": [
            "Jest runs tests in parallel by default -- tests that share state (databases, files) may fail intermittently. Use --runInBand for serial execution",
            "Jest uses its own module resolution that does not support ES modules natively -- configure transform with ts-jest or @swc/jest for TypeScript",
            "Jest's --coverage can significantly slow down test runs -- only use it in CI, not during development",
        ],
        "related": ["eslint", "prettier", "node", "tsc"],
        "difficulty": "beginner",
    },
    "killall": {
        "description": "Kill processes by name",
        "man_url": "https://man7.org/linux/man-pages/man1/killall.1.html",
        "flags": {
            "-9": "SIGKILL - force kill",
            "-i": "Interactive, ask before killing",
        
            "-e": "Require exact match of very long names (over 15 characters)",
            "-u": "Kill only processes owned by the specified user",
            "-w": "Wait for all killed processes to die before returning",
            "-r": "Interpret process name as an extended regular expression",
        },
        "common_patterns": ["killall process-name", "killall -9 hung-process"],
    
        "use_cases": [
            "Kill all instances of a process by name: killall firefox",
            "Gracefully stop all node processes: killall -TERM node",
            "Force-kill all hung instances: killall -9 frozen-app",
        ],
        "gotchas": [
            "On Solaris, killall kills ALL processes (not by name) -- this Linux-specific behavior does not transfer to other Unix systems",
            "killall requires an exact process name match; use pkill -f for partial or command-line matching",
            "Without -i, killall provides no confirmation before killing multiple matching processes",
        ],
        "related": ["kill", "pkill", "pgrep", "ps"],
        "difficulty": "beginner",
    },
    "pkill": {
        "description": "Signal processes based on pattern matching",
        "man_url": "https://man7.org/linux/man-pages/man1/pkill.1.html",
        "flags": {
            "-f": "Match against full command line",
            "-9": "Send SIGKILL",
        
            "-x": "Require an exact match of the process name",
            "-u": "Match only processes running as the specified user",
            "-t": "Match only processes on the specified terminal",
            "-P": "Match only processes whose parent PID matches",
            "-o": "Select only the oldest (longest-running) matching process",
            "-n": "Select only the newest (most recently started) matching process",
        },
        "common_patterns": ["pkill -f 'node server'", "pkill -9 hung-process"],
    
        "use_cases": [
            "Kill all processes matching a pattern: pkill -f 'node server.js'",
            "Signal all processes of a specific user: pkill -u baduser",
            "Send SIGHUP to reload all nginx workers: pkill -HUP nginx",
        ],
        "gotchas": [
            "Without -f, pkill only matches against the process name (first 15 chars), not the full command line",
            "pkill matches with regex, so special characters in patterns need escaping",
            "pkill returns exit code 1 if no processes matched, which can cause script failures with set -e",
        ],
        "related": ["pgrep", "kill", "killall", "ps"],
        "difficulty": "beginner",
    },
    "pgrep": {
        "description": "Find processes based on pattern matching",
        "man_url": "https://man7.org/linux/man-pages/man1/pgrep.1.html",
        "flags": {
            "-f": "Match against full command line",
            "-l": "List process name and ID",
        
            "-a": "List PID and full command line of matching processes",
            "-c": "Count matching processes instead of listing PIDs",
            "-d": "Set the delimiter between PIDs (default newline)",
        },
        "common_patterns": ["pgrep -f 'node'", "pgrep -l python"],
    
        "use_cases": [
            "Find PIDs of all python processes: pgrep python",
            "Check if a specific service is running: pgrep -x nginx && echo running",
            "List processes with their names: pgrep -la node",
            "Find processes belonging to a user: pgrep -u www-data",
        ],
        "gotchas": [
            "pgrep returns exit code 1 when no match is found, which is useful for conditionals but can break set -e scripts",
            "Without -f, pgrep only matches the first 15 characters of the process name",
            "pgrep may match itself if your grep pattern appears in the pgrep command line; -x for exact match helps",
        ],
        "related": ["pkill", "ps", "kill"],
        "difficulty": "beginner",
    },
    "htop": {
        "description": "Interactive process viewer (improved top)",
        "man_url": "https://htop.dev/",
        "flags": {
            "-u": "Show only processes for specified user",
            "-t": "Tree view",
        
            "-d": "Set refresh delay in tenths of seconds",
            "-p": "Monitor specific PIDs only",
            "-s": "Sort by the specified column",
            "-C": "Use monochrome mode",
        },
        "common_patterns": ["htop", "htop -u username"],
    
        "use_cases": [
            "Interactively browse and kill processes with a user-friendly color interface",
            "View per-CPU core utilization bars to identify single-threaded bottlenecks",
            "Filter processes by name with / and search incrementally",
            "Show a process tree with F5 to understand parent-child relationships",
        ],
        "gotchas": [
            "htop is not installed by default on most systems; you need to install it from your package manager",
            "htop shows threads by default (unlike top), which can make the process count seem much higher than expected; press H to toggle",
            "Memory bars include shared memory which can overcount total usage when summing process memory",
        ],
        "related": ["top", "btop", "atop", "ps"],
        "difficulty": "beginner",
    },
    "whereis": {
        "description": "Locate binary, source, and manual pages for command",
        "man_url": "https://man7.org/linux/man-pages/man1/whereis.1.html",
        "flags": {
            "-b": "Search for binaries only",
            "-m": "Search for manual pages only",
        },
        "common_patterns": ["whereis python", "whereis -b node"],
    
        "use_cases": [
            "Find binary, source, and man page locations: whereis gcc",
            "Find only the binary: whereis -b python",
            "Find only man pages: whereis -m bash",
            "Discover installed documentation: whereis -m ls",
        ],
        "gotchas": [
            "whereis searches hardcoded system directories, not your PATH -- it may miss binaries in non-standard locations",
            "whereis may return multiple results if the same name exists in different standard locations",
            "Unlike which, whereis does not tell you which binary would actually run -- it just lists known locations",
            "whereis is not available on all systems (it comes from util-linux on Linux)",
        ],
        "related": ["which", "type", "command", "locate", "man"],
        "difficulty": "beginner",
    },
    "type": {
        "description": "Describe how command name would be interpreted",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "flags": {
            "-a": "Display all locations",
            "-t": "Print single word (alias, keyword, function, builtin, file)",
        },
        "common_patterns": ["type ls", "type -a python"],
    
        "use_cases": [
            "Determine how a command name is resolved: type ls (shows alias, builtin, or path)",
            "Get just the type classification: type -t cd gives 'builtin'",
            "Show all interpretations: type -a echo shows both the builtin and /usr/bin/echo",
            "Check if something is a function: type -t my_func gives 'function'",
        ],
        "gotchas": [
            "type is a bash builtin that shows how BASH would resolve a name -- including aliases, functions, builtins, and PATH lookup",
            "type -t returns one of: alias, keyword, function, builtin, file -- useful for conditional logic in scripts",
            "Unlike which, type knows about shell internals (builtins, aliases, functions) and is always correct for the current shell",
            "type -a can show that a name resolves multiple ways -- e.g., echo is both a builtin and an external binary",
        ],
        "related": ["which", "command", "whereis", "hash"],
        "difficulty": "beginner",
    },
    "printf": {
        "description": "Format and print data",
        "man_url": "https://man7.org/linux/man-pages/man1/printf.1.html",
        "flags": {
            "-v": "Assign the output to a variable instead of printing to stdout (bash extension)",
        },
        "common_patterns": ["printf '%s\\n' 'Hello'", "printf '%d\\n' 42"],
    
        "use_cases": [
            "Portable formatted output in scripts: printf '%s\n' \"$message\"",
            "Print padded or aligned columns: printf '%-20s %5d\n' \"$name\" \"$count\"",
            "Generate NUL-delimited output for xargs -0: printf '%s\0' \"${files[@]}\"",
            "Create formatted log entries with timestamps: printf '[%s] %s\n' \"$(date)\" \"$msg\"",
            "Safely print strings that may start with dashes (unlike echo)",
        ],
        "gotchas": [
            "printf does NOT add a trailing newline by default -- you must include \n explicitly",
            "The format string is reused if there are more arguments than format specifiers: printf '%s\n' a b c prints three lines",
            "Octal escape \\0NNN in printf format differs from echo -e which uses \\NNN",
            "%q format is bash-specific and not POSIX portable",
        ],
        "related": ["echo", "cat", "tee", "seq"],
        "difficulty": "beginner",
    },
    "true": {
        "description": "Return exit status 0 (success)",
        "man_url": "https://man7.org/linux/man-pages/man1/true.1.html",
        "flags": {},
        "common_patterns": ["while true; do command; sleep 1; done"],
    
        "use_cases": [
            "Create an infinite loop: while true; do process_queue; sleep 1; done",
            "Provide a guaranteed-success command in a pipeline or conditional",
            "Default success action: command || true (suppress failure exit code)",
            "Placeholder for an unfinished function body",
        ],
        "gotchas": [
            "true is both a shell builtin and an external command (/bin/true) -- the builtin is faster",
            "In some contexts, : (colon) is preferred over true as the no-op command because it is always a builtin",
            "true ignores all arguments silently -- true --help still returns 0 (the builtin version)",
        ],
        "related": ["false", ":", "test"],
        "difficulty": "beginner",
    },
    "false": {
        "description": "Return exit status 1 (failure)",
        "man_url": "https://man7.org/linux/man-pages/man1/false.1.html",
        "flags": {},
        "common_patterns": ["false || echo 'command failed'"],
    
        "use_cases": [
            "Test error handling: false || echo 'caught failure'",
            "Force a script to exit under set -e: false",
            "Disable a feature flag: ENABLED=false; if $ENABLED; then ... (note: this runs the false command)",
        ],
        "gotchas": [
            "false always returns exit code 1, not an arbitrary non-zero value",
            "Using $ENABLED where ENABLED=false runs the false command -- this works but is unconventional; prefer [[ $ENABLED == true ]]",
            "false is both a builtin and an external binary; the builtin is used by default",
        ],
        "related": ["true", ":", "exit", "return"],
        "difficulty": "beginner",
    },
    "umask": {
        "description": "Set default file creation permissions mask",
        "man_url": "https://man7.org/linux/man-pages/man2/umask.2.html",
        "flags": {
            "-S": "Display mask in symbolic form",
        },
        "common_patterns": ["umask", "umask 022", "umask -S"],
    
        "use_cases": [
            "Check current umask: umask",
            "Set restrictive default permissions: umask 077 (owner-only access)",
            "Set permissive defaults for shared directories: umask 002",
        ],
        "gotchas": [
            "umask is a mask (inverted) -- umask 022 means files get 644, not 022",
            "umask only affects new file creation, not existing files",
            "Different shells and login methods may set different default umasks -- check /etc/profile and PAM config",
        ],
        "related": ["chmod", "mkdir", "touch", "install"],
        "difficulty": "intermediate",
    },
    "chgrp": {
        "description": "Change group ownership",
        "man_url": "https://man7.org/linux/man-pages/man1/chgrp.1.html",
        "flags": {
            "-R": "Recursive change",
        
            "-h": "Change the symlink itself rather than the file it points to",
            "--reference": "Use the group of a reference file",
        },
        "common_patterns": ["chgrp group file.txt", "chgrp -R group directory/"],
    
        "use_cases": [
            "Change file group ownership: chgrp developers project/",
            "Recursively change group: chgrp -R www-data /var/www",
            "Change group using a reference file: chgrp --reference=ref.txt target.txt",
        ],
        "gotchas": [
            "Non-root users can only change to groups they belong to",
            "chgrp follows symlinks by default -- use -h to change the symlink itself",
        ],
        "related": ["chown", "chmod", "groups", "newgrp"],
        "difficulty": "intermediate",
    },
    "bzip2": {
        "description": "Block-sorting file compressor",
        "man_url": "https://man7.org/linux/man-pages/man1/bzip2.1.html",
        "flags": {
            "-d": "Decompress",
            "-k": "Keep original file",
            "-9": "Best compression",
        
            "-c": "Write to stdout, keep original files",
            "-v": "Verbose: show compression ratio for each file",
            "-f": "Force overwrite of output files",
            "-s": "Reduce memory usage at the cost of compression ratio",
        },
        "common_patterns": ["bzip2 file.txt", "bzip2 -d file.txt.bz2"],
    
        "use_cases": [
            "Compress a file with higher ratio than gzip: bzip2 file.txt",
            "Compress while keeping the original: bzip2 -k file.txt",
            "Decompress a .bz2 file: bzip2 -d file.txt.bz2",
            "Test integrity of a compressed file: bzip2 -t file.bz2",
        ],
        "gotchas": [
            "bzip2 is significantly slower than gzip for both compression and decompression -- use it only when the better compression ratio matters",
            "bzip2 replaces the original file by default, just like gzip -- use -k to keep the original",
            "bzip2 does not support compression levels like gzip; its block size (-1 through -9) controls memory usage, not compression quality in the same way",
        ],
        "related": ["bunzip2", "bzcat", "gzip", "xz", "zstd"],
        "difficulty": "beginner",
    },
    "xz": {
        "description": "High-ratio file compressor using LZMA2",
        "man_url": "https://man7.org/linux/man-pages/man1/xz.1.html",
        "flags": {
            "-d": "Decompress",
            "-k": "Keep original file",
            "-9": "Best compression",
        
            "-T": "Set number of compression threads (0 = auto-detect CPU count)",
            "-c": "Write to stdout, keep original files",
            "-l": "List information about .xz files",
            "-t": "Test compressed file integrity",
            "-e": "Use extreme compression (slower but slightly smaller)",
        },
        "common_patterns": ["xz file.txt", "xz -d file.txt.xz"],
    
        "use_cases": [
            "Compress a file with very high compression ratio: xz file.txt",
            "Compress while keeping the original: xz -k file.txt",
            "Decompress an .xz file: xz -d file.txt.xz",
            "Use multiple CPU cores for compression: xz -T0 file.txt",
            "Compress with maximum ratio: xz -9 file.txt",
        ],
        "gotchas": [
            "xz achieves the best compression ratio of common tools but is much slower than gzip or zstd -- use it for archival, not real-time compression",
            "xz -9 uses significant memory (up to ~674 MB) -- on low-memory systems, use -6 or lower",
            "xz replaces the original file by default -- use -k to keep the original",
            "Threaded compression (-T0) produces different output than single-threaded, so checksums will differ for the same input",
        ],
        "related": ["unxz", "xzcat", "gzip", "bzip2", "zstd"],
        "difficulty": "beginner",
    },
    "cal": {
        "description": "Display calendar",
        "man_url": "https://man7.org/linux/man-pages/man1/cal.1.html",
        "flags": {
            "-y": "Display whole year",
            "-3": "Display previous, current, and next month",
        
            "-j": "Display Julian day numbers (day of year)",
            "-m": "Start the week on Monday",
            "-w": "Display ISO week numbers",
        },
        "common_patterns": ["cal", "cal -y", "cal 12 2024"],
    
        "use_cases": [
            "Display the current month: cal",
            "Display the whole year: cal -y",
            "Show 3 months (previous, current, next): cal -3",
            "Display a specific month and year: cal 12 2025",
            "Show week numbers: cal -w",
        ],
        "gotchas": [
            "cal 2024 shows the entire year 2024, not the calendar for the year 2024 BC -- this is rarely an issue but worth noting for scripts",
            "cal starts weeks on Sunday by default in the US locale; use ncal or set locale to change the start day",
            "cal output width is fixed and may not align properly in narrow terminal windows",
        ],
        "related": ["date", "ncal"],
        "difficulty": "beginner",
    },
    "yes": {
        "description": "Output string repeatedly until killed",
        "man_url": "https://man7.org/linux/man-pages/man1/yes.1.html",
        "flags": {},
        "common_patterns": ["yes | command", "yes n | rm -i *"],
    
        "use_cases": [
            "Auto-confirm prompts: yes | apt-get install package-name",
            "Auto-decline prompts: yes n | rm -i *",
            "Generate repeated output for testing: yes 'test line' | head -1000",
            "Stress test output handling: yes > /dev/null &",
        ],
        "gotchas": [
            "yes runs forever until killed or its output pipe closes -- always pipe it to a command or use Ctrl+C to stop",
            "Most package managers have their own -y flag (apt -y, yum -y) which is safer and more explicit than piping yes",
            "yes outputs at maximum speed and can spike CPU usage -- do not run it unpiped as a background process",
        ],
        "related": ["true", "false", "echo"],
        "difficulty": "beginner",
    },
    "shuf": {
        "description": "Shuffle lines randomly",
        "man_url": "https://man7.org/linux/man-pages/man1/shuf.1.html",
        "flags": {
            "-n": "Output at most N lines",
            "-e": "Treat arguments as input lines",
        
            "-i": "Generate integers from LO to HI range instead of reading input",
            "-o": "Write output to a file instead of stdout",
            "-r": "Allow output lines to repeat (sample with replacement)",
            "-z": "Use NUL as line delimiter instead of newline",
        },
        "common_patterns": ["shuf file.txt", "shuf -n 1 file.txt"],
    
        "use_cases": [
            "Select a random line from a file with shuf -n 1 quotes.txt for random quote display",
            "Randomize the order of a playlist or test data with shuf playlist.m3u > shuffled.m3u",
            "Generate random numbers in a range with shuf -i 1-100 -n 10 for sampling",
        ],
        "gotchas": [
            "shuf loads the entire input into memory -- for very large files this can exhaust RAM",
            "The randomness comes from /dev/urandom by default -- for reproducible shuffles use --random-source with a fixed seed file",
        ],
        "related": ["sort", "head", "seq"],
        "difficulty": "beginner",
    },
    "rev": {
        "description": "Reverse lines character by character",
        "man_url": "https://man7.org/linux/man-pages/man1/rev.1.html",
        "flags": {},
        "common_patterns": ["echo 'hello' | rev", "rev file.txt"],
    
        "use_cases": [
            "Reverse each line to extract file extensions with rev | cut -d. -f1 | rev",
            "Check for palindromes in a word list by comparing input with reversed output",
            "Get the last field of a variable-length delimited line when you cannot predict field count",
        ],
        "gotchas": [
            "rev reverses characters within each line, not the order of lines -- use tac to reverse line order",
            "Multi-byte UTF-8 characters may not reverse correctly on all implementations -- test with your locale",
        ],
        "related": ["tac", "cut", "awk"],
        "difficulty": "beginner",
    },
    "tac": {
        "description": "Concatenate and print files in reverse",
        "man_url": "https://man7.org/linux/man-pages/man1/tac.1.html",
        "flags": {
            "-b": "Attach separator before instead of after each record",
            "-r": "Interpret separator as a regular expression",
            "-s": "Use STRING as the record separator instead of newline",
        },
        "common_patterns": ["tac file.txt"],
    
        "use_cases": [
            "View log files with newest entries first with tac /var/log/syslog | head -20",
            "Reverse the order of lines in a file for bottom-up processing with tac input.txt > reversed.txt",
            "Process records separated by blank lines in reverse with tac -s '' data.txt",
        ],
        "gotchas": [
            "tac reverses LINE ORDER, not characters within lines -- use rev to reverse characters",
            "tac reads the entire file into memory for processing -- for very large files consider tail -r on BSD or other approaches",
            "tac is a GNU coreutils command not available on macOS by default -- install via brew install coreutils and use gtac",
        ],
        "related": ["rev", "tail", "sort", "head"],
        "difficulty": "beginner",
    },
    "nl": {
        "description": "Number lines of files",
        "man_url": "https://man7.org/linux/man-pages/man1/nl.1.html",
        "flags": {
            "-b": "Body numbering style (a=all, t=non-empty)",
        
            "-n": "Number format: ln (left justified), rn (right justified), rz (right justified with zeros)",
            "-w": "Set number width (default 6)",
            "-s": "Set separator string between number and line (default TAB)",
            "-i": "Line number increment (default 1)",
            "-v": "Starting line number (default 1)",
            "-p": "Do not reset line numbers at logical page boundaries",
        },
        "common_patterns": ["nl file.txt", "nl -ba file.txt"],
    
        "use_cases": [
            "Number all lines including blanks with nl -ba script.sh for code review",
            "Add right-justified zero-padded line numbers with nl -nrz -w4 file.txt",
            "Number only lines matching a pattern with nl -bp'^function' file.sh",
        ],
        "gotchas": [
            "By default nl only numbers non-empty lines (style t) -- use -ba to number ALL lines including blanks",
            "nl treats lines starting with \\:\\:\\: as page section delimiters (header/body/footer) which can cause unexpected behavior if your data contains these patterns",
            "Line numbers reset at each logical page by default -- use -p to prevent renumbering across sections",
        ],
        "related": ["cat", "pr", "grep"],
        "difficulty": "beginner",
    },
    "paste": {
        "description": "Merge lines of files",
        "man_url": "https://man7.org/linux/man-pages/man1/paste.1.html",
        "flags": {
            "-d": "Delimiter characters",
            "-s": "Paste one file at a time",
        
            "-z": "Use NUL as line delimiter instead of newline",
        },
        "common_patterns": ["paste file1.txt file2.txt", "paste -d',' file1.txt file2.txt"],
    
        "use_cases": [
            "Merge two column files side by side with paste file1.txt file2.txt to create a combined table",
            "Convert a single-column list into a comma-separated line with paste -sd',' file.txt",
            "Interleave lines from stdin into columns with seq 6 | paste - - - to create 3-column output",
        ],
        "gotchas": [
            "The default delimiter is TAB, which may not be visible -- use -d to set an explicit delimiter if you need commas or other separators",
            "The -s flag fundamentally changes behavior from parallel merging (side by side) to serial (one file at a time concatenated horizontally) -- confusing these modes produces unexpected output",
            "When using - for stdin, each - consumes successive lines, so paste - - reads two lines at a time into two columns",
        ],
        "related": ["join", "column", "pr", "cut"],
        "difficulty": "intermediate",
    },
    "join": {
        "description": "Join lines of two files on common field",
        "man_url": "https://man7.org/linux/man-pages/man1/join.1.html",
        "flags": {
            "-t": "Field separator",
        
            "-a": "Also print unpairable lines from the specified file (1 or 2)",
            "-e": "Replace missing input fields with this string",
            "-i": "Ignore case when comparing join fields",
            "-v": "Print only unpairable lines from the specified file",
            "-o": "Specify output format using FILENUM.FIELD notation",
            "-1": "Join on this field of file 1",
            "-2": "Join on this field of file 2",
            "--header": "Treat first line of each file as a header",
        },
        "common_patterns": ["join file1.txt file2.txt"],
    
        "use_cases": [
            "Perform a relational join of two CSV files on a shared key with join -t',' file1.csv file2.csv",
            "Find unmatched lines between two sorted files with join -v 1 sorted1.txt sorted2.txt",
            "Join files on a non-first field with join -1 2 -2 3 file1.txt file2.txt",
        ],
        "gotchas": [
            "Both input files MUST be sorted on the join field before running join -- unsorted input silently produces wrong results rather than an error",
            "By default join matches on the first field with whitespace as separator -- use -t to set the actual delimiter for CSV or TSV data",
            "Lines that do not match are silently dropped unless you use -a or -v to include unpaired lines from one or both files",
        ],
        "related": ["paste", "comm", "sort", "awk"],
        "difficulty": "intermediate",
    },
    "comm": {
        "description": "Compare two sorted files line by line",
        "man_url": "https://man7.org/linux/man-pages/man1/comm.1.html",
        "flags": {
            "-1": "Suppress column 1 (lines unique to file1)",
            "-2": "Suppress column 2 (lines unique to file2)",
            "-3": "Suppress column 3 (lines common to both)",
        
            "--check-order": "Check that input is correctly sorted",
            "--nocheck-order": "Do not check input sort order",
            "--output-delimiter": "Separate columns with this string",
            "-z": "Use NUL as line delimiter instead of newline",
        },
        "common_patterns": ["comm file1.txt file2.txt", "comm -12 file1.txt file2.txt"],
    
        "use_cases": [
            "Find lines common to two sorted files with comm -12 file1.txt file2.txt",
            "Find lines unique to the first file with comm -23 file1.txt file2.txt for set-difference operations",
            "Compare two sorted package lists to find newly installed packages with comm -13 old_pkgs.txt new_pkgs.txt",
        ],
        "gotchas": [
            "Both files MUST be sorted -- comm on unsorted files produces garbage output without any warning",
            "The three columns are: lines only in file1, lines only in file2, lines in both -- the -1 -2 -3 flags SUPPRESS columns, so -12 shows column 3 (common lines)",
            "Column numbering is unintuitive: -12 does not mean columns 1 and 2, it means suppress columns 1 and 2, showing only column 3",
        ],
        "related": ["diff", "join", "sort", "uniq"],
        "difficulty": "intermediate",
    },
    "split": {
        "description": "Split file into pieces",
        "man_url": "https://man7.org/linux/man-pages/man1/split.1.html",
        "flags": {
            "-l": "Lines per output file",
            "-b": "Bytes per output file",
            "-d": "Use numeric suffixes",
        
            "-n": "Split into N chunks (use l/N for line-aligned chunks)",
            "-a": "Set the length of the generated suffix (default 2)",
            "--filter": "Write to a shell command instead of files",
            "--additional-suffix": "Append an extra suffix to output filenames",
        },
        "common_patterns": ["split -l 1000 file.txt", "split -b 10M file.bin"],
    
        "use_cases": [
            "Break a large CSV file into manageable chunks with split -l 10000 data.csv chunk_ for parallel processing",
            "Split a large backup file into pieces that fit on removable media with split -b 4G backup.tar part_",
            "Create numbered output files with split -d -l 500 log.txt log_ for easier sorting",
        ],
        "gotchas": [
            "Output files are named xaa, xab, etc. by default -- use a PREFIX argument and -d for numeric suffixes to get readable names",
            "split does not add headers to subsequent chunks -- when splitting CSV files, the header row only appears in the first piece",
            "The -n flag splits into N equal-sized pieces but can split mid-line unless you use -n l/N for line-boundary splits",
        ],
        "related": ["csplit", "cat", "head", "tail"],
        "difficulty": "beginner",
    },
    "column": {
        "description": "Format output into columns",
        "man_url": "https://man7.org/linux/man-pages/man1/column.1.html",
        "flags": {
            "-t": "Create table",
            "-s": "Separator characters",
        
            "-o": "Set output separator string (util-linux 2.30+)",
            "-N": "Set comma-separated list of column names for headers",
            "-J": "Output as JSON with column names from -N",
            "-c": "Set output width in characters",
        },
        "common_patterns": ["column -t file.txt", "mount | column -t"],
    
        "use_cases": [
            "Format command output into a clean table with mount | column -t",
            "Display CSV data as an aligned table with column -t -s',' data.csv",
            "Create readable side-by-side output from tab-delimited data for reports",
        ],
        "gotchas": [
            "The -s flag sets the INPUT separator, not the output separator -- the output is always space-padded for alignment",
            "On older Linux systems (util-linux < 2.30), column -t does not support -s with multi-character separators -- only single character delimiters work",
            "The newer util-linux column supports -N for named headers and -J for JSON output, but these are not available on macOS or older systems",
        ],
        "related": ["paste", "pr", "printf", "awk"],
        "difficulty": "beginner",
    },

    # =========================================================================
    # FILE SYSTEM
    # =========================================================================
    "readlink": {
        "description": "Resolve the target of a symbolic link, revealing where it actually points - critical for debugging broken symlinks and understanding complex directory structures where paths may not be what they appear",
        "man_url": "https://man7.org/linux/man-pages/man1/readlink.1.html",
        "flags": {
            "-f": "Canonicalize by following every symlink in the path recursively",
            "-e": "Like -f but require all path components to exist",
            "-m": "Like -f but don't require path components to exist",
            "-n": "Don't output trailing newline",
        },
        "common_patterns": ["readlink -f /usr/bin/python", "readlink symlink_name", "readlink -f $(which python3)"],
    
        "use_cases": [
            "Find what a symlink points to: readlink /usr/bin/python3",
            "Resolve the full canonical path: readlink -f /usr/local/bin/node",
            "Get the real path of the current script: readlink -f \"$0\"",
            "Debug broken symlinks by seeing the stored target",
        ],
        "gotchas": [
            "readlink without -f only shows the direct target of a symlink -- it does not resolve chains of symlinks",
            "readlink -f is equivalent to realpath on most systems, but realpath is more portable in GNU/Linux",
            "readlink on a non-symlink file prints nothing and returns 1 (without -f, -e, or -m flags)",
            "readlink -f on macOS requires GNU coreutils (greadlink) -- the BSD readlink does not support -f",
        ],
        "related": ["realpath", "ln", "stat", "file"],
        "difficulty": "intermediate",
    },
    "rmdir": {
        "description": "Remove empty directories only, providing a safety net over 'rm -r' because it refuses to delete directories that still contain files - use it when you want to clean up directory structures without risking data loss",
        "man_url": "https://man7.org/linux/man-pages/man1/rmdir.1.html",
        "flags": {
            "-p": "Remove directory and its empty parent directories",
            "-v": "Verbose, print each directory removed",
            "--ignore-fail-on-non-empty": "Ignore errors from non-empty directories",
        },
        "common_patterns": ["rmdir empty_dir", "rmdir -p a/b/c", "rmdir -v temp/"],
    
        "use_cases": [
            "Safely remove an empty directory: rmdir temp/",
            "Remove a chain of empty parent directories: rmdir -p a/b/c removes c, then b, then a (if all empty)",
            "Clean up after a build: rmdir -v build/ obj/ (verbose output shows what was removed)",
            "Use in scripts as a safe alternative to rm -r when you only want to remove empty dirs",
        ],
        "gotchas": [
            "rmdir REFUSES to delete a directory that contains any files (including hidden files) -- this is a safety feature",
            "rmdir -p stops at the first non-empty parent; it does not error unless all directories fail",
            "rmdir does not have a -f (force) option -- if it cannot remove the dir, it always reports an error",
            "Hidden files (dotfiles) count as contents -- rmdir fails even if the directory appears empty in ls (without -a)",
        ],
        "related": ["rm", "mkdir", "find"],
        "difficulty": "beginner",
    },

    # =========================================================================
    # TEXT PROCESSING
    # =========================================================================
    "fmt": {
        "description": "Reformat paragraph text to a specified width, wrapping long lines intelligently at word boundaries - invaluable for cleaning up text files, formatting commit messages, or making documentation readable in terminals",
        "man_url": "https://man7.org/linux/man-pages/man1/fmt.1.html",
        "flags": {
            "-w": "Set maximum line width (default 75)",
            "-s": "Split long lines only, don't join short ones",
            "-u": "Uniform spacing (one space between words, two after sentences)",
        
            "-p": "Only reformat lines starting with this prefix string",
            "-t": "Indent like the first line, subsequent lines like the second",
        },
        "common_patterns": ["fmt -w 80 file.txt", "echo 'very long line...' | fmt -w 60", "fmt -s file.txt"],
    
        "use_cases": [
            "Reflow a paragraph to 72 columns for email formatting with fmt -w 72 message.txt",
            "Clean up ragged text from copy-paste with fmt -u file.txt for uniform spacing",
            "Wrap only long lines without joining short ones with fmt -s -w 80 code_comments.txt",
        ],
        "gotchas": [
            "fmt joins short lines into paragraphs by default -- use -s if you only want to split long lines without merging short ones",
            "Indented lines are treated as paragraph boundaries, so fmt preserves code indentation but may reflow comments unexpectedly",
            "The default width is 75, not 80 -- explicitly set -w 80 if you want standard terminal width",
        ],
        "related": ["fold", "pr", "par"],
        "difficulty": "beginner",
    },
    "fold": {
        "description": "Wrap lines at a specified width by breaking at exact character positions - unlike fmt which respects word boundaries, fold will split mid-word, making it suitable for fixed-width formatting of binary or structured data",
        "man_url": "https://man7.org/linux/man-pages/man1/fold.1.html",
        "flags": {
            "-w": "Set line width (default 80)",
            "-s": "Break at spaces rather than exact width",
            "-b": "Count bytes rather than columns",
        },
        "common_patterns": ["fold -w 80 file.txt", "fold -s -w 60 file.txt", "cat long_line.txt | fold -w 120"],
    
        "use_cases": [
            "Wrap long lines for terminal display with fold -s -w 80 readme.txt",
            "Prepare text for systems with fixed line-length limits like email with fold -w 76",
            "Break base64-encoded data into fixed-width lines with fold -w 76 encoded.txt",
        ],
        "gotchas": [
            "Without -s, fold breaks lines at the exact column count even mid-word -- always use -s for human-readable text to break at spaces",
            "fold counts display columns by default, not bytes -- use -b for byte counting which matters for multi-byte encodings",
            "Unlike fmt, fold does not join short lines or reflow paragraphs -- it only breaks long lines",
        ],
        "related": ["fmt", "pr", "column"],
        "difficulty": "beginner",
    },
    "expand": {
        "description": "Convert tabs to spaces in text, essential for normalizing indentation across files when different editors or contributors use inconsistent tab settings",
        "man_url": "https://man7.org/linux/man-pages/man1/expand.1.html",
        "flags": {
            "-t": "Set tab stops (default 8)",
            "-i": "Only convert leading tabs (preserve tabs in content)",
        },
        "common_patterns": ["expand file.txt", "expand -t 4 file.txt", "expand -i -t 2 file.txt"],
    
        "use_cases": [
            "Convert tabs to 4 spaces for consistent indentation with expand -t 4 file.c > file_spaces.c",
            "Normalize mixed tab/space files before diffing with expand -t 4 file.txt",
            "Convert only leading tabs (preserve alignment tabs) with expand -i -t 4 source.py",
        ],
        "gotchas": [
            "The default tab stop is 8, not 4 -- always specify -t with your project's indentation width",
            "expand processes all tabs by default including those inside strings -- use -i to limit conversion to leading whitespace only",
            "Pipe through expand before diff to avoid false differences caused by mixed tabs and spaces",
        ],
        "related": ["unexpand", "sed", "tr"],
        "difficulty": "beginner",
    },
    "unexpand": {
        "description": "Convert spaces back to tabs, the inverse of expand - useful for reducing file size or conforming to codebases that require tab indentation",
        "man_url": "https://man7.org/linux/man-pages/man1/unexpand.1.html",
        "flags": {
            "-t": "Set tab stops (default 8)",
            "-a": "Convert all sequences of spaces, not just leading ones",
            "--first-only": "Convert only leading sequences of spaces",
        },
        "common_patterns": ["unexpand -t 4 file.txt", "unexpand -a file.txt"],
    
        "use_cases": [
            "Convert spaces to tabs for Makefiles that require tab indentation with unexpand -t 4 --first-only file",
            "Reduce file size of heavily indented files by converting space runs to tabs",
            "Convert all space sequences (not just leading) with unexpand -a -t 4 file.txt",
        ],
        "gotchas": [
            "By default unexpand only converts leading spaces to tabs -- use -a to convert all sequences of spaces",
            "Makefiles REQUIRE literal tab characters for recipe lines -- unexpand can help fix spaces-only Makefiles",
            "The tab stop must match the original indentation width or the conversion will misalign content",
        ],
        "related": ["expand", "sed", "tr"],
        "difficulty": "beginner",
    },
    "csplit": {
        "description": "Split a file into pieces based on context (pattern matching), unlike split which divides by size or line count - perfect for breaking log files at date boundaries or splitting documents at chapter markers",
        "man_url": "https://man7.org/linux/man-pages/man1/csplit.1.html",
        "flags": {
            "-f": "Set output file prefix",
            "-n": "Set number of digits in output filenames",
            "-z": "Remove empty output files",
            "-k": "Keep output files even on error",
        
            "-b": "Use sprintf-style suffix format instead of default %02d",
            "--suppress-matched": "Suppress the lines matching the pattern in output",
        },
        "common_patterns": ["csplit file.txt '/^Chapter/' '{*}'", "csplit -f part_ log.txt '/^2024/' '{*}'"],
    
        "use_cases": [
            "Split a log file at each date header with csplit access.log '/^2024-/' '{*}'",
            "Split a document at chapter markers with csplit book.txt '/^Chapter/' '{*}'",
            "Extract the section between two patterns by splitting at both boundaries",
        ],
        "gotchas": [
            "Without -k, if a pattern is not found csplit removes ALL output files it already created -- use -k to keep partial results on error",
            "The '{*}' repeat specifier means repeat as many times as possible -- without it csplit only splits at the first match",
            "Output files are named xx00, xx01, etc. by default -- use -f to set a meaningful prefix and -n to control digit count",
        ],
        "related": ["split", "awk", "grep", "sed"],
        "difficulty": "intermediate",
    },
    "strings": {
        "description": "Extract printable text from binary files, revealing embedded messages, file paths, URLs, and configuration data hidden inside compiled executables or data files - a key tool for reverse engineering and forensic analysis",
        "man_url": "https://man7.org/linux/man-pages/man1/strings.1.html",
        "flags": {
            "-n": "Minimum string length (default 4)",
            "-a": "Scan entire file, not just loadable sections",
            "-t": "Print offset of each string (d=decimal, x=hex, o=octal)",
        
            "-e": "Select character encoding (s=7-bit, S=8-bit, b=16-bit big-endian, l=16-bit little-endian)",
        },
        "common_patterns": ["strings /usr/bin/ls", "strings -n 10 binary_file", "strings -t x firmware.bin"],
    
        "use_cases": [
            "Find embedded URLs or file paths in a compiled binary with strings binary | grep -i 'http'",
            "Identify the compiler and libraries used to build an executable with strings program | grep -i gcc",
            "Extract readable text from a corrupted document or firmware image for forensic analysis",
        ],
        "gotchas": [
            "strings only shows sequences of 4+ printable characters by default -- short strings like 2-character error codes are hidden unless you lower -n",
            "strings may show misleading output from random byte sequences that happen to look like text -- not every match is meaningful",
            "On ELF binaries, strings only scans loadable sections by default -- use -a to scan the entire file including debug sections",
        ],
        "related": ["od", "hexdump", "file", "readelf"],
        "difficulty": "beginner",
    },
    "od": {
        "description": "Dump file contents in octal and other formats, letting you inspect the raw bytes of any file - essential for debugging encoding issues, examining binary protocols, or understanding file formats at the byte level",
        "man_url": "https://man7.org/linux/man-pages/man1/od.1.html",
        "flags": {
            "-A": "Address radix: d (decimal), o (octal), x (hex), n (none)",
            "-t": "Output type: c (char), x (hex), d (decimal), o (octal)",
            "-c": "Print as named characters (shorthand for -t c)",
            "-x": "Print as hexadecimal (shorthand for -t x2)",
            "-N": "Limit dump to N bytes",
        
            "-j": "Skip this many bytes from the beginning of input",
            "-v": "Display all data without collapsing duplicate lines",
            "-w": "Set output width in bytes per line",
        },
        "common_patterns": ["od -c file.txt", "od -x binary_file", "od -A x -t x1z file.bin"],
    
        "use_cases": [
            "Debug encoding issues by viewing raw bytes with od -c file.txt to see newline types (\r\n vs \n)",
            "Inspect binary file headers to identify file format with od -A x -t x1z -N 32 mystery_file",
            "Examine network packet captures at the byte level for protocol debugging",
        ],
        "gotchas": [
            "od collapses repeated identical lines with an asterisk (*) by default -- this hides data in repetitive binary files",
            "The default output format is octal, which is rarely what you want -- use -t x1 for hex bytes or -c for character display",
            "od uses the system byte order for multi-byte formats -- -t x2 shows 2-byte hex in host endianness which may confuse cross-platform work",
        ],
        "related": ["hexdump", "xxd", "strings"],
        "difficulty": "intermediate",
    },
    "hexdump": {
        "description": "Display file contents in hexadecimal, decimal, octal, or ASCII - more flexible than od for custom output formatting, commonly used to inspect binary files, network packets, and data corruption",
        "man_url": "https://man7.org/linux/man-pages/man1/hexdump.1.html",
        "flags": {
            "-C": "Canonical hex+ASCII display (most common format)",
            "-n": "Interpret only N bytes of input",
            "-s": "Skip N bytes from beginning",
            "-v": "Display all input data (don't collapse duplicate lines)",
        
            "-e": "Specify custom format string for output",
        },
        "common_patterns": ["hexdump -C file.bin", "hexdump -C -n 256 file.bin", "hexdump -C file.bin | head"],
    
        "use_cases": [
            "View binary files with the canonical hex+ASCII display with hexdump -C file.bin",
            "Inspect the first 512 bytes of a disk for boot sector analysis with hexdump -C -n 512 /dev/sda",
            "Debug character encoding by checking actual byte values with echo -n 'text' | hexdump -C",
        ],
        "gotchas": [
            "Without -v, hexdump suppresses duplicate lines with asterisks -- use -v to see all data",
            "hexdump without -C shows little-endian 16-bit words which reverses byte pairs -- always use -C for byte-level inspection",
            "The -e flag for custom format strings uses a confusing printf-like syntax that differs from standard printf",
        ],
        "related": ["xxd", "od", "strings"],
        "difficulty": "intermediate",
    },
    "xxd": {
        "description": "Create or reverse hex dumps with the unique ability to convert hex back to binary - the only standard tool that can round-trip between binary and hex, making it invaluable for patching binary files",
        "man_url": "https://linux.die.net/man/1/xxd",
        "flags": {
            "-r": "Reverse: convert hex dump back to binary",
            "-p": "Plain hex dump (no line numbers or ASCII)",
            "-l": "Limit output to N bytes",
            "-s": "Start at offset",
            "-c": "Columns per line (default 16)",
            "-i": "Output as C include file style",
        },
        "common_patterns": ["xxd file.bin", "xxd -p file.bin", "xxd file.bin | vim - | xxd -r > patched.bin"],
    
        "use_cases": [
            "Create a hex dump for inclusion in C source with xxd -i data.bin > data.h",
            "Patch a binary file by editing hex then converting back with xxd file | edit | xxd -r > patched",
            "Get a plain hex string of a file with xxd -p file.bin for checksums or embedding",
        ],
        "gotchas": [
            "xxd -r requires the EXACT same format that xxd produces -- manually edited hex dumps must preserve the offset column format",
            "The -r flag reads hex dump from stdin, not a file argument -- pipe or redirect your edited dump",
            "xxd is bundled with vim, not coreutils -- it may not be available on minimal systems without vim installed",
        ],
        "related": ["hexdump", "od", "vim"],
        "difficulty": "intermediate",
    },

    # =========================================================================
    # PROCESS & SYSTEM
    # =========================================================================
    "btop": {
        "description": "A modern, feature-rich resource monitor with a polished TUI showing CPU, memory, disk, network, and process details - the next generation beyond htop for developers who want beautiful, information-dense system monitoring",
        "man_url": "https://github.com/aristocratos/btop",
        "flags": {
            "-lc": "Start in low-color mode for compatibility",
            "-t": "Start with tree view for processes",
            "--utf-force": "Force UTF-8 output",
        },
        "common_patterns": ["btop", "btop -t", "btop -lc"],
    
        "use_cases": [
            "Monitor system resources with a polished dashboard showing CPU, memory, disk, and network simultaneously",
            "Use process tree view to understand hierarchical process relationships",
            "Quick visual triage of system performance issues with color-coded resource graphs",
        ],
        "gotchas": [
            "btop requires a terminal with true color and UTF-8 support; use -lc flag on limited terminals",
            "btop is newer and less commonly available in default repos than htop; may need manual installation",
        ],
        "related": ["htop", "top", "atop"],
        "difficulty": "beginner",
    },
    "nice": {
        "description": "Run a command with a modified scheduling priority, letting you deprioritize CPU-hungry tasks so they don't interfere with interactive work - values range from -20 (highest priority) to 19 (lowest)",
        "man_url": "https://man7.org/linux/man-pages/man1/nice.1.html",
        "flags": {
            "-n": "Set niceness adjustment (default 10)",
        },
        "common_patterns": ["nice -n 19 make -j8", "nice -n 10 ./long_running_script.sh", "sudo nice -n -5 important_process"],
    
        "use_cases": [
            "Run a CPU-intensive build at low priority: nice -n 19 make -j8",
            "Start a backup job without impacting interactive users: nice -n 15 rsync -a /data /backup",
            "Run a high-priority system task (requires root): sudo nice -n -10 critical-task",
        ],
        "gotchas": [
            "Only root can set negative nice values (higher priority); regular users can only lower their priority",
            "Nice values range from -20 (highest priority) to 19 (lowest); the default adjustment is 10",
            "nice affects CPU scheduling priority only, not I/O priority -- use ionice for disk I/O scheduling",
        ],
        "related": ["renice", "ionice", "cpulimit"],
        "difficulty": "intermediate",
    },
    "renice": {
        "description": "Change the scheduling priority of an already running process without restarting it - use this when you realize a process is consuming too many resources and you need to lower its priority on the fly",
        "man_url": "https://man7.org/linux/man-pages/man1/renice.1.html",
        "flags": {
            "-n": "Set new priority value",
            "-p": "Interpret arguments as process IDs",
            "-u": "Interpret arguments as usernames",
            "-g": "Interpret arguments as process group IDs",
        },
        "common_patterns": ["renice -n 19 -p 1234", "renice -n 10 -u username", "sudo renice -n -5 -p 1234"],
    
        "use_cases": [
            "Lower the priority of a runaway process: renice -n 19 -p 1234",
            "Reprioritize all processes by a specific user: renice -n 10 -u batchuser",
            "Increase priority of a critical running process (root only): sudo renice -n -5 -p 5678",
        ],
        "gotchas": [
            "Regular users can only increase nice values (lower priority), never decrease them",
            "renice changes the priority of already-running processes; use nice to start new processes at a given priority",
        ],
        "related": ["nice", "kill", "top"],
        "difficulty": "intermediate",
    },
    "nohup": {
        "description": "Run a command immune to hangup signals so it survives after you log out of a terminal session - essential for starting long-running tasks on remote servers where your SSH connection may drop",
        "man_url": "https://man7.org/linux/man-pages/man1/nohup.1.html",
        "flags": {},
        "common_patterns": ["nohup ./long_script.sh &", "nohup python train_model.py > output.log 2>&1 &"],
    
        "use_cases": [
            "Start a long-running training job that survives SSH disconnection: nohup python train.py > train.log 2>&1 &",
            "Run a server process that persists after logout: nohup ./server &",
            "Launch a batch job on a remote machine before disconnecting: nohup ./process_data.sh &",
        ],
        "gotchas": [
            "nohup appends output to nohup.out by default, which can grow very large; always redirect stdout/stderr explicitly",
            "nohup only ignores SIGHUP; combining with & is required to actually background the process",
            "For interactive or complex scenarios, tmux/screen are better choices than nohup because you can reattach",
        ],
        "related": ["disown", "screen", "tmux", "bg"],
        "difficulty": "beginner",
    },
    "bg": {
        "description": "Resume a suspended (Ctrl+Z) job in the background, allowing you to continue using the terminal while the process runs - part of bash's built-in job control system",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Job-Control-Builtins.html",
        "flags": {},
        "common_patterns": ["bg", "bg %1", "bg %2"],
    
        "use_cases": [
            "Resume a suspended job in the background after pressing Ctrl+Z: bg %1",
            "Continue working in your terminal after accidentally starting a long command in the foreground",
        ],
        "gotchas": [
            "bg is a shell builtin and only works with jobs managed by the current shell session",
            "A backgrounded job that tries to read from the terminal will be stopped again with SIGTTIN",
            "bg without arguments resumes the most recently suspended job",
        ],
        "related": ["fg", "jobs", "disown", "nohup"],
        "difficulty": "beginner",
    },
    "fg": {
        "description": "Bring a background or suspended job back to the foreground, giving it control of the terminal again - use this to interact with a process you previously backgrounded",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Job-Control-Builtins.html",
        "flags": {},
        "common_patterns": ["fg", "fg %1", "fg %2"],
    
        "use_cases": [
            "Bring a background process back to the foreground to interact with it: fg %1",
            "Return to a suspended editor session after checking something in the shell",
        ],
        "gotchas": [
            "fg without arguments brings the most recently backgrounded/suspended job to the foreground",
            "If the job has already exited, fg will report an error",
        ],
        "related": ["bg", "jobs", "disown"],
        "difficulty": "beginner",
    },
    "jobs": {
        "description": "List all jobs running or stopped in the current shell session, showing their status and job numbers - the foundation for bash job control that lets you manage multiple concurrent tasks in one terminal",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Job-Control-Builtins.html",
        "flags": {
            "-l": "List process IDs in addition to normal info",
            "-p": "List only process IDs",
            "-r": "List only running jobs",
            "-s": "List only stopped jobs",
        },
        "common_patterns": ["jobs", "jobs -l", "jobs -r"],
    
        "use_cases": [
            "List all background and suspended jobs in the current shell: jobs -l",
            "Check if background processes are still running before logging out",
            "Get the PID of a backgrounded job for use with kill: jobs -p",
        ],
        "gotchas": [
            "jobs only shows processes started from the current shell session; it cannot see processes from other terminals",
            "Job numbers (%1, %2) are different from PIDs and are local to the shell session",
        ],
        "related": ["bg", "fg", "disown", "ps"],
        "difficulty": "beginner",
    },
    "disown": {
        "description": "Remove a job from the shell's job table so it won't receive SIGHUP when the shell exits - use this when you forgot to start a process with nohup and need to detach it retroactively",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Job-Control-Builtins.html",
        "flags": {
            "-h": "Mark job so SIGHUP is not sent but keep in job table",
            "-a": "Remove all jobs",
            "-r": "Remove only running jobs",
        },
        "common_patterns": ["disown", "disown %1", "disown -h %1"],
    
        "use_cases": [
            "Detach a running background job from the shell so it survives logout: disown %1",
            "Retroactively make a process immune to SIGHUP when you forgot to use nohup",
            "Remove all jobs from the shell's job table before logging out: disown -a",
        ],
        "gotchas": [
            "After disown, you can no longer use fg/bg/jobs to manage the process -- you must use kill with the PID directly",
            "disown only removes the job from the shell's table; it does not redirect output, so the process may still fail if it writes to the closed terminal",
            "disown -h keeps the job in the table but prevents SIGHUP, which is a safer option if you still want to track it",
        ],
        "related": ["nohup", "bg", "fg", "jobs", "screen", "tmux"],
        "difficulty": "intermediate",
    },
    "screen": {
        "description": "Create persistent terminal sessions that survive disconnection, allowing you to detach and reattach to long-running processes from any terminal - a classic tool for remote server administration",
        "man_url": "https://www.gnu.org/software/screen/manual/screen.html",
        "flags": {
            "-S": "Name the session for easy identification",
            "-r": "Reattach to a detached session",
            "-ls": "List all screen sessions",
            "-d": "Detach a running session remotely",
            "-x": "Attach to an already attached session (sharing)",
        
            "-dm": "Start session in detached mode (useful in scripts)",
            "-X": "Send a command to a running session (e.g., screen -S name -X stuff 'command\n')",
        },
        "common_patterns": ["screen -S mywork", "screen -ls", "screen -r mywork", "screen -d -r mywork"],
    
        "use_cases": [
            "Keep a long-running process alive after SSH disconnection: screen -S build, run command, then Ctrl-a d to detach",
            "Reattach to a running session after reconnecting: screen -r build",
            "Share a terminal session with another user for pair debugging: screen -x",
        ],
        "gotchas": [
            "screen uses Ctrl-a as its prefix key, which conflicts with the bash shortcut to go to the beginning of the line",
            "Dead sessions (marked as 'dead') must be wiped with screen -wipe before the name can be reused",
            "screen is being superseded by tmux, which has a more scriptable interface and better pane management",
        ],
        "related": ["tmux", "byobu", "nohup", "disown"],
        "difficulty": "intermediate",
    },
    "tmux": {
        "description": "A modern terminal multiplexer that lets you create, manage, and switch between multiple terminal sessions within a single window - superior to screen with split panes, scriptable layouts, and extensive customization",
        "man_url": "https://man.openbsd.org/tmux",
        "flags": {
            "new": "Create new session",
            "-s": "Name the session",
            "attach": "Attach to existing session",
            "-t": "Target session name",
            "ls": "List sessions",
            "kill-session": "Destroy a session",
        
            "new-window": "Create a new window in the current session",
            "split-window": "Split the current pane horizontally or vertically",
            "send-keys": "Send keystrokes to a pane (useful for scripting)",
            "resize-pane": "Resize a pane by a specified number of cells",
            "source-file": "Load tmux configuration from a file",
        },
        "common_patterns": ["tmux new -s work", "tmux attach -t work", "tmux ls", "tmux kill-session -t work"],
    
        "use_cases": [
            "Keep long-running processes alive after SSH disconnection: tmux new -s work",
            "Split terminal into multiple panes for monitoring: Ctrl-b % (vertical) and Ctrl-b \" (horizontal)",
            "Share a terminal session with a colleague: tmux new -s pair, then they run tmux attach -t pair",
            "Script complex window layouts for development environments: tmux new-session -d, then send-keys commands",
            "Run multiple parallel tasks visible in one terminal: create panes for logs, servers, and a shell",
        ],
        "gotchas": [
            "tmux uses Ctrl-b as prefix by default (screen uses Ctrl-a) -- muscle memory conflicts are common when switching",
            "The tmux scrollback buffer requires entering copy mode (Ctrl-b [) to scroll; mouse wheel alone does not work without mouse mode enabled",
            "Nested tmux sessions (tmux inside tmux) require pressing the prefix twice to reach the inner session",
            "tmux uses a client-server model; killing the server (tmux kill-server) destroys all sessions",
        ],
        "related": ["screen", "byobu", "nohup", "disown"],
        "difficulty": "intermediate",
    },
    "systemctl": {
        "description": "Control the systemd service manager that orchestrates all system services, daemons, and startup processes on modern Linux - the single most important command for managing what runs on a Linux server",
        "man_url": "https://man7.org/linux/man-pages/man1/systemctl.1.html",
        "flags": {
            "start": "Start a service",
            "stop": "Stop a service",
            "restart": "Restart a service",
            "status": "Show service status and recent logs",
            "enable": "Enable service to start at boot",
            "disable": "Disable service from starting at boot",
            "list-units": "List loaded units",
            "daemon-reload": "Reload systemd configuration",
        
            "reload": "Reload service configuration without full restart",
            "mask": "Completely prevent a service from being started",
            "unmask": "Remove the mask from a service",
            "is-active": "Check if a service is running (useful in scripts)",
            "is-enabled": "Check if a service is enabled at boot",
            "show": "Show properties of a unit for debugging",
            "--failed": "List only failed units",
            "edit": "Edit or create a unit file override",
        },
        "common_patterns": [
            "systemctl status nginx",
            "systemctl start nginx",
            "systemctl enable --now nginx",
            "systemctl restart postgresql",
            "systemctl list-units --type=service",
        ],
    
        "use_cases": [
            "Start and enable a service in one command: systemctl enable --now nginx",
            "Check why a service failed: systemctl status nginx (shows recent logs inline)",
            "List all running services: systemctl list-units --type=service --state=running",
            "Reload service configuration without restarting: systemctl reload nginx",
            "Mask a service to prevent it from starting even manually: systemctl mask dangerous-service",
        ],
        "gotchas": [
            "enable does not start the service; it only configures it to start at boot. Use enable --now to do both",
            "daemon-reload is required after editing a .service unit file before restarting the service",
            "systemctl without arguments lists all loaded units, which can be overwhelming; use --type and --state filters",
            "A masked service cannot be started until unmasked; this is stronger than disable",
        ],
        "related": ["journalctl", "service", "init"],
        "difficulty": "intermediate",
    },
    "journalctl": {
        "description": "Query and display logs from the systemd journal, which captures output from all services, the kernel, and system messages - the central log viewer for diagnosing problems on modern Linux systems",
        "man_url": "https://man7.org/linux/man-pages/man1/journalctl.1.html",
        "flags": {
            "-u": "Show logs for a specific unit/service",
            "-f": "Follow new log entries in real time (like tail -f)",
            "-b": "Show logs from current or specific boot",
            "-n": "Show last N lines",
            "--since": "Show entries since date/time",
            "-p": "Filter by priority (emerg, alert, crit, err, warning, notice, info, debug)",
            "-x": "Add explanatory help text to log messages",
            "--no-pager": "Output directly without paging",
        
            "-o": "Set output format (short, verbose, json, cat)",
            "--disk-usage": "Show how much disk space the journal uses",
            "--vacuum-size": "Reduce journal disk usage to specified size",
            "--vacuum-time": "Remove entries older than specified time",
            "-k": "Show only kernel messages (like dmesg)",
            "-r": "Show newest entries first (reverse chronological)",
        },
        "common_patterns": [
            "journalctl -u nginx",
            "journalctl -u nginx -f",
            "journalctl -b -p err",
            "journalctl --since '1 hour ago'",
        ],
    
        "use_cases": [
            "Follow logs for a specific service in real time: journalctl -u nginx -f",
            "View logs since the last boot: journalctl -b",
            "Find errors from the past hour: journalctl --since '1 hour ago' -p err",
            "Show the last 50 lines of a service log: journalctl -u postgresql -n 50",
            "Export logs in JSON for analysis: journalctl -u myapp -o json --since today",
        ],
        "gotchas": [
            "The journal can consume significant disk space; configure SystemMaxUse in journald.conf to limit it",
            "Without -u, journalctl shows logs from all units, which is noisy; always filter",
            "Timestamps use the system timezone by default; use --utc for UTC output",
            "Regular users may not see all logs; add yourself to the 'systemd-journal' group or use sudo",
        ],
        "related": ["systemctl", "dmesg", "syslog"],
        "difficulty": "intermediate",
    },
    "dmesg": {
        "description": "Print kernel ring buffer messages that reveal hardware detection, driver loading, and system-level events - the first place to look when diagnosing hardware issues, USB device problems, or kernel errors",
        "man_url": "https://man7.org/linux/man-pages/man1/dmesg.1.html",
        "flags": {
            "-T": "Show human-readable timestamps",
            "-H": "Human-readable output with colors",
            "-w": "Follow new messages (like tail -f)",
            "-l": "Filter by log level (err, warn, info)",
            "--color": "Enable colored output",
        
            "--level": "Filter by log level: --level=err,warn",
        },
        "common_patterns": ["dmesg | tail", "dmesg -T | grep -i error", "dmesg -T -w", "sudo dmesg -H"],
    
        "use_cases": [
            "Check for hardware issues after plugging in a USB device: dmesg -T | tail -20",
            "Diagnose boot problems by reviewing kernel messages: dmesg | less",
            "Watch for new kernel messages in real time: dmesg -T -w",
            "Filter for error-level messages only: dmesg -l err,crit,alert,emerg",
        ],
        "gotchas": [
            "dmesg timestamps are relative to boot by default; use -T for human-readable wall-clock times (note: -T can be inaccurate after suspend/resume)",
            "On newer systems, dmesg may require root or membership in specific groups to read kernel messages",
            "The kernel ring buffer has a fixed size; old messages are overwritten by new ones on busy systems",
        ],
        "related": ["journalctl", "syslog"],
        "difficulty": "intermediate",
    },
    "uptime": {
        "description": "Show how long the system has been running, current time, number of users, and load averages - a quick health check that reveals whether the system recently rebooted and if it's under heavy load",
        "man_url": "https://man7.org/linux/man-pages/man1/uptime.1.html",
        "flags": {
            "-p": "Show uptime in pretty (human-readable) format",
            "-s": "Show system up since (date and time of last boot)",
        },
        "common_patterns": ["uptime", "uptime -p"],
    
        "use_cases": [
            "Quick system health check: uptime shows load averages, user count, and time since last boot",
            "Check load averages to determine if a system is overloaded (compare to CPU count)",
        ],
        "gotchas": [
            "Load average numbers greater than your CPU count indicate the system is overloaded with waiting processes",
            "On Linux, load averages include processes waiting for I/O (D state), not just CPU -- so high load does not always mean high CPU usage",
        ],
        "related": ["w", "top", "free"],
        "difficulty": "beginner",
    },
    "free": {
        "description": "Display the amount of free and used physical memory and swap space - essential for diagnosing out-of-memory conditions and understanding how much RAM your applications are actually consuming",
        "man_url": "https://man7.org/linux/man-pages/man1/free.1.html",
        "flags": {
            "-h": "Human-readable sizes (MB, GB)",
            "-m": "Display in megabytes",
            "-g": "Display in gigabytes",
            "-s": "Repeat every N seconds",
            "-t": "Show total line",
        
            "-w": "Wide output (separate buffers and cache columns)",
            "-l": "Show detailed low and high memory statistics",
            "--si": "Use powers of 1000 instead of 1024",
        },
        "common_patterns": ["free -h", "free -m", "free -h -s 5"],
    
        "use_cases": [
            "Check available memory: free -h (the 'available' column is what matters)",
            "Monitor memory usage over time: free -h -s 5 (refresh every 5 seconds)",
            "Quickly check swap usage to detect memory pressure",
        ],
        "gotchas": [
            "The 'used' column includes buffer/cache which Linux reclaims on demand -- look at 'available' for actual free memory",
            "High swap usage combined with constant swap activity (check with vmstat) indicates real memory pressure",
            "free shows a snapshot; for historical data use sar -r",
        ],
        "related": ["vmstat", "top", "sar"],
        "difficulty": "beginner",
    },
    "vmstat": {
        "description": "Report virtual memory, CPU, and I/O statistics in a compact tabular format - a single-line-per-interval overview that helps identify whether a performance bottleneck is CPU, memory, or I/O bound",
        "man_url": "https://man7.org/linux/man-pages/man8/vmstat.8.html",
        "flags": {
            "-s": "Display event counters and memory statistics",
            "-w": "Wide output format",
            "-t": "Add timestamp to output",
        },
        "common_patterns": ["vmstat 1", "vmstat 1 10", "vmstat -w 1"],
    
        "use_cases": [
            "Quick overview of system performance: vmstat 1 (updates every second)",
            "Check if system is CPU-bound (high us/sy), I/O-bound (high wa), or memory-bound (high si/so swap activity)",
            "Monitor context switches and interrupts: vmstat 1 and watch the cs and in columns",
        ],
        "gotchas": [
            "The first line of vmstat output shows averages since boot, not the current state; ignore it and look at subsequent lines",
            "The si/so columns show swap in/out; consistently non-zero values indicate memory pressure",
            "vmstat's compact format takes practice to read; w flag provides wider, easier-to-read output",
        ],
        "related": ["free", "iostat", "mpstat", "sar"],
        "difficulty": "intermediate",
    },
    "lsof": {
        "description": "List open files and the processes that opened them - since everything in Unix is a file (including network sockets and pipes), this is the Swiss Army knife for finding what process is using a port, holding a file lock, or consuming file descriptors",
        "man_url": "https://man7.org/linux/man-pages/man8/lsof.8.html",
        "flags": {
            "-i": "List network connections (optionally filter by port)",
            "-p": "List files opened by specific PID",
            "-u": "List files opened by specific user",
            "-c": "List files opened by command name",
            "+D": "Search directory recursively for open files",
            "-t": "Terse output (PIDs only, useful for scripting)",
        
            "-a": "AND selection criteria together (default is OR)",
            "-n": "Do not resolve IP addresses to hostnames",
            "-P": "Do not resolve port numbers to service names",
            "-r": "Repeat the listing every N seconds",
            "-F": "Produce output suitable for parsing by other programs",
        },
        "common_patterns": [
            "lsof -i :8080",
            "lsof -i -P -n",
            "lsof -p 1234",
            "lsof +D /var/log",
            "lsof -u username",
        ],
    
        "use_cases": [
            "Find which process is using port 8080: lsof -i :8080",
            "List all network connections with process info: lsof -i -P -n",
            "Find all open files in a directory (why can't I unmount?): lsof +D /mnt/usb",
            "Get the PID of the process holding a file for scripting: lsof -t /path/to/file",
            "Find all files opened by a specific user: lsof -u www-data",
        ],
        "gotchas": [
            "lsof can be slow on systems with many open files; use specific filters (-i, -p, -u) rather than listing everything",
            "The -P flag prevents port number-to-name conversion, and -n prevents IP-to-hostname conversion; both speed up output significantly",
            "lsof requires root to see files opened by other users' processes",
            "Multiple selection flags are ORed by default; use -a to AND them together",
        ],
        "related": ["fuser", "ss", "netstat", "ps"],
        "difficulty": "intermediate",
    },
    "strace": {
        "description": "Trace system calls and signals made by a process, revealing exactly how a program interacts with the kernel - the ultimate debugging tool when a program fails mysteriously and you need to see what files it tries to open, what network calls it makes, or where it crashes",
        "man_url": "https://man7.org/linux/man-pages/man1/strace.1.html",
        "flags": {
            "-p": "Attach to existing process by PID",
            "-f": "Follow child processes (forks)",
            "-e": "Filter by system call type (trace=open,read,write)",
            "-o": "Write output to file",
            "-c": "Count time and calls (summary mode)",
            "-t": "Prefix each line with time of day",
            "-s": "Maximum string size to print (default 32)",
        
            "-T": "Show time spent in each syscall",
        },
        "common_patterns": [
            "strace ls /tmp",
            "strace -p 1234",
            "strace -e trace=open,read,write command",
            "strace -f -o trace.log ./program",
            "strace -c ./program",
        ],
    
        "use_cases": [
            "Trace system calls of a process: strace -f ./program",
            "Debug why a program fails to open a file: strace -e trace=openat ./prog",
            "Measure syscall timing: strace -T -c ./program",
            "Attach to a running process: strace -p PID",
        ],
        "gotchas": [
            "strace significantly slows down the traced process -- do not use on production without caution",
            "Output is very verbose by default -- use -e to filter specific syscall categories",
            "strace requires ptrace permissions -- seccomp or Yama may block it on hardened systems",
        ],
        "related": ["ltrace", "perf", "gdb", "dmesg"],
        "difficulty": "advanced",
    },
    "timeout": {
        "description": "Run a command with a time limit, automatically killing it if it exceeds the duration - essential for scripts that must not hang indefinitely, CI/CD pipelines, and automated testing",
        "man_url": "https://man7.org/linux/man-pages/man1/timeout.1.html",
        "flags": {
            "-s": "Send specified signal instead of SIGTERM",
            "-k": "Send SIGKILL after additional duration if still running",
            "--foreground": "Allow command to read from TTY",
        },
        "common_patterns": ["timeout 30 curl https://example.com", "timeout -k 5 60 ./long_test.sh", "timeout 10s ping google.com"],
    
        "use_cases": [
            "Prevent a curl request from hanging indefinitely: timeout 30 curl https://slow-api.example.com",
            "Set a hard limit on test execution in CI: timeout -k 10 300 pytest tests/",
            "Kill a process that should complete within a time window: timeout 60 ./batch-job.sh",
        ],
        "gotchas": [
            "timeout sends SIGTERM by default; the process can ignore it. Use -k to send SIGKILL after an additional grace period",
            "Exit code 124 means the command timed out; other exit codes come from the command itself",
            "The duration format supports s (seconds), m (minutes), h (hours), d (days); default is seconds",
        ],
        "related": ["kill", "time", "watch"],
        "difficulty": "beginner",
    },
    "crontab": {
        "description": "Schedule commands to run automatically at specified times using cron expressions - the standard Unix task scheduler for recurring jobs like backups, log rotation, and periodic data processing",
        "man_url": "https://man7.org/linux/man-pages/man1/crontab.1.html",
        "flags": {
            "-e": "Edit your crontab file",
            "-l": "List current crontab entries",
            "-r": "Remove your crontab entirely",
            "-u": "Operate on specified user's crontab (root only)",
        },
        "common_patterns": ["crontab -l", "crontab -e", "crontab -r"],
    
        "use_cases": [
            "Edit your cron jobs: crontab -e",
            "List current cron jobs: crontab -l",
            "Install crontab from a file: crontab mycron.txt",
        ],
        "gotchas": [
            "crontab -r removes ALL your cron jobs without confirmation -- use crontab -l > backup first",
            "Cron uses its own minimal PATH -- always use absolute paths for commands in crontab entries",
            "The environment in cron is not your login shell -- source profiles or set variables explicitly",
        ],
        "related": ["cron", "at", "systemctl", "anacron"],
        "difficulty": "intermediate",
    },
    "uname": {
        "description": "Print system information including kernel name, version, architecture, and hostname - the standard way to detect what OS and hardware platform a script is running on for cross-platform compatibility",
        "man_url": "https://man7.org/linux/man-pages/man1/uname.1.html",
        "flags": {
            "-a": "Print all system information",
            "-r": "Print kernel release version",
            "-m": "Print machine hardware architecture",
            "-s": "Print kernel name",
            "-n": "Print network hostname",
        
            "-o": "Print the operating system name",
            "-p": "Print the processor type (or 'unknown')",
        },
        "common_patterns": ["uname -a", "uname -r", "uname -m"],
    
        "use_cases": [
            "Print all system information: uname -a",
            "Detect CPU architecture for cross-platform scripts: uname -m",
            "Check kernel version: uname -r",
        ],
        "gotchas": [
            "uname shows the kernel information, not the distribution name; use /etc/os-release or lsb_release for distro info",
            "Inside Docker containers, uname shows the host kernel version, not the container's base image version",
        ],
        "related": ["hostname", "hostnamectl", "lsb_release"],
        "difficulty": "beginner",
    },
    "hostname": {
        "description": "Display or set the system's network hostname, which identifies the machine on the network - commonly used in scripts to customize behavior per server or include the hostname in log messages",
        "man_url": "https://man7.org/linux/man-pages/man1/hostname.1.html",
        "flags": {
            "-f": "Display fully qualified domain name (FQDN)",
            "-i": "Display IP address(es) of the host",
            "-I": "Display all IP addresses of the host",
            "-s": "Display short hostname",
        },
        "common_patterns": ["hostname", "hostname -f", "hostname -I"],
    
        "use_cases": [
            "Display the system hostname: hostname",
            "Get all IP addresses of the machine: hostname -I",
            "Get the FQDN: hostname -f",
        ],
        "gotchas": [
            "Setting hostname with the hostname command is temporary; use hostnamectl for persistent changes on systemd systems",
            "hostname -I may show multiple IPs if the machine has multiple interfaces or addresses",
        ],
        "related": ["hostnamectl", "uname"],
        "difficulty": "beginner",
    },

    # =========================================================================
    # NETWORKING
    # =========================================================================
    "sftp": {
        "description": "Securely transfer files over SSH with an interactive FTP-like interface - provides the familiar commands of FTP but with full SSH encryption, making it the safe choice for ad-hoc file transfers to remote servers",
        "man_url": "https://man.openbsd.org/sftp",
        "flags": {
            "-P": "Port to connect to",
            "-i": "Identity file (private key)",
            "-b": "Batch file with commands to execute",
            "-r": "Recursively copy directories",
        
            "-C": "Enable compression",
            "-l": "Limit bandwidth in Kbit/s",
            "-o": "Pass SSH options",
        },
        "common_patterns": ["sftp user@host", "sftp -P 2222 user@host", "sftp -b batch.txt user@host"],
    
        "use_cases": [
            "Interactive file transfer session with a remote server: sftp user@host",
            "Batch transfer files from a script: sftp -b commands.txt user@host",
            "Resume interrupted directory uploads with a combination of get -r / put -r",
            "Browse remote files interactively when you are unsure of the exact path",
        ],
        "gotchas": [
            "sftp is not FTP over SSL; it is a completely different protocol that runs over SSH",
            "The -P flag (uppercase) sets the port, matching scp but different from ssh's lowercase -p",
            "Tab completion works in interactive mode but may be slow on high-latency connections",
        ],
        "related": ["scp", "rsync", "ssh", "ftp"],
        "difficulty": "beginner",
    },
    "nc": {
        "description": "The 'Swiss Army knife' of networking (netcat) - read and write data across network connections using TCP or UDP, useful for port scanning, file transfers, chat servers, and debugging network services at the lowest level",
        "man_url": "https://man7.org/linux/man-pages/man1/ncat.1.html",
        "flags": {
            "-l": "Listen mode (act as server)",
            "-p": "Specify local port",
            "-v": "Verbose output",
            "-z": "Zero-I/O mode (port scanning)",
            "-u": "Use UDP instead of TCP",
            "-w": "Timeout for connections",
        
            "-k": "Keep listening after client disconnects (accept multiple connections)",
            "-e": "Execute a program after connection (not available in all versions)",
            "-N": "Shutdown the network socket after EOF on stdin",
        },
        "common_patterns": ["nc -zv host 80", "nc -l -p 8080", "echo 'test' | nc host 80", "nc -zv host 1-1000"],
    
        "use_cases": [
            "Test if a remote port is open with nc -zv host 443 before deploying",
            "Transfer a file between machines: receiver runs nc -l -p 9999 > file.txt, sender runs nc host 9999 < file.txt",
            "Create a quick ad-hoc chat between two terminals for debugging coordination",
            "Pipe data into a network service for scripted testing: echo 'GET / HTTP/1.0\r\n\r\n' | nc host 80",
        ],
        "gotchas": [
            "There are multiple incompatible netcat implementations (GNU, OpenBSD, ncat) with different flag syntax -- the -p flag behavior and -e support vary between them",
            "The -e flag to execute a program on connection is disabled in many distributions for security reasons; use ncat --exec instead",
            "OpenBSD netcat does not support the -p flag with -l; the port goes directly after -l",
        ],
        "related": ["ncat", "socat", "telnet", "curl"],
        "difficulty": "intermediate",
    },
    "traceroute": {
        "description": "Trace the route packets take to reach a network host, showing every router hop along the way - essential for diagnosing where network connections fail or slow down between your machine and a destination",
        "man_url": "https://man7.org/linux/man-pages/man1/traceroute.1.html",
        "flags": {
            "-n": "Don't resolve hostnames (faster)",
            "-m": "Set max TTL (max number of hops)",
            "-w": "Set timeout for each probe",
            "-I": "Use ICMP ECHO instead of UDP",
        
            "-T": "Use TCP SYN probes instead of UDP (useful when UDP is firewalled)",
            "-p": "Set the destination port for UDP probes",
            "-q": "Set the number of probe packets per hop (default 3)",
        },
        "common_patterns": ["traceroute google.com", "traceroute -n google.com", "traceroute -I google.com"],
    
        "use_cases": [
            "Diagnose where a network path fails when you cannot reach a remote server",
            "Identify which ISP or network segment is causing high latency",
            "Verify that traffic is taking the expected route through your network infrastructure",
        ],
        "gotchas": [
            "Many routers and firewalls block or rate-limit traceroute probes, showing * * * for those hops -- this does not always mean the hop is down",
            "Default UDP-based traceroute may be blocked where ICMP (-I) is allowed, or vice versa; try both methods",
            "traceroute requires root privileges for ICMP mode (-I); use tracepath as a non-root alternative",
        ],
        "related": ["tracepath", "mtr", "ping", "ip"],
        "difficulty": "intermediate",
    },
    "dig": {
        "description": "Query DNS servers for domain name records with detailed output including query time, server used, and record TTLs - the go-to tool for DNS troubleshooting and verifying domain configuration changes",
        "man_url": "https://linux.die.net/man/1/dig",
        "flags": {
            "+short": "Show only the answer, not full output",
            "+trace": "Trace delegation path from root servers",
            "-t": "Specify record type (A, AAAA, MX, CNAME, NS, TXT, etc.)",
            "@": "Query a specific DNS server",
        
            "+noall +answer": "Show only the answer section for clean output",
            "+dnssec": "Request DNSSEC records",
            "+tcp": "Use TCP instead of UDP for the query",
            "-x": "Perform a reverse DNS lookup on an IP address",
        },
        "common_patterns": [
            "dig example.com",
            "dig example.com +short",
            "dig -t MX example.com",
            "dig @8.8.8.8 example.com",
            "dig example.com +trace",
        ],
    
        "use_cases": [
            "Verify DNS propagation after changing A records: dig @8.8.8.8 example.com A +short",
            "Debug email delivery by checking MX records: dig -t MX example.com",
            "Trace the full DNS delegation chain to find where resolution breaks: dig example.com +trace",
            "Check DNSSEC validation: dig example.com +dnssec",
            "Look up TXT records for SPF/DKIM verification: dig -t TXT example.com",
        ],
        "gotchas": [
            "dig queries your system's default DNS resolver unless you specify one with @server -- results may differ from what the public sees",
            "The +short flag strips all context; when debugging, use the full output to check TTL, authority section, and response flags",
            "dig is part of the bind-utils or dnsutils package and may not be installed on minimal systems; use host as a simpler fallback",
        ],
        "related": ["nslookup", "host", "whois"],
        "difficulty": "intermediate",
    },
    "nslookup": {
        "description": "Query DNS name servers interactively or non-interactively - simpler than dig for quick hostname-to-IP lookups, though dig is preferred for detailed DNS debugging",
        "man_url": "https://linux.die.net/man/1/nslookup",
        "flags": {
            "-type": "Specify query type (A, MX, NS, CNAME, etc.)",
        },
        "common_patterns": ["nslookup example.com", "nslookup -type=MX example.com", "nslookup example.com 8.8.8.8"],
    
        "use_cases": [
            "Quick hostname-to-IP resolution check: nslookup example.com",
            "Query a specific DNS server to test if it has updated records: nslookup example.com 8.8.8.8",
            "Look up MX records for email troubleshooting: nslookup -type=MX example.com",
        ],
        "gotchas": [
            "nslookup is considered deprecated by the ISC (BIND authors) in favor of dig; it may give misleading results in some edge cases",
            "nslookup bypasses the system resolver's /etc/hosts file, so local hostname overrides will not appear",
            "Interactive mode can be confusing -- type 'exit' to quit, not Ctrl-C which just cancels the current query",
        ],
        "related": ["dig", "host", "whois"],
        "difficulty": "beginner",
    },
    "ip": {
        "description": "The modern replacement for ifconfig, route, and arp - a unified tool for showing and manipulating network interfaces, routing tables, tunnels, and addresses on Linux systems",
        "man_url": "https://man7.org/linux/man-pages/man8/ip.8.html",
        "flags": {
            "addr": "Show/manipulate IP addresses",
            "link": "Show/manipulate network devices",
            "route": "Show/manipulate routing table",
            "neigh": "Show/manipulate ARP/neighbor cache",
            "-br": "Brief output format",
            "-c": "Colorize output",
        
            "-s": "Show statistics (packet counts, errors)",
            "-j": "Output in JSON format for scripting",
            "-4": "Show only IPv4",
            "-6": "Show only IPv6",
        },
        "common_patterns": [
            "ip addr show",
            "ip -br addr",
            "ip route show",
            "ip link show",
            "ip -c addr",
        ],
    
        "use_cases": [
            "View all IP addresses assigned to interfaces: ip -br addr (brief, readable format)",
            "Add a static route: ip route add 10.0.0.0/8 via 192.168.1.1",
            "Bring a network interface up or down: ip link set eth0 up/down",
            "View the ARP neighbor cache: ip neigh show",
            "Add a secondary IP address to an interface: ip addr add 192.168.1.100/24 dev eth0",
        ],
        "gotchas": [
            "Changes made with ip are not persistent across reboots -- use netplan, NetworkManager, or /etc/network/interfaces for permanent config",
            "ip replaces ifconfig, route, and arp but uses different syntax for everything; old muscle memory does not transfer",
            "The ip command requires the iproute2 package, which is standard on modern distros but may be missing on very minimal containers",
        ],
        "related": ["ifconfig", "route", "arp", "ss", "netstat"],
        "difficulty": "intermediate",
    },
    "iptables": {
        "description": "Configure the Linux kernel packet filter firewall rules, controlling which network traffic is allowed in, out, or forwarded - the fundamental building block of Linux network security and NAT",
        "man_url": "https://man7.org/linux/man-pages/man8/iptables.8.html",
        "flags": {
            "-L": "List all rules in a chain",
            "-A": "Append rule to chain",
            "-D": "Delete rule from chain",
            "-I": "Insert rule at position",
            "-F": "Flush (delete) all rules in chain",
            "-P": "Set default policy for chain",
            "-n": "Numeric output (don't resolve names)",
            "-v": "Verbose output",
            "--line-numbers": "Show rule numbers",
        
            "-t": "Specify table (filter, nat, mangle, raw, security)",
            "-s": "Source IP address or range",
            "-d": "Destination IP address or range",
            "-j": "Target action (ACCEPT, DROP, REJECT, LOG)",
            "-p": "Protocol (tcp, udp, icmp)",
            "--dport": "Destination port (requires -p tcp or -p udp)",
            "--sport": "Source port (requires -p tcp or -p udp)",
            "-i": "Input network interface",
            "-o": "Output network interface",
        },
        "common_patterns": [
            "sudo iptables -L -n -v",
            "sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT",
            "sudo iptables -L --line-numbers",
        ],
    
        "use_cases": [
            "Block an abusive IP: iptables -A INPUT -s 1.2.3.4 -j DROP",
            "Allow inbound HTTP/HTTPS: iptables -A INPUT -p tcp --dport 80 -j ACCEPT",
            "Set up port forwarding (NAT): iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080",
            "Log dropped packets for debugging: iptables -A INPUT -j LOG --log-prefix 'DROPPED: '",
            "Save rules to survive reboot: iptables-save > /etc/iptables/rules.v4",
        ],
        "gotchas": [
            "Rules are evaluated in order and first match wins -- a broad ACCEPT at the top can override specific DROP rules below it",
            "iptables rules are lost on reboot unless saved with iptables-save and restored with iptables-restore or a service like netfilter-persistent",
            "Flushing rules with -F on a remote server with default DROP policy will lock you out -- always set -P INPUT ACCEPT before flushing",
            "iptables is being replaced by nftables on newer distributions; new deployments should prefer nft",
        ],
        "related": ["nft", "ufw", "firewall-cmd", "ip"],
        "difficulty": "advanced",
    },
    "ufw": {
        "description": "Uncomplicated Firewall - a user-friendly frontend for iptables that makes managing firewall rules accessible to non-experts, using simple allow/deny syntax instead of complex iptables chains",
        "man_url": "https://manpages.ubuntu.com/manpages/man8/ufw.8.html",
        "flags": {
            "enable": "Enable the firewall",
            "disable": "Disable the firewall",
            "status": "Show firewall status and rules",
            "allow": "Allow traffic on port/service",
            "deny": "Deny traffic on port/service",
            "delete": "Delete a rule",
            "reset": "Reset all rules to defaults",
        
            "limit": "Rate limit connections to a port (6 connections in 30 seconds)",
            "logging": "Set logging level (off, low, medium, high, full)",
            "status numbered": "Show rules with numbers for easy deletion",
        },
        "common_patterns": [
            "sudo ufw status verbose",
            "sudo ufw allow 22",
            "sudo ufw allow 80/tcp",
            "sudo ufw enable",
            "sudo ufw deny from 10.0.0.0/8",
        ],
    
        "use_cases": [
            "Set up a basic server firewall: ufw default deny incoming, ufw allow ssh, ufw allow 80/tcp, ufw enable",
            "Allow connections only from a specific IP: ufw allow from 10.0.0.5 to any port 22",
            "Rate limit SSH to prevent brute force: ufw limit ssh",
            "Check firewall status and rules: ufw status verbose",
        ],
        "gotchas": [
            "Enabling ufw on a remote server without first allowing SSH will lock you out immediately",
            "ufw operates on top of iptables/nftables; direct iptables rules may conflict with ufw rules",
            "ufw does not manage Docker's iptables rules -- Docker bypasses ufw by inserting its own chains",
        ],
        "related": ["iptables", "nft", "firewall-cmd"],
        "difficulty": "beginner",
    },
    "tcpdump": {
        "description": "Capture and analyze network packets in real time, showing the raw data flowing through network interfaces - the essential tool for debugging network protocols, verifying encryption, and diagnosing connectivity issues at the packet level",
        "man_url": "https://www.tcpdump.org/manpages/tcpdump.1.html",
        "flags": {
            "-i": "Capture on specific interface",
            "-n": "Don't resolve hostnames",
            "-c": "Capture only N packets",
            "-w": "Write packets to pcap file",
            "-r": "Read packets from pcap file",
            "-A": "Print packet payload as ASCII",
            "-X": "Print packet in hex and ASCII",
            "-v": "Verbose output",
        
            "-s": "Set the snapshot length (bytes to capture per packet; 0 = full packet)",
            "-e": "Print link-layer (MAC) headers",
            "-D": "List available network interfaces for capture",
            "-l": "Line-buffer stdout for real-time piping to grep",
            "-G": "Rotate capture file every N seconds",
        },
        "common_patterns": [
            "sudo tcpdump -i eth0",
            "sudo tcpdump -i any port 80",
            "sudo tcpdump -w capture.pcap",
            "sudo tcpdump -n -c 100 host 10.0.0.1",
        ],
    
        "use_cases": [
            "Capture HTTP traffic on all interfaces: tcpdump -i any port 80 -A",
            "Save a capture for later analysis in Wireshark: tcpdump -i eth0 -w capture.pcap",
            "Debug DNS resolution issues: tcpdump -i any port 53 -n",
            "Monitor traffic to/from a specific host: tcpdump -i any host 10.0.0.5 -n",
            "Capture only SYN packets to see new connections: tcpdump 'tcp[tcpflags] & tcp-syn != 0'",
        ],
        "gotchas": [
            "tcpdump requires root privileges for packet capture",
            "Capturing on a busy interface without filters generates enormous output -- always use BPF filters to narrow scope",
            "On a server with many connections, -n (no name resolution) is essential to avoid slow output caused by reverse DNS lookups",
            "The -c flag is important in scripts to avoid capturing indefinitely",
        ],
        "related": ["wireshark", "nmap", "ss", "iptables"],
        "difficulty": "advanced",
    },
    "nmap": {
        "description": "Network exploration and security auditing tool that discovers hosts and services on a network by sending carefully crafted packets - used by sysadmins to inventory networks and by security professionals to find vulnerabilities",
        "man_url": "https://nmap.org/book/man.html",
        "flags": {
            "-sS": "TCP SYN scan (stealth)",
            "-sV": "Detect service versions",
            "-O": "Detect operating system",
            "-A": "Aggressive scan (OS, version, scripts, traceroute)",
            "-p": "Scan specific ports",
            "-Pn": "Skip host discovery (treat all hosts as online)",
            "-oN": "Output results to file",
        
            "-sn": "Ping scan only (host discovery, no port scan)",
            "-sU": "UDP port scan (much slower than TCP)",
            "--script": "Run NSE scripts for vulnerability detection",
            "-T": "Set timing template (0-5, higher is faster/noisier)",
            "-oA": "Output in all formats (normal, XML, grepable)",
        },
        "common_patterns": [
            "nmap 192.168.1.0/24",
            "nmap -sV -p 80,443 host",
            "nmap -A host",
            "nmap -p- host",
        ],
    
        "use_cases": [
            "Scan a subnet to discover live hosts: nmap -sn 192.168.1.0/24",
            "Full port scan with service version detection: nmap -sV -p- host",
            "Check if a specific port is open: nmap -p 443 host",
            "Detect the operating system of a remote host: nmap -O host",
            "Run vulnerability scanning scripts: nmap --script vuln host",
        ],
        "gotchas": [
            "Port scanning networks you do not own or have permission to scan is illegal in many jurisdictions",
            "A full port scan (-p-) of 65535 ports is slow; SYN scan (-sS) is faster but requires root",
            "Aggressive scans (-A) are noisy and easily detected by intrusion detection systems",
            "nmap's default scan only covers the top 1000 ports, not all 65535",
        ],
        "related": ["masscan", "nc", "ss", "tcpdump"],
        "difficulty": "advanced",
    },
    "openssl": {
        "description": "A comprehensive cryptography toolkit for working with SSL/TLS certificates, encryption, hashing, and secure connections - indispensable for generating certificates, testing HTTPS endpoints, and debugging TLS handshake issues",
        "man_url": "https://www.openssl.org/docs/man3.0/man1/",
        "flags": {
            "s_client": "Connect to SSL/TLS server for testing",
            "req": "Create certificate signing requests",
            "x509": "Display or manipulate X.509 certificates",
            "genrsa": "Generate RSA private key",
            "enc": "Encrypt/decrypt with various ciphers",
            "dgst": "Create message digests/hashes",
        
            "rand": "Generate random bytes",
            "speed": "Benchmark cryptographic algorithms",
            "verify": "Verify a certificate chain",
            "pkcs12": "Convert between PFX/PKCS12 and PEM formats",
        },
        "common_patterns": [
            "openssl s_client -connect example.com:443",
            "openssl x509 -in cert.pem -text -noout",
            "openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365",
            "openssl genrsa -out key.pem 4096",
        ],
    
        "use_cases": [
            "Test an HTTPS connection and view the certificate chain: openssl s_client -connect host:443",
            "Generate a self-signed certificate for development: openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes",
            "Check certificate expiration: openssl x509 -in cert.pem -noout -enddate",
            "Create a CSR for a production certificate: openssl req -new -key server.key -out server.csr",
            "Generate a random password: openssl rand -base64 32",
        ],
        "gotchas": [
            "The -nodes flag means 'no DES encryption' on the private key, not 'no des' -- it stores the key unencrypted which is a security risk in production",
            "openssl s_client does not verify certificates by default; add -verify_return_error to catch invalid certs",
            "OpenSSL 1.x and 3.x have different default behaviors and deprecated algorithms; check your version with openssl version",
        ],
        "related": ["certbot", "ssh", "curl"],
        "difficulty": "advanced",
    },

    # =========================================================================
    # PERMISSIONS
    # =========================================================================
    "id": {
        "description": "Display the current user's UID, GID, and all group memberships - essential for debugging permission denied errors by verifying exactly what identity and groups the shell is running as",
        "man_url": "https://man7.org/linux/man-pages/man1/id.1.html",
        "flags": {
            "-u": "Print only effective user ID",
            "-g": "Print only effective group ID",
            "-G": "Print all group IDs",
            "-n": "Print name instead of number",
        },
        "common_patterns": ["id", "id -un", "id username", "id -Gn"],
    
        "use_cases": [
            "Display current user's UID, GID, and groups: id",
            "Check another user's identity: id username",
            "Get just the numeric UID for scripting: id -u",
        ],
        "gotchas": [
            "id shows effective IDs, which may differ from real IDs when setuid programs are involved",
            "Supplementary groups listed by id may not match groups if group membership was recently changed",
        ],
        "related": ["whoami", "groups", "who", "w"],
        "difficulty": "beginner",
    },
    "whoami": {
        "description": "Print the effective username of the current user - a quick one-word answer to 'who am I logged in as?' that's commonly used in scripts to check if running as root or the expected user",
        "man_url": "https://man7.org/linux/man-pages/man1/whoami.1.html",
        "flags": {},
        "common_patterns": ["whoami"],
    
        "use_cases": [
            "Quick check in a script whether running as root: [ $(whoami) = root ] || exit 1",
            "Embed the username in log messages or file paths",
        ],
        "gotchas": [
            "whoami prints the effective username, which may be different from the login name if you used su or sudo -u",
        ],
        "related": ["id", "who", "logname"],
        "difficulty": "beginner",
    },
    "passwd": {
        "description": "Change a user's password, enforcing password policies like minimum length and complexity - also used by administrators to manage other users' passwords and lock/unlock accounts",
        "man_url": "https://man7.org/linux/man-pages/man1/passwd.1.html",
        "flags": {
            "-l": "Lock the account (disable password)",
            "-u": "Unlock the account",
            "-d": "Delete password (make passwordless)",
            "-e": "Expire password (force change at next login)",
            "-S": "Display password status information",
        },
        "common_patterns": ["passwd", "sudo passwd username", "sudo passwd -l username"],
    
        "use_cases": [
            "Change your own password: passwd",
            "Change another user's password (root): passwd username",
            "Lock a user account: passwd -l username",
            "Set password expiration: passwd -x 90 username",
        ],
        "gotchas": [
            "Password complexity rules are enforced by PAM -- they may reject passwords that seem fine to you",
            "passwd -l locks the account but does not disable SSH key authentication",
            "Expired passwords may lock users out of automated services that cannot handle interactive password changes",
        ],
        "related": ["chpasswd", "usermod", "chage", "pwck"],
        "difficulty": "beginner",
    },

    # =========================================================================
    # COMPRESSION
    # =========================================================================
    "zstd": {
        "description": "Compress files using the Zstandard algorithm that offers an exceptional balance of compression ratio and speed - significantly faster than gzip with comparable or better compression, making it the modern choice for large datasets",
        "man_url": "https://facebook.github.io/zstd/zstd_manual.html",
        "flags": {
            "-d": "Decompress",
            "-k": "Keep original file",
            "-T": "Number of threads (0 = auto-detect)",
            "-#": "Compression level (1-19, default 3)",
            "--ultra": "Enable ultra compression levels (up to 22)",
            "-r": "Recursively compress directories",
        
            "--fast": "Ultra-fast compression (trade ratio for speed)",
            "--train": "Train a dictionary from sample files",
            "-D": "Use a dictionary for compression/decompression",
            "--rm": "Remove source file after compression (explicit default)",
            "-c": "Write to stdout",
            "--long": "Enable long-distance matching for large files",
            "-19": "High compression level (slower, smaller output)",
        },
        "common_patterns": ["zstd file.txt", "zstd -d file.txt.zst", "zstd -T0 -19 large_file.tar", "zstd -k file.txt"],
    
        "use_cases": [
            "Compress a file: zstd file.txt",
            "Compress with best ratio: zstd -19 file.txt",
            "Compress ultra-fast: zstd --fast file.txt",
            "Decompress a .zst file: zstd -d file.txt.zst",
            "Use multiple CPU cores: zstd -T0 file.txt",
            "Compress while keeping the original: zstd -k file.txt",
        ],
        "gotchas": [
            "zstd supports compression levels from -7 (fast) to 22 (ultra) plus --fast levels -- the default level 3 is usually optimal for most use cases",
            "zstd replaces the original file by default -- use -k to keep the original",
            "While zstd is faster than gzip at comparable compression ratios, the .zst format is not as universally supported -- check that your target systems have zstd installed",
            "The --train option creates a dictionary from sample files for better compression of small, similar files (like JSON logs)",
        ],
        "related": ["gzip", "bzip2", "xz", "lz4"],
        "difficulty": "beginner",
    },

    # =========================================================================
    # SEARCH & NAVIGATION
    # =========================================================================
    "locate": {
        "description": "Find files by name using a pre-built database index, returning results almost instantly compared to find's real-time filesystem scan - the tradeoff is that the database may be hours old, so recently created files may not appear",
        "man_url": "https://man7.org/linux/man-pages/man1/locate.1.html",
        "flags": {
            "-i": "Case-insensitive search",
            "-c": "Print only count of matching entries",
            "-r": "Use regex pattern instead of glob",
            "-n": "Limit output to N results",
        
            "-e": "Print only entries for files that currently exist on disk",
            "-b": "Match only against the basename, not the full path",
        },
        "common_patterns": ["locate filename", "locate -i '*.conf'", "locate -n 10 pattern", "sudo updatedb && locate file"],
    
        "use_cases": [
            "Find files instantly by name: locate nginx.conf",
            "Case-insensitive search: locate -i readme",
            "Count matching files: locate -c '*.log'",
            "Limit output: locate -n 5 pattern",
        ],
        "gotchas": [
            "locate uses a database (updated by updatedb) that may be hours or days old -- recently created files may not appear",
            "Run sudo updatedb to refresh the database before searching if you need current results",
            "locate returns files that have been DELETED since the last updatedb run -- they no longer exist on disk",
            "The database typically excludes certain directories (like /tmp, /proc) and network mounts",
            "On many modern systems, mlocate or plocate has replaced locate with incremental updates",
        ],
        "related": ["find", "updatedb", "which", "whereis"],
        "difficulty": "beginner",
    },
    "rg": {
        "description": "Ripgrep - an extremely fast recursive search tool that respects .gitignore rules by default, making it the modern replacement for grep -r in codebases - typically 2-10x faster than grep or ag for large directory searches",
        "man_url": "https://github.com/BurntSushi/ripgrep/blob/master/GUIDE.md",
        "flags": {
            "-i": "Case-insensitive search",
            "-n": "Show line numbers (default)",
            "-w": "Match whole words only",
            "-t": "Search only files of specified type (e.g., py, js, rust)",
            "-g": "Include/exclude files matching glob pattern",
            "-l": "Show only filenames with matches",
            "-c": "Show count of matches per file",
            "-A": "Show N lines after match",
            "-B": "Show N lines before match",
            "--hidden": "Search hidden files and directories",
            "-F": "Treat pattern as literal string, not regex",
        
            "-M": "Set max line length to display (suppress very long lines)",
            "--json": "Output results in JSON format for programmatic consumption",
            "-U": "Enable multiline matching across line boundaries",
            "-S": "Smart case: case-insensitive if all lowercase, sensitive if any uppercase",
            "-e": "Specify multiple patterns (each with its own -e flag)",
            "--sort": "Sort results by path, modified time, accessed time, or created time",
        },
        "common_patterns": [
            "rg 'pattern' .",
            "rg -t py 'import'",
            "rg -i 'todo|fixme'",
            "rg -l 'function' src/",
            "rg -w 'Error' --hidden",
        ],
    
        "use_cases": [
            "Search for a pattern in only Python files with rg -t py 'import requests'",
            "Find all TODO and FIXME comments with rg -i 'todo|fixme' --glob '!vendor/'",
            "Search with context lines for code review with rg -C 3 'panic!' src/",
            "List only files containing matches for piping to other tools with rg -l 'deprecated' | xargs sed -i 's/deprecated/new_api/g'",
        ],
        "gotchas": [
            "rg skips .gitignore-listed files, hidden files, and binary files by default -- use --no-ignore --hidden -a to search everything",
            "rg uses Rust regex syntax which does not support backreferences or lookahead -- for those patterns use grep -P or ag instead",
            "The -t flag uses built-in type definitions (rg --type-list to see them) -- custom file extensions need --glob or --type-add",
            "rg returns exit code 1 when no matches are found, which can break set -e scripts -- handle it explicitly",
        ],
        "related": ["grep", "ag", "ack", "fd", "fzf"],
        "difficulty": "beginner",
    },
    "fd": {
        "description": "A modern, user-friendly alternative to find that uses sensible defaults (ignores .gitignore, hidden files) and colored output - dramatically simpler syntax for the most common file-finding tasks",
        "man_url": "https://github.com/sharkdp/fd",
        "flags": {
            "-t": "Filter by type (f=file, d=directory, l=symlink, x=executable)",
            "-e": "Filter by file extension",
            "-H": "Include hidden files",
            "-I": "Don't respect .gitignore",
            "-x": "Execute command for each result",
            "-E": "Exclude pattern",
            "-d": "Set maximum search depth",
        
            "--changed-within": "Filter to files modified within a time duration",
            "--changed-before": "Filter to files modified before a time duration",
            "--size": "Filter by file size (e.g., +1m for files over 1MB)",
            "-0": "Separate results with NUL for xargs -0",
            "-L": "Follow symbolic links",
            "-p": "Match against the full path, not just the filename",
        },
        "common_patterns": [
            "fd 'pattern'",
            "fd -e py",
            "fd -t f -e js src/",
            "fd -H '.env'",
            "fd 'test' -x rm",
        ],
    
        "use_cases": [
            "Find all Python files in a project with fd -e py",
            "Find and delete all .DS_Store files with fd -H '.DS_Store' -x rm",
            "Find large files with fd -e log -x ls -lh {} to inspect file sizes",
            "Find recently modified files with fd --changed-within 1d",
        ],
        "gotchas": [
            "fd ignores .gitignore patterns and hidden files by default -- use -H for hidden files and -I to skip .gitignore filtering",
            "fd uses regex patterns by default, not glob -- use -g to switch to glob matching for patterns like '*.py'",
            "On some Linux distributions fd is installed as fdfind to avoid conflict with another package -- create an alias if needed",
        ],
        "related": ["find", "fzf", "rg", "locate"],
        "difficulty": "beginner",
    },
    "fzf": {
        "description": "A blazingly fast fuzzy finder that reads from stdin and presents an interactive selection UI - transforms any list into a searchable, filterable menu, revolutionizing how you navigate files, history, branches, and processes",
        "man_url": "https://github.com/junegunn/fzf",
        "flags": {
            "-m": "Enable multi-select with Tab",
            "--preview": "Show preview of selected item using specified command",
            "--height": "Set display height (e.g., 40%)",
            "-e": "Enable exact match instead of fuzzy",
            "--reverse": "Layout from top to bottom",
            "-q": "Start with given query",
        
            "--bind": "Set custom key bindings for actions within fzf",
            "--header": "Display a fixed header line above the match list",
            "--delimiter": "Set field delimiter for --with-nth and --nth",
            "--nth": "Restrict matching to specific fields",
            "--tac": "Reverse input order",
            "--no-sort": "Do not sort the results",
        },
        "common_patterns": [
            "vim $(fzf)",
            "history | fzf",
            "git branch | fzf",
            "fzf --preview 'cat {}'",
            "kill -9 $(ps aux | fzf | awk '{print $2}')",
        ],
    
        "use_cases": [
            "Open a file in your editor with interactive search with vim $(fzf --preview 'head -50 {}')",
            "Interactively search and checkout a git branch with git checkout $(git branch | fzf)",
            "Kill a process interactively with kill -9 $(ps aux | fzf | awk '{print $2}')",
            "Search command history with Ctrl+R integration (enabled via fzf --bash or fzf --zsh setup)",
        ],
        "gotchas": [
            "fzf reads from stdin by default -- if no input is piped, it uses a file finder (find or fd) which may be slow on large directory trees",
            "Key bindings (Ctrl+R, Ctrl+T, Alt+C) require shell integration setup -- run eval \"$(fzf --bash)\" in your .bashrc",
            "fzf returns exit code 130 when the user presses Escape to cancel -- handle this in scripts with || true",
            "The FZF_DEFAULT_COMMAND environment variable controls what command generates the file list -- set it to fd or rg --files for better performance",
        ],
        "related": ["fd", "rg", "find", "grep"],
        "difficulty": "intermediate",
    },

    # =========================================================================
    # DEVELOPMENT
    # =========================================================================
    "docker-compose": {
        "description": "Define and run multi-container Docker applications using a YAML configuration file - instead of manually managing individual containers, you declare your entire application stack (web server, database, cache) and launch it with one command",
        "man_url": "https://docs.docker.com/compose/reference/",
        "flags": {
            "up": "Create and start containers",
            "down": "Stop and remove containers",
            "build": "Build or rebuild services",
            "logs": "View output from containers",
            "ps": "List containers",
            "-d": "Detached mode (run in background)",
            "-f": "Specify compose file",
            "--build": "Build images before starting containers",
        
            "--env-file": "Specify an alternate .env file for environment variable substitution",
            "--profile": "Specify a profile to enable optional services",
            "--scale": "Scale a service to N instances",
        },
        "common_patterns": [
            "docker-compose up -d",
            "docker-compose down",
            "docker-compose logs -f",
            "docker-compose build",
            "docker-compose -f docker-compose.prod.yml up -d",
        ],
    
        "use_cases": [
            "Start a full application stack in the background with docker-compose up -d",
            "View real-time logs from all services with docker-compose logs -f",
            "Rebuild images after code changes with docker-compose up --build -d",
            "Scale a specific service with docker-compose up -d --scale worker=3",
        ],
        "gotchas": [
            "docker-compose (V1, Python) is deprecated -- use docker compose (V2, Go plugin) which is now built into Docker CLI",
            "V2 uses hyphens in container names (myproject-svc-1) instead of V1's underscores (myproject_svc_1) -- this can break scripts that parse container names",
            "The top-level version: field in docker-compose.yml is ignored by V2 -- it uses the Compose Specification directly",
            "docker-compose down removes containers but not volumes -- add -v to also remove named volumes, or data persists between restarts",
        ],
        "related": ["docker", "podman", "kubectl"],
        "difficulty": "intermediate",
    },
    "kubectl": {
        "description": "Command-line tool for controlling Kubernetes clusters - manage deployments, inspect running pods, view logs, and execute commands inside containers across distributed container orchestration infrastructure",
        "man_url": "https://kubernetes.io/docs/reference/kubectl/",
        "flags": {
            "get": "Display resources",
            "describe": "Show detailed resource information",
            "apply": "Apply configuration from file",
            "delete": "Delete resources",
            "logs": "Print container logs",
            "exec": "Execute command in container",
            "-n": "Specify namespace",
            "-o": "Output format (json, yaml, wide)",
            "-f": "File to apply or follow logs",
        
            "--dry-run": "Preview the request without sending it (client or server side)",
            "-w": "Watch for changes to resources in real time",
            "--context": "Specify which kubeconfig context (cluster) to use",
            "--all-namespaces": "List resources across all namespaces (shorthand: -A)",
        },
        "common_patterns": [
            "kubectl get pods",
            "kubectl get pods -n production",
            "kubectl describe pod pod-name",
            "kubectl logs pod-name -f",
            "kubectl apply -f deployment.yaml",
            "kubectl exec -it pod-name -- /bin/bash",
        ],
    
        "use_cases": [
            "View running pods in all namespaces with kubectl get pods -A",
            "Debug a failing pod by viewing its logs with kubectl logs pod-name -f --previous",
            "Execute a shell inside a running container with kubectl exec -it pod-name -- /bin/sh",
            "Apply infrastructure changes declaratively with kubectl apply -f deployment.yaml",
        ],
        "gotchas": [
            "Always specify -n namespace or set a default with kubectl config set-context --current --namespace=myns -- forgetting the namespace is a very common source of confusion",
            "kubectl apply tracks changes via annotations -- switching between apply and create/replace can cause conflicts",
            "kubectl delete pod does not prevent recreation -- Deployments automatically recreate deleted pods. Delete the Deployment instead to stop pods permanently",
            "kubectl logs only shows logs from the current container instance -- use --previous to see logs from the crashed previous instance",
        ],
        "related": ["helm", "minikube", "docker", "podman"],
        "difficulty": "intermediate",
    },
    "vim": {
        "description": "A highly configurable modal text editor where you switch between insert mode (typing text) and normal mode (executing commands) - mastering its keyboard-driven workflow yields unmatched editing speed and is available on virtually every Unix system",
        "man_url": "https://vimhelp.org/",
        "flags": {
            "-R": "Read-only mode",
            "-d": "Diff mode (compare files)",
            "+": "Start at end of file",
            "+/pattern": "Start at first occurrence of pattern",
            "-p": "Open files in tabs",
            "-O": "Open files in vertical splits",
        
            "-o": "Open files in horizontal splits",
            "-c": "Execute a vim command after opening the file",
            "-u": "Use a specific vimrc configuration file (use NONE for vanilla vim)",
            "-x": "Open file with encryption (prompted for password)",
        },
        "common_patterns": ["vim file.txt", "vim +42 file.txt", "vim -d file1.txt file2.txt", "vim -p *.py"],
    
        "use_cases": [
            "Edit a file starting at a specific line with vim +42 file.txt",
            "Open multiple files in split view with vim -O file1.py file2.py",
            "Compare two files visually with vim -d file1.txt file2.txt (vimdiff)",
            "Search and replace across a file with vim -c '%s/old/new/gc' -c 'wq' file.txt for scripted editing",
        ],
        "gotchas": [
            "Vim starts in normal mode, not insert mode -- press i to start typing. This trips up every new user",
            "Exiting vim: press Escape, then type :wq to save and quit, or :q! to quit without saving -- this is the most searched programming question on the internet",
            "Vim swap files (.swp) are created automatically and can cause issues if vim crashes -- use vim -r file to recover, then delete the .swp file",
            "Avoid using arrow keys in normal mode -- learn hjkl and motions (w, b, e, f, /) for dramatically faster navigation",
        ],
        "related": ["nvim", "vi", "nano", "emacs"],
        "difficulty": "intermediate",
    },
    "nano": {
        "description": "A straightforward, beginner-friendly terminal text editor with on-screen keyboard shortcuts - when you need to quickly edit a config file on a server and don't know vim, nano gets the job done with minimal learning curve",
        "man_url": "https://www.nano-editor.org/dist/latest/nano.1.html",
        "flags": {
            "-l": "Show line numbers",
            "-m": "Enable mouse support",
            "-i": "Auto-indent new lines",
            "-B": "Create backup before editing",
            "-w": "Don't wrap long lines",
        
            "-E": "Convert tabs to spaces when typing",
            "-S": "Enable smooth scrolling instead of half-screen jumps",
            "-Y": "Specify syntax highlighting definition to use",
        },
        "common_patterns": ["nano file.txt", "nano -l file.txt", "sudo nano /etc/hosts"],
    
        "use_cases": [
            "Quick-edit a config file on a server with sudo nano /etc/nginx/nginx.conf",
            "Edit with line numbers for reference with nano -l file.py",
            "Create a backup before editing with nano -B important.conf",
        ],
        "gotchas": [
            "Keyboard shortcuts shown at the bottom use ^ for Ctrl and M- for Alt -- ^X means Ctrl+X, M-U means Alt+U",
            "nano wraps long lines by default which can corrupt config files -- use nano -w to disable wrapping for config file editing",
            "nano does not have the modal editing or macro power of vim -- it is excellent for quick edits but limited for large-scale text manipulation",
        ],
        "related": ["vim", "vi", "emacs", "code"],
        "difficulty": "beginner",
    },
    "gcc": {
        "description": "The GNU C/C++ compiler that transforms source code into executable binaries - the standard compiler on Linux and the foundation of most open-source software builds",
        "man_url": "https://gcc.gnu.org/onlinedocs/gcc/",
        "flags": {
            "-o": "Specify output filename",
            "-c": "Compile only (don't link)",
            "-g": "Include debugging information",
            "-O2": "Enable optimization level 2",
            "-Wall": "Enable all common warnings",
            "-Werror": "Treat warnings as errors",
            "-I": "Add include directory",
            "-L": "Add library directory",
            "-l": "Link with library",
            "-std": "Specify language standard (c11, c++17)",
        
            "-Wextra": "Enable extra warnings beyond -Wall",
            "-pedantic": "Issue warnings demanded by strict ISO C compliance",
            "-fsanitize": "Enable runtime sanitizers (address, undefined, thread, memory)",
            "-D": "Define a preprocessor macro",
            "-S": "Compile to assembly instead of object code",
            "-E": "Preprocess only, do not compile",
            "-pie": "Create a position-independent executable",
            "-shared": "Create a shared library",
        },
        "common_patterns": ["gcc -o program main.c", "gcc -Wall -g -o debug main.c", "gcc -O2 -o fast main.c"],
    
        "use_cases": [
            "Compile a C program with warnings and debug info with gcc -Wall -Wextra -g -o program main.c",
            "Build an optimized release binary with gcc -O2 -o fast_program main.c",
            "Compile multiple source files and link with a library with gcc -o app main.c utils.c -lm -lpthread",
            "Generate only the object file for later linking with gcc -c -o module.o module.c",
        ],
        "gotchas": [
            "Order matters for -l flags: libraries must come AFTER the object files that reference them -- gcc main.c -lm works but gcc -lm main.c may fail with undefined references",
            "-O2 is generally safe for production but -O3 can occasionally produce different floating-point results or expose latent bugs in code with undefined behavior",
            "Without -Wall -Wextra many real bugs go unreported -- always enable warnings and consider -Werror in CI",
            "gcc and g++ are different frontends -- use g++ for C++ code, gcc for C, even though gcc can sometimes compile C++",
        ],
        "related": ["g++", "clang", "make", "gdb", "ld"],
        "difficulty": "intermediate",
    },
    "gdb": {
        "description": "The GNU debugger for stepping through C/C++ programs instruction by instruction, inspecting variables, setting breakpoints, and examining crash dumps - the primary tool for diagnosing segfaults and logic errors in compiled code",
        "man_url": "https://sourceware.org/gdb/current/onlinedocs/gdb/",
        "flags": {
            "-q": "Quiet mode (suppress intro text)",
            "--args": "Pass arguments to program being debugged",
            "-ex": "Execute GDB command on startup",
            "-tui": "Use text user interface with source display",
        
            "-batch": "Run in batch mode (exit after processing -ex commands)",
            "-p": "Attach to running process by PID",
            "-core": "Load a core dump file for post-mortem debugging",
            "-x": "Execute GDB commands from a file",
        },
        "common_patterns": ["gdb ./program", "gdb -q --args ./program arg1 arg2", "gdb -tui ./program"],
    
        "use_cases": [
            "Debug a segfault by running gdb ./program then typing run, and bt (backtrace) after the crash",
            "Set a breakpoint and inspect variables with gdb -ex 'break main' -ex 'run' ./program",
            "Examine a core dump with gdb ./program core to see where a crash occurred post-mortem",
            "Debug with source display using gdb -tui ./program for a visual split-screen interface",
        ],
        "gotchas": [
            "Programs must be compiled with -g for meaningful debug output -- without it gdb shows only assembly and hex addresses",
            "Optimized code (-O2, -O3) confuses gdb because variables are optimized out and code is reordered -- debug with -O0 -g",
            "gdb prints variables in the current scope only -- if a variable shows as 'optimized out' try compiling with -O0",
            "Use -ex to pass commands non-interactively: gdb -batch -ex run -ex bt --args ./program for automated crash analysis",
        ],
        "related": ["lldb", "valgrind", "gcc", "objdump"],
        "difficulty": "intermediate",
    },

    # =========================================================================
    # SHELL BUILTINS
    # =========================================================================
    "source": {
        "description": "Execute commands from a file in the current shell environment rather than a subshell, meaning any variables, functions, or settings it defines persist after it finishes - this is how you activate virtualenvs and load .bashrc changes",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "flags": {},
        "common_patterns": ["source ~/.bashrc", "source venv/bin/activate", ". .env"],
    
        "use_cases": [
            "Reload shell configuration after editing: source ~/.bashrc",
            "Activate a Python virtual environment: source venv/bin/activate",
            "Load environment variables from a .env file: source .env",
            "Include shared function libraries in scripts: source lib/utils.sh",
        ],
        "gotchas": [
            "source executes in the current shell, so any exit call in the sourced file will terminate YOUR shell session",
            "Variables and functions from the sourced file persist in the current shell -- there is no isolation",
            "If the sourced file has a syntax error, it can leave your shell in a broken state",
            "source searches PATH if the filename has no slashes -- use ./file to be explicit about the current directory",
            "The . (dot) command is the POSIX equivalent; source is a bash extension not available in dash or strict POSIX sh",
        ],
        "related": [".", "exec", "eval", "bash"],
        "difficulty": "beginner",
    },
    "exec": {
        "description": "Replace the current shell process with a new command without creating a child process, or redirect file descriptors for the entire shell session - used in Docker entrypoints and init scripts to hand off control cleanly",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "flags": {},
        "common_patterns": ["exec bash", "exec > logfile.txt 2>&1", "exec python app.py"],
    
        "use_cases": [
            "Replace shell with another process in Docker entrypoints: exec python app.py",
            "Redirect all subsequent script output to a log file: exec > /var/log/script.log 2>&1",
            "Open a file descriptor for reading: exec 3< input.txt",
            "Replace the current shell with a login shell: exec -l bash",
            "Ensure a wrapper script does not remain as a parent process: exec \"$@\" in entrypoint.sh",
        ],
        "gotchas": [
            "exec replaces the current process -- any code after exec never runs (unless exec fails)",
            "When used for redirection (exec > file), it affects ALL subsequent commands in the shell, not just one",
            "exec without a command but with redirections only changes file descriptors for the current shell",
            "In Docker, failing to use exec means signals (SIGTERM) go to the shell, not your application",
        ],
        "related": ["source", "eval", "bash", "nohup"],
        "difficulty": "intermediate",
    },
    "eval": {
        "description": "Evaluate a string as a bash command, performing an extra round of expansion before execution - powerful but dangerous, commonly used for dynamically constructing commands from variables but a frequent source of injection vulnerabilities",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "flags": {},
        "common_patterns": ["eval \"$(ssh-agent -s)\"", "eval $COMMAND_STRING"],
    
        "use_cases": [
            "Initialize ssh-agent in a shell session: eval \"$(ssh-agent -s)\"",
            "Execute dynamically constructed commands from trusted sources",
            "Perform indirect variable expansion in older bash: eval echo \\$$varname",
            "Process output of commands that print shell variable assignments",
        ],
        "gotchas": [
            "eval performs an EXTRA round of expansion before execution -- this is a major injection risk with untrusted input",
            "Never pass user-supplied or external data to eval without rigorous sanitization; attackers can inject arbitrary commands",
            "Prefer bash-native alternatives: ${!varname} for indirect expansion, arrays for dynamic arguments, declare -n for namerefs",
            "Debugging eval is difficult because errors refer to the evaluated string, not your source code line",
            "CVE-2019-9891 was issued for an insecure eval in a widely-used bash scripting guide -- the risk is real",
        ],
        "related": ["exec", "source", "bash"],
        "difficulty": "advanced",
    },
    "set": {
        "description": "Configure shell behavior options and positional parameters - 'set -e' to exit on errors, 'set -x' to trace execution, and 'set -u' to catch unset variables are the three most important settings for robust bash scripts",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html",
        "flags": {
            "-e": "Exit immediately on command failure",
            "-u": "Treat unset variables as errors",
            "-x": "Print commands before execution (debug trace)",
            "-o pipefail": "Pipe fails if any command in pipeline fails",
            "-f": "Disable filename globbing",
            "+x": "Disable trace mode (undo -x)",
        
            "-a": "Automatically export all subsequently defined or modified variables",
            "-b": "Report terminated background jobs immediately",
            "-n": "Read commands but do not execute them (syntax checking mode)",
            "-v": "Print shell input lines as they are read",
            "-h": "Hash commands as they are looked up for execution",
            "-C": "Prevent output redirection from overwriting existing files (noclobber)",
            "-T": "Inherit DEBUG and RETURN traps in shell functions",
        },
        "common_patterns": ["set -euo pipefail", "set -x", "set +x", "set -- arg1 arg2"],
    
        "use_cases": [
            "Make scripts fail-safe: set -euo pipefail at the top of every script",
            "Enable debug tracing: set -x to see each command before it runs, set +x to stop",
            "Reset positional parameters: set -- \"$file1\" \"$file2\" to reassign $1, $2",
            "Disable globbing temporarily: set -f before processing patterns literally",
        ],
        "gotchas": [
            "set -e does NOT cause exit inside if conditions, while/until loops, or commands followed by && or ||",
            "set -e with arithmetic: ((count++)) returns 1 when count is 0, causing unexpected script exit",
            "set -o pipefail makes grep returning no matches (exit 1) fail the entire pipeline",
            "set -u treats ${array[@]} as an unbound variable error on empty arrays in bash < 4.4",
            "set with no arguments prints ALL shell variables and functions -- use set -o to see just options",
            "Use set +o to reset options: save state with oldopts=$(set +o), restore with eval \"$oldopts\"",
        ],
        "related": ["shopt", "trap", "bash"],
        "difficulty": "intermediate",
    },
    "trap": {
        "description": "Execute commands when the shell receives signals or exits, enabling cleanup actions like removing temp files, restoring state, or logging - the key to writing scripts that behave gracefully when interrupted or killed",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "flags": {
            "-l": "List signal names and numbers",
            "-p": "Print trap commands for specified signals",
        },
        "common_patterns": [
            "trap 'rm -f /tmp/tmpfile' EXIT",
            "trap 'echo Interrupted; exit 1' INT TERM",
            "trap cleanup EXIT",
        ],
    
        "use_cases": [
            "Clean up temporary files on exit: trap 'rm -f $tmpfile' EXIT",
            "Handle Ctrl-C gracefully: trap 'echo Interrupted; cleanup; exit 130' INT",
            "Log script completion: trap 'echo \"Script finished at $(date)\"' EXIT",
            "Debug function entry/exit: trap 'echo \"Entering: $FUNCNAME\"' DEBUG",
            "Reset a trap: trap - INT (restores default signal handling for SIGINT)",
        ],
        "gotchas": [
            "trap on EXIT fires on ANY exit (success, failure, signals) -- but NOT on SIGKILL (kill -9), which cannot be caught",
            "Inside a trap handler, calling exit re-triggers the EXIT trap -- avoid recursive exit calls in EXIT handlers",
            "ERR traps are NOT inherited by functions by default -- use set -E (errtrace) to propagate them",
            "Trap handlers execute in the context of the current shell -- be careful with variable scope",
            "Setting a trap replaces any previous trap for that signal -- you cannot stack multiple handlers",
            "Use signal names (INT, TERM, EXIT) not numbers for portability -- signal numbers vary across operating systems",
        ],
        "related": ["kill", "exit", "set"],
        "difficulty": "intermediate",
    },
    "declare": {
        "description": "Declare variables with type attributes in bash, enabling integers, arrays, associative arrays, readonly variables, and exported variables - the formal way to create typed data structures in shell scripts",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "flags": {
            "-a": "Declare indexed array",
            "-A": "Declare associative array (dictionary/map)",
            "-i": "Declare integer (arithmetic evaluation on assignment)",
            "-r": "Declare readonly (same as readonly command)",
            "-x": "Declare and export to environment",
            "-p": "Display attributes and values",
        
            "-l": "Convert value to lowercase on assignment",
            "-u": "Convert value to uppercase on assignment",
            "-n": "Make the variable a nameref (alias for another variable name)",
            "-g": "Create global variable even when used inside a function",
            "-f": "Restrict action to function names and definitions",
            "-F": "Display only function names (not definitions) when listing",
            "-t": "Give the variable the trace attribute (for debugging with DEBUG trap)",
        },
        "common_patterns": ["declare -a myarray=(1 2 3)", "declare -A mymap=([key1]=val1 [key2]=val2)", "declare -i count=0"],
    
        "use_cases": [
            "Create an associative array (dictionary): declare -A config; config[host]='localhost'",
            "Enforce integer-only variables: declare -i count=0; count+=5 gives 5, not '05'",
            "Make a variable readonly: declare -r VERSION='1.0.0'",
            "Force lowercase: declare -l name; name='ALICE' stores 'alice'",
            "List all functions and their definitions: declare -f",
            "Inspect a variable's type: declare -p myvar",
        ],
        "gotchas": [
            "Inside functions, declare creates LOCAL variables by default -- use declare -g to create globals",
            "declare -A requires bash 4.0+ -- not available on macOS default bash (3.2) without upgrading",
            "declare -i makes ALL assignments arithmetic: declare -i x; x=hello sets x to 0 (no error)",
            "declare -n (nameref) requires bash 4.3+ and can cause confusing circular reference errors",
        ],
        "related": ["local", "typeset", "readonly", "export"],
        "difficulty": "intermediate",
    },
    "local": {
        "description": "Declare variables with local scope inside a function, preventing them from leaking into the global namespace - essential for writing reusable functions that don't accidentally overwrite variables in the calling scope",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "flags": {},
        "common_patterns": ["local var='value'", "local -i count=0", "local -a items=()"],
    
        "use_cases": [
            "Prevent variable leaking in functions: local temp_file=$(mktemp)",
            "Create a local copy of IFS: local IFS=,",
            "Local integer variable: local -i count=0",
            "Local array: local -a items=()",
        ],
        "gotchas": [
            "local can only be used inside a function -- calling it at the top level is an error",
            "local var=$(command) masks the exit status of command -- $? always reflects local's success",
            "In bash, local uses dynamic scoping, not lexical -- called functions can see the caller's locals",
            "local -r creates a readonly local that cannot be unset even within the function",
        ],
        "related": ["declare", "typeset", "readonly"],
        "difficulty": "intermediate",
    },
    "readonly": {
        "description": "Mark variables or functions as immutable so they cannot be changed or unset for the remainder of the shell session - use this for constants and critical configuration values that must not be accidentally overwritten",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "flags": {
            "-p": "Display all readonly variables",
            "-a": "Refer to indexed arrays",
            "-A": "Refer to associative arrays",
        },
        "common_patterns": ["readonly DB_HOST='localhost'", "readonly -p"],
    
        "use_cases": [
            "Define constants: readonly DB_HOST='localhost'",
            "Protect critical variables from accidental modification: readonly PATH",
            "Make a function immutable: readonly -f critical_function",
            "List all readonly variables: readonly -p",
        ],
        "gotchas": [
            "Readonly variables CANNOT be unset -- they persist for the entire shell session",
            "A readonly variable in a parent shell is NOT inherited as readonly by child processes",
            "If you source a file that sets readonly variables, you cannot change them afterward in that session",
            "readonly -a applies to indexed arrays; readonly -A applies to associative arrays",
        ],
        "related": ["declare", "local", "export", "unset"],
        "difficulty": "intermediate",
    },
    "pushd": {
        "description": "Push the current directory onto a stack and change to a new directory, creating a breadcrumb trail you can retrace - far superior to 'cd' when you need to jump between multiple directories and return to each one in order",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Directory-Stack-Builtins.html",
        "flags": {
            "-n": "Suppress directory change (rotate stack only)",
        },
        "common_patterns": ["pushd /tmp", "pushd ~/projects", "pushd +2"],
    
        "use_cases": [
            "Save current directory and jump to another: pushd /tmp",
            "Navigate between project directories: pushd ~/project-a, then pushd ~/project-b",
            "Rotate the directory stack: pushd +2 brings the third entry to the top",
            "Build scripts that work in multiple directories and return cleanly",
        ],
        "gotchas": [
            "pushd prints the entire directory stack after each call, which can be noisy -- redirect to /dev/null if unwanted",
            "pushd with no arguments swaps the top two directories on the stack (like cd -)",
            "The directory stack is per-shell and not shared across terminal sessions",
            "Numeric arguments (+N, -N) count from the top or bottom of the stack, not from 0",
        ],
        "related": ["popd", "dirs", "cd"],
        "difficulty": "intermediate",
    },
    "popd": {
        "description": "Pop the top directory off the stack and change back to it, unwinding the trail created by pushd - perfect for scripts that need to temporarily work in other directories and reliably return to where they started",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Directory-Stack-Builtins.html",
        "flags": {
            "-n": "Suppress directory change (just remove from stack)",
        },
        "common_patterns": ["popd", "popd +1"],
    
        "use_cases": [
            "Return to the previous directory after pushd: popd",
            "Remove a specific entry from the directory stack: popd +2",
            "Use in scripts paired with pushd for reliable directory restoration",
        ],
        "gotchas": [
            "popd on an empty stack (only the current directory) produces an error",
            "popd changes the working directory -- use popd -n to remove from the stack without changing dirs",
            "The stack index changes after each pop, so removing multiple entries requires care with indices",
        ],
        "related": ["pushd", "dirs", "cd"],
        "difficulty": "intermediate",
    },
    "getopts": {
        "description": "Parse positional parameters as option flags in shell scripts, implementing the standard Unix command-line option convention - the built-in way to make your scripts accept flags like -v for verbose or -f for filename",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "flags": {},
        "common_patterns": ["while getopts 'vf:o:' opt; do case $opt in v) verbose=1;; f) file=$OPTARG;; esac; done"],
    
        "use_cases": [
            "Parse script options: while getopts 'vf:o:h' opt; do case $opt in v) verbose=1;; f) file=$OPTARG;; h) usage;; esac; done",
            "Handle options with required arguments: getopts 'f:' (colon means -f requires an argument)",
            "Skip processed options to access remaining arguments: shift $((OPTIND - 1))",
        ],
        "gotchas": [
            "getopts only supports single-character options -- it cannot parse --long-options (use getopt or manual parsing for those)",
            "A colon after a letter means it requires an argument: 'f:' means -f VALUE -- missing the colon makes it a flag",
            "OPTIND must be reset to 1 if you want to parse a different set of arguments or call getopts again",
            "A leading colon in the optstring (':vf:') enables silent error mode, putting the bad option in OPTARG instead of printing an error",
            "getopts stops at the first non-option argument -- options after positional args are not parsed",
        ],
        "related": ["shift", "case", "set"],
        "difficulty": "intermediate",
    },
    "ulimit": {
        "description": "Get or set per-process resource limits like maximum open files, stack size, and memory usage - crucial for production servers where default limits are often too low for databases, web servers, or applications handling many connections",
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "flags": {
            "-n": "Maximum number of open file descriptors",
            "-s": "Maximum stack size",
            "-u": "Maximum number of user processes",
            "-v": "Maximum virtual memory size",
            "-a": "Display all current limits",
            "-S": "Use soft limit",
            "-H": "Use hard limit",
        
            "-c": "Maximum size of core files created (blocks)",
            "-d": "Maximum size of a process's data segment (kbytes)",
            "-f": "Maximum size of files written by the shell and children (blocks)",
            "-l": "Maximum size that may be locked into memory (kbytes)",
            "-m": "Maximum resident set size (kbytes, not effective on many systems)",
            "-t": "Maximum amount of CPU time (seconds)",
            "-p": "Pipe buffer size (512-byte blocks)",
        },
        "common_patterns": ["ulimit -a", "ulimit -n 65535", "ulimit -n"],
    
        "use_cases": [
            "Show all current resource limits: ulimit -a",
            "Increase open file limit for a database server: ulimit -n 65536",
            "Set maximum process stack size: ulimit -s unlimited",
            "Check the maximum number of user processes: ulimit -u",
            "Set core dump file size to unlimited for debugging: ulimit -c unlimited",
        ],
        "gotchas": [
            "A regular user can only LOWER hard limits -- once lowered, only root can raise them back",
            "Soft limits can be raised up to the hard limit value; hard limits can only be lowered (unless root)",
            "ulimit affects the current shell and its children -- it does not persist across sessions unless set in .bashrc or /etc/security/limits.conf",
            "ulimit -n changes are per-process -- each new shell gets its own copy of the limit",
            "The 'unlimited' keyword means no limit, but the kernel may still enforce system-wide maximums",
        ],
        "related": ["sysctl"],
        "difficulty": "intermediate",
    },
    ".": {
        "description": "Read and execute commands from the specified file in the current shell environment, equivalent to the source command. Use it to load shell configuration, define functions, or set environment variables from an external file without starting a subshell.",
        "flags": {},
        "common_patterns": [". ~/.bashrc", ". ./env.sh", ". /etc/profile"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Load environment variables: . /etc/profile",
            "Include function definitions: . ./lib/helpers.sh",
            "POSIX-compatible alternative to source: . ~/.bashrc",
        ],
        "gotchas": [
            "Identical to source in bash, but . is the POSIX-standard form and works in all POSIX shells",
            "If given a filename without a path component, searches PATH -- use ./ prefix for current directory files",
            "An exit in the sourced file terminates the calling shell",
        ],
        "related": ["source", "exec", "eval"],
        "difficulty": "beginner",
    },
    "7z": {
        "description": "Full-featured command-line file archiver supporting 7z, ZIP, GZIP, BZIP2, XZ, TAR, and many other formats with high compression. You use 7z when you need maximum compression, AES-256 encryption, or support for a wide variety of archive formats.",
        "flags": {
            "a": "Add files to a new or existing archive",
            "x": "Extract files preserving full directory paths",
            "e": "Extract files without directory structure",
            "l": "List archive contents",
            "t": "Test archive integrity",
            "d": "Delete files from an archive",
            "-p": "Set a password for encryption or decryption",
            "-mx": "Set compression level from 0 (store) to 9 (ultra)",
            "u": "Update files in an archive",
            "-t": "Set archive type (7z, zip, gzip, bzip2, tar)",
            "-v": "Create multi-volume (split) archives",
        },
        "common_patterns": ["7z a archive.7z directory/", "7z x archive.7z", "7z l archive.zip", "7z a -mx=9 -pSECRET encrypted.7z files/"],
        "man_url": "https://linux.die.net/man/1/7z",
        "use_cases": [
            "Create a 7z archive: 7z a archive.7z file1.txt file2.txt",
            "Extract a 7z archive: 7z x archive.7z",
            "List contents of an archive: 7z l archive.7z",
            "Create a password-protected archive: 7z a -p archive.7z sensitive/",
            "Create a zip-format archive with 7z: 7z a archive.zip directory/",
        ],
        "gotchas": [
            "7z achieves the best compression but is slower than gzip or zstd -- use it for archival and distribution, not real-time compression",
            "7z e extracts files flat (no directory structure); use 7z x to preserve the directory tree",
            "The 7z format does not preserve Unix file permissions or ownership -- use tar inside 7z for Unix systems",
            "Different 7z packages exist on Linux: p7zip-full provides 7z, while p7zip provides only 7za (fewer formats)",
        ],
        "related": ["7za", "zip", "unzip", "tar"],
        "difficulty": "intermediate",
    },
    "7za": {
        "description": "Standalone command-line file archiver with high compression ratio supporting 7z, ZIP, GZIP, BZIP2, and TAR formats. You use 7za when you need strong compression, encrypted archives, or multi-format support from a single tool.",
        "flags": {
            "a": "Add files to a new or existing archive",
            "x": "Extract files preserving directory structure",
            "e": "Extract files to the current directory without directory structure",
            "l": "List the contents of an archive",
            "t": "Test the integrity of an archive",
            "-p": "Set a password for encryption or decryption",
            "-mx": "Set compression level from 0 (none) to 9 (ultra)",
            "-t": "Specify archive type (7z, zip, gzip, bzip2, tar)"
        },
        "common_patterns": ["7za a archive.7z files/", "7za x archive.7z", "7za l archive.7z", "7za a -mx=9 -p archive.7z secret/"],
        "man_url": "https://linux.die.net/man/1/7za",
        "use_cases": [
            "Create a 7z archive with the standalone version: 7za a archive.7z files/",
            "Extract an archive: 7za x archive.7z",
            "Test archive integrity: 7za t archive.7z",
        ],
        "gotchas": [
            "7za is a standalone version of 7z with fewer supported formats -- it handles 7z, xz, lzma, and a few others but not all formats 7z supports",
            "For full format support (zip, rar, cab, etc.), install p7zip-full which provides 7z instead of 7za",
        ],
        "related": ["7z", "zip", "tar"],
        "difficulty": "intermediate",
    },
    ":": {
        "description": "A shell builtin that does nothing and always returns a success (zero) exit status, equivalent to the true command. Use it as a no-op placeholder in shell scripts where a command is syntactically required but no action is needed, such as in empty loop bodies or as a default case.",
        "flags": {},
        "common_patterns": [": # this is a no-op", "while :; do echo loop; sleep 1; done", ": ${VAR:=default}"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Infinite loop: while :; do check_status; sleep 5; done",
            "Set default variable values: : ${TIMEOUT:=30} (sets TIMEOUT to 30 if unset)",
            "No-op placeholder in an if branch: if condition; then :; else handle_else; fi",
            "Comment-like usage in legacy scripts (though # is preferred for comments)",
        ],
        "gotchas": [
            ": is a POSIX special builtin -- errors from : can cause a non-interactive shell to exit in strict POSIX mode",
            "Arguments to : ARE expanded (variable expansion, globbing, etc.) even though the result is discarded",
            ": ${VAR:=default} is an idiom for defaults, but : ${VAR:=command $(that runs)} will execute the command substitution",
            "The colon command is faster than true because it is always a builtin with zero overhead",
        ],
        "related": ["true", "false", "test"],
        "difficulty": "intermediate",
    },
    "[": {
        "description": "Evaluate a conditional expression and return a zero (true) or non-zero (false) exit status, equivalent to the test builtin. Use it in if statements and loops to test conditions like string equality, file existence, and numeric comparisons.",
        "flags": {
            "-f": "True if the file exists and is a regular file",
            "-d": "True if the file exists and is a directory",
            "-z": "True if the string length is zero",
            "-n": "True if the string length is non-zero",
            "-eq": "True if integers are equal",
            "-ne": "True if integers are not equal",
            "-e": "True if the file exists (any type)"
        },
        "common_patterns": ["[ -f file.txt ]", "[ -d /path ]", "[ \"$a\" = \"$b\" ]", "[ $x -gt 0 ]"],
        "man_url": "https://man7.org/linux/man-pages/man1/test.1.html",
        "use_cases": [
            "Conditional file check in if block: if [ -f /etc/hosts ]; then echo 'exists'; fi",
            "String comparison: [ \"$answer\" = 'yes' ]",
            "Numeric comparison: [ $x -le 100 ]",
            "Combine conditions: [ -d dir ] && [ -w dir ]",
        ],
        "gotchas": [
            "[ is a command, not syntax -- there MUST be spaces around [ and ] or you get parse errors",
            "Always quote variables inside [ ]: [ -f $file ] breaks if file is empty or has spaces",
            "Do not use && or || inside [ ] -- use -a and -o, or use separate [ ] tests joined by shell && / ||",
            "< and > inside [ ] are redirection operators, not comparison -- use -lt and -gt for numbers, or use [[ ]] for string comparison",
            "The closing ] is actually an argument to [ -- forgetting it gives 'missing ]' errors",
        ],
        "related": ["test", "[[", "if"],
        "difficulty": "beginner",
    },
    "[[": {
        "description": "A bash-specific conditional construct that evaluates expressions with enhanced features over [ including pattern matching, regex matching, and safer variable handling. Use it in bash scripts for conditional tests that benefit from regex support with =~, glob matching with ==, and no need to quote variables.",
        "flags": {
            "-f": "True if the file exists and is a regular file",
            "-d": "True if the file exists and is a directory",
            "-z": "True if the string length is zero",
            "-n": "True if the string length is non-zero",
            "=~": "Match string against an extended regular expression",
            "==": "Pattern match with glob-style wildcards"
        },
        "common_patterns": ["[[ -f file.txt ]]", "[[ $str =~ ^[0-9]+$ ]]", "[[ $a == pattern* ]]", "[[ -n $var && -d $dir ]]"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Conditional-Constructs.html",
        "use_cases": [
            "Pattern matching: [[ $filename == *.tar.gz ]]",
            "Regex matching: [[ $email =~ ^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$ ]]",
            "Safe unquoted variable comparison: [[ -z $var ]] (no word splitting inside [[)",
            "Combine conditions naturally: [[ -f file && -r file ]]",
        ],
        "gotchas": [
            "[[ is bash-specific -- it will not work in POSIX sh, dash, or other minimal shells",
            "== inside [[ does PATTERN matching (glob), not exact string comparison -- quote the right side for literal match: [[ $x == \"$y\" ]]",
            "Regex with =~ does not quote the pattern: [[ $s =~ ^[0-9]+$ ]] works, but [[ $s =~ '^[0-9]+$' ]] matches literally",
            "The regex dialect for =~ is ERE (Extended Regular Expressions) from the system's C library, which varies by OS",
            "[[ does not support -a and -o -- use && and || between conditions instead",
        ],
        "related": ["[", "test", "if", "case"],
        "difficulty": "intermediate",
    },
    "ack": {
        "description": "Search files for patterns like grep but designed specifically for programmers, with built-in file type filtering and automatic VCS directory skipping. Use it for searching source code when you want smart defaults for programming projects.",
        "flags": {
            "-i": "Case-insensitive search",
            "-l": "Print only filenames containing matches",
            "-c": "Print only a count of matching lines per file",
            "-w": "Match whole words only",
            "--type": "Search only files of the specified type (e.g., --python, --js)",
            "--ignore-dir": "Ignore the specified directory during search",
            "-Q": "Treat the pattern as a literal string",
            "-v": "Invert match, showing non-matching lines",
            "-f": "List all files that would be searched (no pattern required)",
            "--sort-files": "Sort output by filename",
            "--color-match": "Set the color for matched text",
        },
        "common_patterns": ["ack pattern", "ack -i pattern", "ack --python 'import'", "ack -l TODO"],
        "man_url": "https://beyondgrep.com/documentation/",
        "use_cases": [
            "Search only in Python files with ack --python 'class.*Model'",
            "Find all files of a specific type with ack -f --perl to list Perl source files",
            "Search for a literal string containing regex metacharacters with ack -Q 'array[0]'",
        ],
        "gotchas": [
            "ack uses Perl-compatible regex by default -- regex like \\d, \\w, and lookahead work out of the box",
            "ack is slower than ripgrep (rg) for large codebases -- it remains useful for its Perl regex support and --type system",
            "ack ignores backup files, core dumps, and VCS directories by default -- use --noignore-directory to override",
        ],
        "related": ["rg", "ag", "grep", "fzf"],
        "difficulty": "beginner",
    },
    "ag": {
        "description": "Search files for matching patterns extremely fast, designed as a faster replacement for ack and grep with automatic gitignore awareness. Use it for quick code searches across large projects where speed matters.",
        "flags": {
            "-i": "Case-insensitive search",
            "-l": "Print only filenames containing matches",
            "-c": "Print only a count of matching lines per file",
            "-w": "Match whole words only",
            "-G": "Only search files whose names match the specified pattern",
            "--hidden": "Search hidden files and directories",
            "-Q": "Treat the pattern as a literal string, not a regex",
            "--depth": "Limit directory search depth",
            "-u": "Search all files, ignoring .gitignore and .ignore rules",
            "-U": "Search all files including binary files",
            "--stats": "Print stats about matches at the end",
        },
        "common_patterns": ["ag pattern", "ag -i pattern /path", "ag -l pattern", "ag -G '\\\\.py$' pattern"],
        "man_url": "https://github.com/ggreer/the_silver_searcher",
        "use_cases": [
            "Search a codebase for a function definition with ag 'def process_data' --python",
            "Find TODO comments across a project with ag TODO --ignore-dir=node_modules",
            "Search for a pattern only in specific file types with ag -G '\\.jsx?$' 'useState'",
        ],
        "gotchas": [
            "ag respects .gitignore by default -- files ignored by git will not appear in search results unless you use -u (unrestricted)",
            "ag uses PCRE regex by default, not basic regex -- metacharacters like ( and | work without escaping unlike grep",
            "ag has been largely superseded by ripgrep (rg) which is faster in most benchmarks -- consider rg for new workflows",
        ],
        "related": ["rg", "grep", "ack", "fzf"],
        "difficulty": "beginner",
    },
    "ansible": {
        "description": "An agentless automation tool that configures systems, deploys applications, and orchestrates complex IT workflows over SSH. You'd use it to manage infrastructure at scale with simple YAML playbooks instead of writing custom scripts for each server.",
        "flags": {
            "-i": "Specify the inventory file or host list",
            "-m": "Specify the module to execute on remote hosts",
            "-a": "Pass arguments to the module being executed",
            "-b": "Escalate privileges using become (sudo)",
            "-u": "Set the remote user for SSH connections",
            "-v": "Increase output verbosity (use -vvv for more detail)",
            "--check": "Run in dry-run mode without making actual changes",
            "--limit": "Restrict execution to a specific subset of hosts",
            "--diff": "Show file change diffs when modifying files on remote hosts",
            "--list-hosts": "List hosts that would be affected without executing",
            "--ask-become-pass": "Prompt for the privilege escalation (sudo) password",
        },
        "common_patterns": ["ansible all -m ping -i inventory.yml", "ansible-playbook -i hosts deploy.yml", "ansible webservers -m shell -a 'uptime' -b", "ansible-playbook site.yml --check --diff"],
        "man_url": "https://docs.ansible.com/ansible/latest/cli/ansible.html",
        "use_cases": [
            "Run a quick ad-hoc command on all servers with ansible all -m ping -i inventory.yml",
            "Deploy an application with ansible-playbook -i hosts deploy.yml",
            "Test changes without applying with ansible-playbook site.yml --check --diff",
        ],
        "gotchas": [
            "Ansible requires SSH access and Python on managed hosts -- hosts without Python need the raw or script modules",
            "YAML indentation matters -- a misplaced space can cause silent misconfiguration rather than an error",
            "ansible-playbook and ansible are different commands -- use ansible for ad-hoc tasks and ansible-playbook for playbook execution",
            "--check mode does not guarantee idempotency detection -- some modules do not support check mode and will skip",
        ],
        "related": ["terraform", "puppet", "chef", "ssh"],
        "difficulty": "intermediate",
    },
    "apk": {
        "description": "The Alpine Package Keeper used to manage packages on Alpine Linux, widely used in Docker containers. It is designed for simplicity and speed with a minimal footprint that makes it ideal for lightweight environments.",
        "flags": {
            "add": "Install one or more packages and their dependencies",
            "del": "Remove an installed package from the system",
            "update": "Update the package index from configured repositories",
            "upgrade": "Upgrade all installed packages to their latest available versions",
            "search": "Search the package index for packages matching a pattern",
            "info": "Display detailed information about a package",
            "--no-cache": "Install without using or updating the local package cache",
            "-s": "Simulate the operation without making any actual changes",
            "--virtual": "Create a virtual package for easy grouped removal",
            "-U": "Update repository indexes before operating",
        },
        "common_patterns": ["apk add package_name", "apk update && apk upgrade", "apk search pattern", "apk del package_name"],
        "man_url": "https://wiki.alpinelinux.org/wiki/Alpine_Package_Keeper",
        "use_cases": [
            "Install a package in an Alpine Docker container: apk add --no-cache curl",
            "Update package index and upgrade all packages: apk update && apk upgrade",
            "Search for available packages: apk search nginx",
            "Show info about a package: apk info -a nginx",
            "Remove a package: apk del nginx",
        ],
        "gotchas": [
            "Always use --no-cache in Dockerfiles to avoid storing the package index in the image layer, keeping images small",
            "Alpine uses musl libc instead of glibc, so some precompiled binaries from other distros will not work -- you may need to compile from source",
            "apk has no separate update+install step like apt; apk add always fetches the latest index unless you explicitly separate it",
        ],
        "related": ["apt", "dnf", "pacman"],
        "difficulty": "beginner",
    },
    "apropos": {
        "description": "Search the manual page descriptions for keywords and display matching man page names with their one-line summaries. Use it when you know what you want to do but cannot remember the command name.",
        "flags": {
            "-e": "Search for exact matches only",
            "-r": "Interpret the keyword as a regular expression (default)",
            "-w": "Interpret the keyword as a wildcard pattern containing shell-style globs",
            "-s": "Restrict the search to the specified manual section(s)",
            "-l": "Do not trim output to terminal width"
        },
        "common_patterns": ["apropos keyword", "apropos -e compress", "apropos -s 1 editor"],
        "man_url": "https://man7.org/linux/man-pages/man1/apropos.1.html",
        "use_cases": [
            "Find commands related to a concept with apropos compress to discover compression tools",
            "Search for disk-related commands with apropos partition to find fdisk, parted, etc.",
            "Discover all commands in a specific man section with apropos -s 8 network for admin network tools",
        ],
        "gotchas": [
            "apropos searches the whatis database which must be built first -- run sudo mandb if you get no results",
            "Results can be noisy -- use apropos -e for exact matches or combine with grep to narrow results",
            "apropos is equivalent to man -k -- they use the same database and return the same results",
        ],
        "related": ["whatis", "man", "info", "help"],
        "difficulty": "beginner",
    },
    "apt-cache": {
        "description": "A command-line tool for querying the APT package cache on Debian and Ubuntu systems. It searches package metadata, displays dependency information, and shows package details without modifying the system.",
        "flags": {
            "search": "Search package names and descriptions for a keyword",
            "show": "Display detailed information about a specific package",
            "depends": "List all dependencies required by a package",
            "rdepends": "List all packages that depend on a given package",
            "policy": "Show the installed and candidate versions of a package",
            "--names-only": "Restrict search to package names only, excluding descriptions",
            "--full": "Print full package records when searching",
            "pkgnames": "List all known package names optionally filtered by prefix",
            "madison": "Show available versions in a tabular format",
        },
        "common_patterns": ["apt-cache search keyword", "apt-cache show package_name", "apt-cache depends package_name", "apt-cache policy package_name"],
        "man_url": "https://manpages.debian.org/bookworm/apt/apt-cache.8.en.html",
        "use_cases": [
            "Search for available packages by keyword: apt-cache search web server",
            "Show all available versions of a package: apt-cache showpkg nginx",
            "Display dependencies of a package before installing: apt-cache depends nginx",
            "Find which packages depend on a given package: apt-cache rdepends libssl3",
            "Display package metadata including description and size: apt-cache show nginx",
        ],
        "gotchas": [
            "apt-cache searches the local package index, not the remote repositories -- run apt update first to get current results",
            "apt-cache search uses regex by default, so special characters like + in package names (e.g., g++) need escaping",
        ],
        "related": ["apt", "apt-get", "dpkg", "aptitude"],
        "difficulty": "beginner",
    },
    "apt-get": {
        "description": "The traditional command-line package handling utility for Debian and Ubuntu that installs, upgrades, and removes packages. It resolves dependencies automatically from configured repositories and is commonly used in scripts and automation.",
        "flags": {
            "install": "Install one or more packages and their dependencies",
            "remove": "Remove a package but keep its configuration files",
            "purge": "Remove a package along with all its configuration files",
            "update": "Download the latest package index from all configured sources",
            "upgrade": "Upgrade all installed packages to their latest versions",
            "autoremove": "Remove packages that were installed as dependencies and are no longer needed",
            "-y": "Automatically answer yes to all prompts during operations",
            "-f": "Attempt to fix a system with broken dependencies",
            "--only-upgrade": "Only upgrade already-installed packages, do not install new ones",
            "--no-install-recommends": "Do not install recommended packages",
            "--reinstall": "Reinstall packages that are already installed",
            "-d": "Download only, do not install or unpack",
            "--purge": "Remove packages and their configuration files",
        },
        "common_patterns": ["apt-get update && apt-get upgrade", "apt-get install package_name", "apt-get remove package_name", "apt-get autoremove"],
        "man_url": "https://manpages.debian.org/bookworm/apt/apt-get.8.en.html",
        "use_cases": [
            "Install a package non-interactively in a script: apt-get install -y nginx",
            "Upgrade all packages without removing anything: apt-get upgrade -y",
            "Full distribution upgrade that handles dependency changes: apt-get dist-upgrade",
            "Download package source code for inspection: apt-get source package-name",
            "Clean downloaded package cache to free disk space: apt-get clean",
        ],
        "gotchas": [
            "apt-get install will not upgrade already-installed packages to the latest version unless you explicitly pass --only-upgrade or run apt-get upgrade first",
            "apt-get dist-upgrade may remove packages to resolve dependency conflicts -- always review what it proposes before confirming",
            "The -y flag auto-confirms prompts, which is useful in scripts but dangerous if you have not reviewed the planned changes first",
        ],
        "related": ["apt", "apt-cache", "dpkg", "aptitude"],
        "difficulty": "beginner",
    },
    "ar": {
        "description": "A utility that creates, modifies, and extracts files from static library archives used by the linker. You'd use it to bundle multiple object files into a single .a library for linking into C/C++ programs.",
        "flags": {
            "r": "Insert or replace files in the archive, creating it if needed",
            "c": "Create the archive without a warning if it does not exist",
            "s": "Write or update the archive symbol table index",
            "t": "Display a table listing the contents of the archive",
            "x": "Extract files from the archive",
            "d": "Delete named files from the archive",
            "v": "Show verbose output during operations",
            "u": "Only replace files newer than the existing archive members"
        },
        "common_patterns": ["ar rcs libmylib.a obj1.o obj2.o", "ar t libmylib.a", "ar x libmylib.a", "ar d libmylib.a old_module.o"],
        "man_url": "https://sourceware.org/binutils/docs/binutils/ar.html",
        "use_cases": [
            "Create a static library from object files with ar rcs libmylib.a obj1.o obj2.o",
            "List contents of a static library with ar t libmylib.a",
            "Extract a specific object file from a library with ar x libmylib.a module.o",
        ],
        "gotchas": [
            "Always use 's' with 'r' (ar rcs) to create/update the symbol index -- without it the linker may not find symbols",
            "ar creates static libraries (.a) not shared libraries (.so) -- use gcc -shared for shared libraries",
            "The r flag replaces files in the archive, c suppresses the creation warning, and s creates the index -- rcs is the standard combination",
        ],
        "related": ["gcc", "ld", "nm", "ranlib"],
        "difficulty": "intermediate",
    },
    "arp": {
        "description": "Display and modify the kernel's ARP cache that maps IP addresses to MAC (hardware) addresses on the local network. Use it to diagnose network connectivity issues at the link layer or detect ARP spoofing attacks on your network.",
        "flags": {
            "-a": "Display all entries in the ARP table",
            "-d": "Delete an entry from the ARP table",
            "-s": "Manually set a static ARP entry",
            "-n": "Show numerical addresses instead of resolving hostnames",
            "-v": "Verbose output with additional details"
        },
        "common_patterns": ["arp -a", "arp -n", "sudo arp -d 192.168.1.100", "sudo arp -s 192.168.1.100 00:11:22:33:44:55"],
        "man_url": "https://man7.org/linux/man-pages/man8/arp.8.html",
        "use_cases": [
            "View the ARP cache to see MAC-to-IP mappings on the local network: arp -a",
            "Set a static ARP entry to prevent ARP spoofing for a critical gateway",
            "Diagnose duplicate IP addresses by checking for multiple MAC addresses",
        ],
        "gotchas": [
            "arp is deprecated; use ip neigh on modern systems",
            "The ARP cache has timeouts, so entries may disappear if not recently used",
            "Static ARP entries do not survive reboots unless configured in startup scripts",
        ],
        "related": ["arping", "ip", "ifconfig"],
        "difficulty": "intermediate",
    },
    "arping": {
        "description": "Send ARP request packets to a neighbor host on the local network to discover its MAC address or detect duplicate IP addresses. Use it to test layer-2 connectivity when ICMP ping is blocked by a firewall but ARP still works.",
        "flags": {
            "-c": "Stop after sending a specified number of packets",
            "-I": "Specify the network interface to send packets from",
            "-D": "Duplicate address detection mode",
            "-s": "Set the source IP address in the ARP request",
            "-w": "Set a timeout deadline in seconds"
        },
        "common_patterns": ["sudo arping -c 3 192.168.1.1", "sudo arping -I eth0 192.168.1.1", "sudo arping -D 192.168.1.100", "sudo arping -c 1 -I wlan0 10.0.0.1"],
        "man_url": "https://man7.org/linux/man-pages/man8/arping.8.html",
        "use_cases": [
            "Test layer-2 connectivity when ICMP ping is blocked by a firewall",
            "Detect duplicate IP addresses on a network with arping -D",
            "Discover the MAC address of a host on the local network",
        ],
        "gotchas": [
            "arping only works on the local network segment -- it cannot cross routers",
            "Requires root privileges to send raw ARP packets",
            "There are two different arping implementations (Thomas Habets and iputils) with slightly different flags",
        ],
        "related": ["arp", "ping", "ip"],
        "difficulty": "intermediate",
    },
    "as": {
        "description": "The GNU assembler that translates assembly language source files into machine code object files. You'd use it to assemble low-level code for operating systems, embedded systems, or performance-critical routines.",
        "flags": {
            "-o": "Specify the output object file name",
            "-a": "Enable assembly listing output with various sub-options",
            "-f": "Skip preprocessing for faster assembly of clean input",
            "-I": "Add a directory to the search path for .include directives",
            "-L": "Keep local symbols in the symbol table",
            "-v": "Print the assembler version number",
            "-W": "Suppress warning messages",
            "--fatal-warnings": "Treat all warnings as errors"
        },
        "common_patterns": ["as -o output.o source.s", "as -ahlms=listing.lst source.s", "as --gstabs -o debug.o source.s"],
        "man_url": "https://sourceware.org/binutils/docs/as/",
        "use_cases": [
            "Assemble an x86 assembly file with as -o output.o source.s",
            "Generate a listing file alongside assembly with as -ahlms=listing.lst source.s",
            "Assemble with debug information for gdb with as --gstabs -o debug.o source.s",
        ],
        "gotchas": [
            "as uses AT&T syntax by default on x86 where source comes before destination -- this is opposite to Intel/NASM syntax",
            "The assembler is architecture-specific -- cross-assembling requires a cross-compilation toolchain (e.g., aarch64-linux-gnu-as)",
            "as is usually invoked automatically by gcc when compiling .s or .S files -- direct use is mainly for OS development and embedded work",
        ],
        "related": ["gcc", "ld", "objdump", "gdb"],
        "difficulty": "advanced",
    },
    "at": {
        "description": "Schedule a one-time command or script to run at a specific time in the future using the at daemon. Use it when you need a job to execute once at a particular time rather than on a recurring schedule like cron.",
        "flags": {
            "-f": "Read commands from a file instead of standard input",
            "-l": "List pending jobs (alias for atq)",
            "-d": "Delete a scheduled job by number (alias for atrm)",
            "-m": "Send mail to the user when the job completes",
            "-v": "Show the time the job will be executed"
        },
        "common_patterns": ["echo 'backup.sh' | at 2am", "at -f script.sh now + 1 hour", "at -l", "at -d 5"],
        "man_url": "https://man7.org/linux/man-pages/man1/at.1.html",
        "use_cases": [
            "Schedule a one-time job: echo 'backup.sh' | at 2am tomorrow",
            "Run a command after a delay: echo 'reboot' | at now + 5 minutes",
            "List pending jobs: atq",
        ],
        "gotchas": [
            "at requires the atd daemon to be running -- check with systemctl status atd",
            "at jobs inherit the current environment but not terminal -- output goes to mail by default",
            "Time parsing is flexible but can be ambiguous -- always verify with atq after scheduling",
        ],
        "related": ["crontab", "batch", "sleep", "nohup"],
        "difficulty": "intermediate",
    },
    "atop": {
        "description": "An advanced interactive system and process monitor that logs resource usage over time and can replay historical data. Use it instead of top when you need persistent logging of system performance with the ability to investigate past bottlenecks.",
        "flags": {
            "-r": "Read and replay from a raw log file",
            "-w": "Write raw data to a log file for later analysis",
            "-b": "Begin display at a specified time when replaying",
            "-e": "End display at a specified time when replaying",
            "-1": "Show per-CPU statistics instead of averages"
        },
        "common_patterns": ["atop", "atop -r /var/log/atop/atop_20240101", "atop -w /tmp/atop.raw 10", "atop 5"],
        "man_url": "https://man7.org/linux/man-pages/man1/atop.1.html",
        "use_cases": [
            "Investigate past performance issues by replaying historical logs: atop -r /var/log/atop/atop_20240115",
            "Identify the process that caused a CPU spike last night by scrubbing through recorded data",
            "Monitor disk I/O per process to find which application is thrashing storage",
        ],
        "gotchas": [
            "atop writes to /var/log/atop by default; these log files can grow large and should be rotated",
            "The atop daemon must be running to record historical data; install and enable the atop service",
            "Use t and T keys to navigate forward/backward through time intervals when replaying logs",
        ],
        "related": ["top", "htop", "sar", "iostat"],
        "difficulty": "intermediate",
    },
    "autoconf": {
        "description": "A tool that generates portable configure scripts from template files using M4 macros for GNU build system projects. You'd use it when creating distributable open-source packages that need to detect system capabilities before building.",
        "flags": {
            "--force": "Remake all output files even if they are newer than sources",
            "--install": "Install missing auxiliary files like install-sh and config.guess",
            "--verbose": "Print names of directories being examined and commands run",
            "--warnings": "Control which warnings are reported during processing",
            "-o": "Specify the output file name instead of the default"
        },
        "common_patterns": ["autoconf", "autoreconf --install --verbose --force", "autoconf configure.ac > configure", "autoreconf -fiv"],
        "man_url": "https://www.gnu.org/software/autoconf/manual/autoconf.html",
        "use_cases": [
            "Generate a configure script from configure.ac with autoreconf --install",
            "Regenerate all autotools files after modifying configure.ac with autoreconf -fiv",
            "Create a portable build system for distributable open-source packages",
        ],
        "gotchas": [
            "autoconf is typically used through autoreconf which runs autoconf, automake, aclocal, and other tools in the correct order",
            "configure.ac uses M4 macro language which has unusual quoting rules -- use [ ] for quoting, not single or double quotes",
            "The autotools toolchain (autoconf + automake + libtool) has a steep learning curve -- CMake or Meson are simpler alternatives for new projects",
        ],
        "related": ["automake", "make", "cmake", "meson"],
        "difficulty": "advanced",
    },
    "automake": {
        "description": "A tool that generates portable Makefile.in templates from high-level Makefile.am descriptions for the GNU build system. You'd use it alongside autoconf to create standardized build systems for distributable open-source software projects.",
        "flags": {
            "--add-missing": "Install missing auxiliary files like depcomp and compile",
            "--copy": "Copy missing files instead of creating symbolic links",
            "--foreign": "Set foreign strictness, relaxing GNU project requirements",
            "--force-missing": "Force overwrite of existing auxiliary files",
            "--warnings": "Control which categories of warnings are reported",
            "-v": "Enable verbose output showing processed files"
        },
        "common_patterns": ["automake --add-missing --copy", "automake --foreign", "automake --add-missing --force-missing", "aclocal && automake --add-missing"],
        "man_url": "https://www.gnu.org/software/automake/manual/automake.html",
        "use_cases": [
            "Generate Makefile.in templates from Makefile.am files with automake --add-missing",
            "Set up the standard GNU build system with aclocal && automake --add-missing && autoconf",
            "Create a distribution tarball with make dist after automake setup",
        ],
        "gotchas": [
            "Makefile.am files use a special syntax that is not regular Makefile syntax -- variables like bin_PROGRAMS and _SOURCES follow automake naming conventions",
            "automake --foreign relaxes GNU strictness requirements -- without it, automake expects NEWS, README, AUTHORS, ChangeLog files to exist",
            "automake must be run after aclocal and before autoconf -- the order matters and is why autoreconf exists",
        ],
        "related": ["autoconf", "make", "cmake"],
        "difficulty": "advanced",
    },
    "batch": {
        "description": "Schedule commands to execute when system load average drops below a threshold (typically 1.5), queuing resource-intensive work for when the system is idle. Use it instead of at when you want tasks to run during low-load periods rather than at a specific time.",
        "flags": {
            "-f": "Read commands from a file instead of standard input",
            "-m": "Send mail to the user when the job completes",
            "-v": "Show the time the job will be executed"
        },
        "common_patterns": ["echo './heavy_script.sh' | batch", "batch -f commands.txt", "batch <<< 'make -j4'"],
        "man_url": "https://man7.org/linux/man-pages/man1/batch.1.html",
        "use_cases": [
            "Run a CPU-intensive job when system load drops: echo './compile.sh' | batch",
            "Queue multiple jobs to run sequentially during idle time",
            "Schedule resource-heavy tasks without impacting interactive users",
        ],
        "gotchas": [
            "batch waits until load average drops below 0.8 (or configured threshold) -- jobs may wait indefinitely on busy systems",
            "Like at, batch requires the atd daemon to be running",
            "Output is mailed to the user unless redirected -- check mail or redirect in the script",
        ],
        "related": ["at", "nice", "nohup", "crontab"],
        "difficulty": "intermediate",
    },
    "bind": {
        "description": "Display or modify readline key bindings and configuration that control command-line editing behavior in the interactive shell. Use it to customize keyboard shortcuts, change editing modes between emacs and vi, or load readline configuration.",
        "flags": {
            "-p": "Print all readline function names and their key bindings in a reusable format",
            "-l": "List the names of all available readline functions",
            "-m": "Set the readline keymap (emacs, vi, vi-insert, vi-command)",
            "-q": "Query which keys invoke a specified function",
            "-f": "Read key bindings from a file",
            "-x": "List key sequences bound to shell commands",
            "-V": "List current readline variable names and their values"
        },
        "common_patterns": ["bind -p", "bind -l", "bind -m vi", "bind '\"\\\\e[A\": history-search-backward'"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "use_cases": [
            "Enable vi editing mode: bind -m vi",
            "Bind up-arrow to history search: bind '\"\\e[A\": history-search-backward'",
            "List all current key bindings: bind -p",
            "List all available readline functions: bind -l",
            "Load bindings from an inputrc file: bind -f ~/.inputrc",
        ],
        "gotchas": [
            "bind changes only affect the current shell session unless saved in ~/.inputrc",
            "Key binding syntax uses readline notation, which differs from terminal escape codes",
            "bind -x bindings run as shell commands, which can slow down interactive response if complex",
            "Binding conflicts with terminal emulator shortcuts may cause bindings to not work as expected",
        ],
        "related": ["set", "shopt", "history"],
        "difficulty": "advanced",
    },
    "blkid": {
        "description": "Locate and print block device attributes such as UUID, filesystem type, and label for all or specified devices. You use blkid to identify partitions by UUID for /etc/fstab entries or to determine what filesystem type a device contains.",
        "flags": {
            "-o": "Output format: full, value, list, device, udev, or export",
            "-s": "Show only the specified tag (e.g., UUID, TYPE, LABEL)",
            "-t": "Search for devices matching a NAME=value token (e.g., TYPE=ext4)",
            "-l": "Look up only one device matching the search parameter",
            "-p": "Low-level superblock probing mode, bypassing the cache",
            "-k": "List all known filesystem and RAID types and exit"
        },
        "common_patterns": ["sudo blkid", "blkid /dev/sda1", "blkid -s UUID -o value /dev/sda1"],
        "man_url": "https://man7.org/linux/man-pages/man8/blkid.8.html",
        "use_cases": [
            "Show UUIDs and filesystem types for all block devices: blkid",
            "Find the UUID of a partition for use in /etc/fstab",
            "Identify filesystem type on a specific device: blkid /dev/sda1",
        ],
        "gotchas": [
            "Requires root to probe all devices; non-root sees limited info",
            "Cached results may be stale; use -p to force fresh probing",
        ],
        "related": ["lsblk", "fdisk", "mount"],
        "difficulty": "intermediate",
    },
    "break": {
        "description": "Exit from an enclosing for, while, or until loop immediately, continuing execution after the loop. Use it to terminate a loop early when a condition is met, such as finding a match or encountering an error.",
        "flags": {},
        "common_patterns": ["break", "break 2", "[[ condition ]] && break"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Exit a loop when a condition is met: [[ $found == true ]] && break",
            "Break out of nested loops: break 2 exits both inner and outer loop",
            "Stop processing after finding a match in a for loop",
        ],
        "gotchas": [
            "break N exits N levels of nested loops -- break 2 exits two loops, not one",
            "break outside a loop causes an error in strict shells and a warning in bash",
            "break in a case statement inside a loop exits the loop, not the case (case uses ;; to end each pattern)",
        ],
        "related": ["continue", "return", "exit"],
        "difficulty": "beginner",
    },
    "broot": {
        "description": "An interactive tree-based file explorer that lets you navigate and search a directory tree with fuzzy matching in a compact display. Use it when you need to visually explore large directory structures, find files quickly, or navigate to deeply nested paths.",
        "flags": {
            "-s": "Show file sizes",
            "-d": "Show dates",
            "-p": "Show permissions",
            "-h": "Show hidden files",
            "--cmd": "Execute a broot command or verb on launch",
            "-w": "Set the number of columns for whale mode (disk usage)",
            "-g": "Show git status for files",
            "--sort-by-date": "Sort entries by modification date",
            "--sort-by-size": "Sort entries by size",
        },
        "common_patterns": ["broot", "broot -s /path", "broot --cmd ':open'"],
        "man_url": "https://dystroy.org/broot/",
        "use_cases": [
            "Explore a large codebase interactively by typing to fuzzy-filter the tree view",
            "Find and navigate to deeply nested files without typing full paths",
            "View disk usage in a tree with broot -w to identify large directories",
        ],
        "gotchas": [
            "broot requires a shell function (br) for cd-on-quit behavior -- run broot --install to set it up, then use br instead of broot",
            "First launch creates a configuration file at ~/.config/broot/conf.hjson -- customize verbs and key bindings there",
            "broot may appear unfamiliar at first -- type text to filter, use arrow keys to navigate, and press Enter to open or Alt+Enter to cd",
        ],
        "related": ["tree", "ranger", "nnn", "fzf"],
        "difficulty": "intermediate",
    },
    "builtin": {
        "description": "Execute a shell builtin command directly, bypassing any function or alias with the same name. Use it inside a function that overrides a builtin to call the original builtin behavior without infinite recursion.",
        "flags": {},
        "common_patterns": ["builtin cd /path", "builtin echo 'text'", "builtin pwd"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "use_cases": [
            "Call the real cd from inside a cd wrapper function: builtin cd \"$dir\"",
            "Force use of bash's echo instead of /bin/echo: builtin echo 'text'",
            "Avoid infinite recursion when overriding a builtin with a function of the same name",
        ],
        "gotchas": [
            "If the specified name is not a shell builtin, builtin returns a non-zero exit status",
            "builtin bypasses functions and aliases but NOT shell keywords (like if, for, while)",
            "Only works for actual builtins -- for external commands, use command instead",
        ],
        "related": ["command", "enable", "type", "alias"],
        "difficulty": "intermediate",
    },
    "bun": {
        "description": "An all-in-one JavaScript runtime and toolkit that includes a package manager, bundler, and test runner. It is designed as a faster drop-in replacement for Node.js and npm with native TypeScript support.",
        "flags": {
            "install": "Install all dependencies listed in package.json",
            "add": "Add a new dependency to the project",
            "remove": "Remove a dependency from the project",
            "run": "Execute a script defined in package.json or run a file",
            "test": "Run unit tests using the built-in test runner",
            "-d": "Add a package as a development dependency",
            "-g": "Install a package globally for system-wide use",
            "--frozen-lockfile": "Fail if the lockfile would need to be updated",
            "update": "Update dependencies to the latest compatible versions",
            "link": "Link a local package for development",
            "pm": "Package manager subcommands (cache, ls, hash)",
            "x": "Execute a package (like npx)",
            "--hot": "Enable hot reloading for development server",
        },
        "common_patterns": ["bun install", "bun add package_name", "bun run start", "bun test"],
        "man_url": "https://bun.sh/docs",
        "use_cases": [
            "Install all project dependencies (fast): bun install",
            "Add a dependency: bun add express",
            "Run a TypeScript file directly without compilation: bun run index.ts",
            "Run tests with the built-in test runner: bun test",
            "Initialize a new project: bun init",
        ],
        "gotchas": [
            "Bun is not 100% Node.js compatible -- some Node.js APIs and native modules may behave differently or be missing; check compatibility before migrating production code",
            "Bun uses its own bun.lockb binary lockfile which is not interchangeable with package-lock.json or yarn.lock",
            "bun run interprets .ts files natively, so TypeScript errors may appear that tsc would catch differently -- Bun transpiles rather than type-checks",
        ],
        "related": ["npm", "yarn", "pnpm", "npx"],
        "difficulty": "beginner",
    },
    "bundle": {
        "description": "The Ruby dependency manager that ensures a consistent set of gems are used across environments. It reads the Gemfile to resolve and install the exact gem versions specified or locked in Gemfile.lock.",
        "flags": {
            "install": "Install all gems specified in the Gemfile",
            "update": "Update gems to the latest versions allowed by the Gemfile",
            "exec": "Execute a command in the context of the bundle",
            "add": "Add a gem to the Gemfile and install it",
            "--without": "Exclude gems belonging to specified groups from installation",
            "--deployment": "Install gems in deployment mode with strict lockfile checking",
            "--path": "Set the directory where gems will be installed",
            "--jobs": "Set the number of parallel gem installation jobs",
            "config": "Manage bundler configuration",
            "outdated": "List gems with newer versions available",
        },
        "common_patterns": ["bundle install", "bundle exec rake test", "bundle update gem_name", "bundle add gem_name"],
        "man_url": "https://bundler.io/man/bundle.1.html",
        "use_cases": [
            "Install all gems listed in the Gemfile: bundle install",
            "Execute a command in the context of the bundle: bundle exec rails server",
            "Update all gems to latest allowed versions: bundle update",
            "Add a gem to the Gemfile and install it: bundle add nokogiri",
            "Generate a Gemfile.lock for reproducible installs: bundle lock",
        ],
        "gotchas": [
            "Always use bundle exec to run project commands (e.g., bundle exec rake) to ensure the correct gem versions are loaded from Gemfile.lock",
            "bundle install in deployment mode (--deployment) installs to vendor/bundle and is strict about the lockfile -- this is what CI/CD should use",
            "Gemfile.lock must be committed to version control for applications (not for libraries) to ensure reproducible builds",
        ],
        "related": ["gem", "ruby", "rbenv"],
        "difficulty": "intermediate",
    },
    "bunzip2": {
        "description": "Decompress files compressed with bzip2, restoring them to their original form. You use bunzip2 to extract .bz2 archives, which offer better compression ratios than gzip at the cost of slower speed.",
        "flags": {
            "-k": "Keep the original .bz2 file after decompression instead of deleting it",
            "-f": "Force overwrite of existing output files",
            "-v": "Verbose mode showing compression ratio and details",
            "-s": "Use less memory during decompression (about half) at the cost of speed",
            "-t": "Test file integrity without actually decompressing",
            "-c": "Decompress to standard output, leaving the original file unchanged"
        },
        "common_patterns": ["bunzip2 archive.bz2", "bunzip2 -k archive.bz2", "bunzip2 -v *.bz2"],
        "man_url": "https://sourceware.org/bzip2/manual/manual.html",
        "use_cases": [
            "Decompress a .bz2 file: bunzip2 file.txt.bz2",
            "Decompress and keep the original: bunzip2 -k file.txt.bz2",
            "Decompress to stdout for piping: bunzip2 -c file.bz2 | grep pattern",
        ],
        "gotchas": [
            "bunzip2 is equivalent to bzip2 -d -- they are the same program",
            "bunzip2 removes the .bz2 file after decompression by default -- use -k to keep it",
        ],
        "related": ["bzip2", "bzcat", "gunzip", "unxz"],
        "difficulty": "beginner",
    },
    "byobu": {
        "description": "A user-friendly wrapper around tmux or screen that provides enhanced profiles, keybindings, and status notifications out of the box. Use it when you want terminal multiplexing with a more accessible interface than raw tmux, especially on Ubuntu servers.",
        "flags": {
            "-S": "Name the session",
            "-r": "Reattach to a running session",
            "-list": "List running sessions",
            "-D": "Force detach and reattach",
            "--version": "Show version information"
        },
        "common_patterns": ["byobu", "byobu -S mywork", "byobu -list", "byobu -r"],
        "man_url": "https://www.byobu.org/documentation",
        "use_cases": [
            "Get a pre-configured tmux experience with status bar and keybindings out of the box",
            "Use function keys (F2 for new window, F3/F4 to switch) instead of memorizing tmux prefix commands",
        ],
        "gotchas": [
            "byobu wraps either tmux or screen depending on configuration; check which backend is active with byobu-select-backend",
            "Function key bindings may conflict with your terminal emulator's shortcuts",
        ],
        "related": ["tmux", "screen"],
        "difficulty": "beginner",
    },
    "bzcat": {
        "description": "Display the contents of bzip2-compressed files on standard output without permanently decompressing them. You use bzcat to inspect or pipe bzip2 archives into other commands without creating uncompressed temporary files.",
        "flags": {
            "-s": "Use less memory during decompression at the cost of speed",
            "-k": "Keep the original compressed file (default behavior for bzcat)",
            "-q": "Suppress non-critical error messages",
            "-v": "Verbose mode showing compression details"
        },
        "common_patterns": ["bzcat file.bz2", "bzcat archive.bz2 | grep 'pattern'", "bzcat data.bz2 | head -100"],
        "man_url": "https://sourceware.org/bzip2/manual/manual.html",
        "use_cases": [
            "View a bzip2-compressed file without decompressing: bzcat file.bz2",
            "Pipe compressed data to another command: bzcat data.bz2 | sort | uniq",
        ],
        "gotchas": [
            "bzcat is equivalent to bzip2 -dc -- it decompresses to stdout without modifying the original file",
        ],
        "related": ["bzip2", "bunzip2", "zcat", "xzcat"],
        "difficulty": "beginner",
    },
    "cc": {
        "description": "The system C compiler command that is typically a symbolic link to GCC or Clang on modern Unix and Linux systems. You'd use it to compile C source code into executables, as it provides a portable way to invoke whichever C compiler is installed.",
        "flags": {
            "-o": "Specify the output executable file name",
            "-c": "Compile source files to object files without linking",
            "-g": "Include debugging information for use with gdb",
            "-O2": "Enable standard optimization for better runtime performance",
            "-Wall": "Enable all common warning messages",
            "-I": "Add a directory to the header file search path",
            "-l": "Link against the specified library",
            "-L": "Add a directory to the library search path"
        },
        "common_patterns": ["cc -o program main.c", "cc -c -Wall -g source.c", "cc -O2 -o app main.c utils.c -lm", "cc -I./include -L./lib -o app main.c -lmylib"],
        "man_url": "https://man7.org/linux/man-pages/man1/cc.1p.html",
        "use_cases": [
            "Compile a portable C program with cc -o program main.c as a system-agnostic compiler invocation",
            "Use in Makefiles and configure scripts as the default compiler name that works on any Unix system",
        ],
        "gotchas": [
            "cc is a symlink to the system default C compiler -- it may be gcc, clang, or another compiler depending on the OS",
            "On macOS cc points to clang, on most Linux systems cc points to gcc -- check with cc --version",
            "Using cc instead of gcc or clang in build scripts improves portability across Unix-like systems",
        ],
        "related": ["gcc", "clang", "make"],
        "difficulty": "beginner",
    },
    "certbot": {
        "description": "Obtain and manage free SSL/TLS certificates from Let's Encrypt by automatically proving domain ownership and configuring web servers. Use it to enable HTTPS on your websites with auto-renewable certificates that eliminate the cost and hassle of manual certificate management.",
        "flags": {
            "certonly": "Obtain a certificate without installing it",
            "--webroot": "Prove domain ownership using an existing web server's document root",
            "--standalone": "Run a temporary standalone web server for domain verification",
            "--nginx": "Automatically configure Nginx with the certificate",
            "--apache": "Automatically configure Apache with the certificate",
            "-d": "Specify domain name(s) to include in the certificate",
            "renew": "Renew all certificates that are near expiry",
            "--dry-run": "Test the certificate process without saving anything",
            "--staging": "Use the staging server to avoid rate limits during testing",
        },
        "common_patterns": ["sudo certbot --nginx -d example.com", "sudo certbot certonly --standalone -d example.com", "sudo certbot renew --dry-run", "sudo certbot renew"],
        "man_url": "https://eff-certbot.readthedocs.io/en/latest/",
        "use_cases": [
            "Obtain a free TLS certificate: certbot --nginx -d example.com",
            "Renew all certificates: certbot renew",
            "Test renewal without changing anything: certbot renew --dry-run",
        ],
        "gotchas": [
            "Certificates expire every 90 days -- set up auto-renewal via cron or systemd timer",
            "Port 80 or 443 must be accessible for HTTP-01 or TLS-ALPN-01 validation",
            "Rate limits apply -- avoid repeated requests for the same domain during testing (use --staging)",
        ],
        "related": ["openssl", "nginx", "apache2", "acme.sh"],
        "difficulty": "intermediate",
    },
    "chef": {
        "description": "A configuration management platform that uses Ruby-based recipes and cookbooks to automate infrastructure provisioning and maintenance. You'd use it with the knife CLI to manage nodes, upload cookbooks, and maintain consistent server configurations across your fleet.",
        "flags": {
            "-c": "Specify the path to the knife configuration file",
            "-u": "Set the user name for API client authentication",
            "-s": "Specify the Chef server URL",
            "-z": "Run in local mode against the local chef-repo instead of a server",
            "-y": "Automatically confirm all prompts without asking",
            "-V": "Enable verbose output, use -VV for maximum verbosity",
            "-F": "Set the output format (summary, text, json, yaml)"
        },
        "common_patterns": ["knife cookbook upload myapp", "knife node list", "knife ssh 'role:web' 'sudo chef-client'", "chef-client --runlist 'recipe[nginx]'"],
        "man_url": "https://docs.chef.io/workstation/knife/",
        "use_cases": [
            "Apply a recipe locally for testing with chef-client --local-mode -r 'recipe[mycookbook]'",
            "Upload a cookbook to the Chef server with knife cookbook upload mycookbook",
            "List managed nodes with knife node list",
        ],
        "gotchas": [
            "Chef uses Ruby for cookbooks which has a steeper learning curve than Ansible's YAML -- Ruby syntax errors in recipes can be hard to debug",
            "chef-client runs require a Chef Server or chef-zero for local mode -- the architecture is more complex than agentless tools like Ansible",
            "The knife CLI is part of Chef Workstation, not Chef Client -- install Chef Workstation on your development machine",
        ],
        "related": ["ansible", "puppet", "terraform"],
        "difficulty": "advanced",
    },
    "chpasswd": {
        "description": "Update passwords for one or more user accounts in batch mode by reading username:password pairs from standard input. Use it for scripted or bulk password changes, such as provisioning multiple accounts at once.",
        "flags": {
            "-e": "Treat supplied passwords as already encrypted",
            "-c": "Specify the encryption method (DES, MD5, SHA256, SHA512)",
            "-m": "Use MD5 encryption instead of the default",
            "-s": "Specify the minimum and maximum password length"
        },
        "common_patterns": ["echo 'user:newpass' | chpasswd", "chpasswd < passwords.txt", "echo 'user:newpass' | chpasswd -e"],
        "man_url": "https://man7.org/linux/man-pages/man8/chpasswd.8.html",
        "use_cases": [
            "Batch-set passwords from a file: echo 'user:newpass' | chpasswd",
            "Set encrypted passwords: chpasswd -e < hashed_passwords.txt",
            "Automate user provisioning in scripts",
        ],
        "gotchas": [
            "Passwords on stdin are in cleartext unless -e is used -- secure the input source",
            "Must be run as root",
            "Input format is strictly username:password, one per line",
        ],
        "related": ["passwd", "useradd", "usermod", "openssl"],
        "difficulty": "advanced",
    },
    "chroot": {
        "description": "Run a command or interactive shell with a different root directory, effectively isolating the process from the rest of the filesystem. Use it for system recovery, building packages in a clean environment, or creating lightweight sandboxes.",
        "flags": {
            "--userspec": "Specify user and group (USER:GROUP) to run the command as",
            "--groups": "Specify supplementary groups for the new process",
            "--skip-chdir": "Do not change the working directory to / after changing root"
        },
        "common_patterns": ["chroot /mnt/sysroot /bin/bash", "sudo chroot /path/to/newroot", "chroot --userspec=user:group /newroot command"],
        "man_url": "https://man7.org/linux/man-pages/man1/chroot.1.html",
        "use_cases": [
            "Run a command in an isolated root filesystem: chroot /mnt/sysimage /bin/bash",
            "Repair a broken system from a live CD by chrooting into the installed root",
            "Create a minimal sandbox for building or testing software",
        ],
        "gotchas": [
            "chroot is NOT a security sandbox -- processes can escape with root access; use namespaces or containers instead",
            "The chroot environment needs all required libraries and binaries (use ldd to check dependencies)",
            "Must be run as root and requires a functional filesystem tree at the target path",
        ],
        "related": ["unshare", "nsenter", "docker", "pivot_root"],
        "difficulty": "advanced",
    },
    "clang": {
        "description": "The LLVM C/C++/Objective-C compiler that offers fast compilation, expressive diagnostics, and excellent standards compliance. You'd use it as an alternative to GCC for building C and Objective-C code, especially on macOS where it is the default compiler.",
        "flags": {
            "-o": "Specify the output file name",
            "-c": "Compile source files to object files without linking",
            "-O0": "Disable optimizations for fastest compilation and best debugging",
            "-O2": "Enable standard optimizations for production builds",
            "-g": "Generate debug information for use with debuggers",
            "-Wall": "Enable all common warning messages",
            "-std": "Set the language standard (c11, c17, c2x)",
            "-fsanitize": "Enable runtime sanitizers (address, undefined, thread)"
        },
        "common_patterns": ["clang -o program main.c", "clang -Wall -Wextra -std=c17 -o app main.c", "clang -g -fsanitize=address -o test test.c", "clang -O2 -c module.c"],
        "man_url": "https://clang.llvm.org/docs/ClangCommandLineReference.html",
        "use_cases": [
            "Compile with AddressSanitizer for catching buffer overflows with clang -fsanitize=address -g -o test test.c",
            "Get detailed error messages with clang -Wall -Wextra -std=c17 -o app main.c",
            "Cross-compile for a different target with clang --target=aarch64-linux-gnu -o app main.c",
        ],
        "gotchas": [
            "clang error messages are generally more readable than gcc's -- clang is often preferred for development even if gcc is used for release builds",
            "clang's ABI is compatible with gcc on Linux but some edge cases differ -- test with both compilers in CI",
            "On macOS, the cc and gcc commands are actually clang in disguise -- check with cc --version",
        ],
        "related": ["clang++", "gcc", "lldb", "make"],
        "difficulty": "intermediate",
    },
    "clang++": {
        "description": "The LLVM C++ compiler frontend that compiles C++ source code with modern standards support and detailed error messages. You'd use it as an alternative to g++ for C++ development, especially on macOS or when using LLVM-specific sanitizers and tooling.",
        "flags": {
            "-o": "Specify the output file name",
            "-c": "Compile to object files without linking",
            "-std": "Set the C++ language standard (c++14, c++17, c++20, c++23)",
            "-O2": "Enable standard optimizations for production code",
            "-g": "Generate debug information for use with lldb or gdb",
            "-Wall": "Enable all common warning messages about potential issues",
            "-stdlib": "Select the C++ standard library implementation (libc++, libstdc++)",
            "-fsanitize": "Enable runtime sanitizers (address, undefined, memory, thread)"
        },
        "common_patterns": ["clang++ -o program main.cpp", "clang++ -std=c++20 -Wall -Wextra -o app main.cpp", "clang++ -g -fsanitize=address,undefined -o test test.cpp", "clang++ -O2 -stdlib=libc++ -o app main.cpp"],
        "man_url": "https://clang.llvm.org/docs/ClangCommandLineReference.html",
        "use_cases": [
            "Compile modern C++20 code with clang++ -std=c++20 -Wall -o app main.cpp",
            "Use clang++ with libc++ instead of libstdc++ with clang++ -stdlib=libc++ -o app main.cpp",
            "Run UndefinedBehaviorSanitizer to catch UB at runtime with clang++ -fsanitize=undefined -g -o test test.cpp",
        ],
        "gotchas": [
            "clang++ defaults to libstdc++ on Linux but libc++ on macOS -- this can cause ABI incompatibility when mixing libraries compiled with different standard libraries",
            "clang++ may produce different warnings than g++ -- enable both in CI for maximum bug detection",
        ],
        "related": ["clang", "g++", "lldb", "cmake"],
        "difficulty": "intermediate",
    },
    "cmake": {
        "description": "A cross-platform build system generator that produces native makefiles and project files from platform-independent configuration. You'd use it to manage C/C++ project builds across different operating systems and compilers.",
        "flags": {
            "-S": "Specify the path to the source directory",
            "-B": "Specify the path to the build directory",
            "-D": "Set a cache variable such as CMAKE_BUILD_TYPE",
            "-G": "Specify the build system generator (Unix Makefiles, Ninja)",
            "--build": "Build the project in the specified build directory",
            "--install": "Install the built project to the prefix directory",
            "--target": "Build a specific target instead of the default",
            "-j": "Set the number of parallel build jobs",
            "--preset": "Use a named preset from CMakePresets.json",
            "-Wdev": "Enable developer warnings",
            "--fresh": "Configure a fresh build tree, removing any existing cache",
        },
        "common_patterns": ["cmake -S . -B build", "cmake -DCMAKE_BUILD_TYPE=Release -S . -B build", "cmake --build build -j$(nproc)", "cmake --install build --prefix /usr/local"],
        "man_url": "https://cmake.org/cmake/help/latest/manual/cmake.1.html",
        "use_cases": [
            "Configure an out-of-source build with cmake -S . -B build to keep source tree clean",
            "Build a release configuration with cmake -DCMAKE_BUILD_TYPE=Release -S . -B build",
            "Build the project after configuration with cmake --build build -j$(nproc)",
            "Install after building with cmake --install build --prefix /usr/local",
        ],
        "gotchas": [
            "CMake generates build files but does not build -- you need to run the generated build system (make, ninja) or use cmake --build",
            "CMake caches variables in CMakeCache.txt -- if you change a -D option and it does not take effect, delete the cache or the build directory",
            "The minimum CMake version in cmake_minimum_required affects available features -- old minimum versions may disable modern CMake features",
            "Prefer cmake --build build over cd build && make because it works regardless of the generator (Make, Ninja, VS)",
        ],
        "related": ["make", "ninja", "gcc", "clang"],
        "difficulty": "intermediate",
    },
    "cmp": {
        "description": "Compare two files byte by byte and report the location of the first difference found. You use cmp for binary file comparison or when you only need to know whether two files differ, since it is faster than diff for simple equality checks.",
        "flags": {
            "-b": "Print the differing bytes as characters",
            "-l": "Print the byte offset and differing byte values for every difference",
            "-s": "Silent mode: output nothing, return exit status only (0=same, 1=differ)",
            "-n": "Compare at most the specified number of bytes",
            "-i": "Skip the specified number of bytes at the start of each file"
        },
        "common_patterns": ["cmp file1 file2", "cmp -s file1 file2 && echo 'identical'", "cmp -l file1 file2"],
        "man_url": "https://man7.org/linux/man-pages/man1/cmp.1.html",
        "use_cases": [
            "Check if two binary files are identical: cmp file1.bin file2.bin",
            "Find the first differing byte: cmp -l original.bin modified.bin",
            "Silent comparison for scripting: cmp -s a.bin b.bin && echo same",
        ],
        "gotchas": [
            "cmp compares bytes, not lines -- use diff for human-readable text comparison",
            "cmp stops at the first difference by default -- use -l to list all differing bytes",
        ],
        "related": ["diff", "md5sum", "sha256sum", "comm"],
        "difficulty": "beginner",
    },
    "code": {
        "description": "The Visual Studio Code command-line interface for launching the editor, opening files, managing extensions, and comparing files. You'd use it to open projects from the terminal, install extensions, or diff files without leaving the command line.",
        "flags": {
            "--new-window": "Force opening a new VS Code window",
            "--reuse-window": "Open files in the most recently active window",
            "--diff": "Open a side-by-side diff view comparing two files",
            "--goto": "Open a file at a specific line and optional column",
            "--install-extension": "Install a VS Code extension by its identifier",
            "--list-extensions": "List all currently installed extensions",
            "--user-data-dir": "Use a custom directory for user data and settings",
            "--profile": "Open VS Code with a specific settings profile",
            "--wait": "Wait for file to be closed before returning (for git editor use)",
            "-r": "Reuse the most recently used window",
            "--locale": "Set the display language (e.g., en, zh-cn)",
        },
        "common_patterns": ["code .", "code --diff file1.js file2.js", "code --goto main.py:42", "code --install-extension ms-python.python"],
        "man_url": "https://code.visualstudio.com/docs/editor/command-line",
        "use_cases": [
            "Open the current directory in VS Code with code .",
            "Open a file at a specific line with code --goto main.py:42",
            "Compare two files side by side with code --diff old.js new.js",
            "Install an extension from the command line with code --install-extension ms-python.python",
        ],
        "gotchas": [
            "The code command must be installed into PATH on macOS -- open VS Code and run 'Shell Command: Install code command' from the command palette",
            "code --wait is needed for use as a git editor or merge tool -- without it git does not wait for you to close the file",
            "Running code . in WSL opens VS Code with the Remote-WSL extension -- this is by design but can confuse first-time WSL users",
        ],
        "related": ["vim", "nvim", "nano", "emacs"],
        "difficulty": "beginner",
    },
    "command": {
        "description": "Execute a command bypassing any shell functions or aliases with the same name, or identify how a name would be interpreted. Use it in scripts to ensure you run the actual external binary rather than a user-defined function or alias.",
        "flags": {
            "-v": "Print the pathname or type of the command (like which)",
            "-V": "Print a verbose description of how the command would be interpreted",
            "-p": "Use a default PATH to search for the command, ignoring custom PATH settings"
        },
        "common_patterns": ["command -v git", "command ls", "command -V cd", "command -p ls"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "use_cases": [
            "Check if a command exists: command -v git >/dev/null 2>&1 && echo 'git found'",
            "Bypass a function or alias: command ls (runs /bin/ls, not an alias)",
            "POSIX-portable alternative to which: command -v python3",
            "Inside a function overriding an external command, call the real one: command grep pattern file",
        ],
        "gotchas": [
            "command -v is preferred over which because which is not POSIX and behaves differently across systems",
            "command bypasses functions and aliases but still runs builtins -- use the external path directly to avoid builtins",
            "command -v returns the path for external commands, 'builtin' for builtins, and 'alias ...' for aliases",
            "command -p uses a default system PATH, which may differ from your custom PATH",
        ],
        "related": ["builtin", "type", "which", "enable"],
        "difficulty": "intermediate",
    },
    "compgen": {
        "description": "Generate possible completion matches for a given word using programmable completion specifications. Use it inside completion functions or interactively to list available commands, files, variables, or other completable items matching a prefix.",
        "flags": {
            "-W": "Generate completions from the specified word list",
            "-A": "Generate completions of the specified type (alias, builtin, command, file, etc.)",
            "-c": "Generate command name completions",
            "-d": "Generate directory name completions",
            "-f": "Generate filename completions",
            "-v": "Generate shell variable name completions",
            "-b": "Generate builtin command completions"
        },
        "common_patterns": ["compgen -c prefix", "compgen -W 'start stop restart' -- $cur", "compgen -A alias", "compgen -d /usr/"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html",
        "use_cases": [
            "List all available commands: compgen -c",
            "List all shell aliases: compgen -A alias",
            "List shell variables matching a prefix: compgen -v PATH",
            "Generate completions from a word list: compgen -W 'start stop restart status' -- 'st'",
            "List all builtin commands: compgen -b",
        ],
        "gotchas": [
            "compgen outputs one match per line -- pipe to sort or grep for filtering",
            "The -- before the prefix word is required to separate compgen options from the word being completed",
            "compgen -c lists ALL commands (builtins, aliases, functions, external) -- use -b, -A function, etc. for specific types",
            "compgen is primarily designed for use inside completion functions, but is useful interactively for discovery",
        ],
        "related": ["complete", "compopt", "type"],
        "difficulty": "advanced",
    },
    "complete": {
        "description": "Define programmable completion specifications that control how tab completion works for specific commands. Use it to register custom completion functions or word lists for commands, making the shell auto-complete arguments intelligently.",
        "flags": {
            "-F": "Use the specified function to generate completions",
            "-W": "Use the specified word list for completions",
            "-A": "Use the specified action (alias, file, directory, command, etc.) for completions",
            "-o": "Set a completion option (filenames, nospace, default, etc.)",
            "-p": "Print all existing completion specifications",
            "-r": "Remove the completion specification for the specified command"
        },
        "common_patterns": ["complete -F _my_func mycommand", "complete -W 'start stop restart' service", "complete -p", "complete -r mycommand"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html",
        "use_cases": [
            "Register a completion function: complete -F _my_git_complete git",
            "Simple word-list completion: complete -W 'start stop restart' myservice",
            "File completion for a command: complete -f myeditor",
            "Directory-only completion: complete -d mycd",
            "View existing completions: complete -p",
            "Remove a completion: complete -r mycommand",
        ],
        "gotchas": [
            "complete definitions are session-only -- persist them in ~/.bash_completion or /etc/bash_completion.d/",
            "The completion function receives COMP_WORDS, COMP_CWORD, and must populate COMPREPLY array",
            "complete -o filenames tells bash to treat results as filenames (adds trailing slashes to directories)",
            "Overwriting an existing completion replaces it entirely -- there is no way to extend one",
        ],
        "related": ["compgen", "compopt", "bind"],
        "difficulty": "advanced",
    },
    "compopt": {
        "description": "Modify completion options for the currently executing programmable completion function. Use it inside a completion function to dynamically change behavior such as enabling or disabling filename completion for specific cases.",
        "flags": {
            "-o": "Enable the specified completion option (e.g., filenames, nospace, default)",
            "+o": "Disable the specified completion option",
            "-D": "Apply the option change to the default completion",
            "-E": "Apply the option change to empty-line completion"
        },
        "common_patterns": ["compopt -o filenames", "compopt +o nospace", "compopt -o default"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html",
        "use_cases": [
            "Enable filename handling mid-completion: compopt -o filenames",
            "Disable space after completion: compopt -o nospace",
            "Switch completion behavior based on context inside a completion function",
        ],
        "gotchas": [
            "compopt can only be called from within a completion function -- it has no effect elsewhere",
            "compopt modifies options for the current completion attempt, not the complete specification permanently",
            "Available options: filenames, nospace, default, dirnames, plusdirs -- not all combinations are useful",
        ],
        "related": ["complete", "compgen"],
        "difficulty": "advanced",
    },
    "composer": {
        "description": "The dependency manager for PHP that installs and manages libraries per project. It resolves dependency trees defined in composer.json and locks exact versions in composer.lock for reproducibility.",
        "flags": {
            "install": "Install all dependencies defined in composer.lock or composer.json",
            "update": "Update dependencies to their latest versions within constraints",
            "require": "Add a new package to the project and install it",
            "remove": "Remove a package from the project",
            "--no-dev": "Skip installing development dependencies for production",
            "--optimize-autoloader": "Convert PSR-0/4 autoloading to classmap for faster loading",
            "--ignore-platform-reqs": "Ignore PHP version and extension requirements",
            "--dry-run": "Simulate the command without making any changes",
            "dump-autoload": "Regenerate the autoloader files",
            "show": "Show information about installed packages",
            "outdated": "List packages with available updates",
            "global": "Run commands in the global composer directory",
        },
        "common_patterns": ["composer install", "composer require vendor/package", "composer update", "composer install --no-dev"],
        "man_url": "https://getcomposer.org/doc/",
        "use_cases": [
            "Install all dependencies from composer.json: composer install",
            "Add a package: composer require monolog/monolog",
            "Add a development dependency: composer require --dev phpunit/phpunit",
            "Update all dependencies: composer update",
            "Create a new project from a package: composer create-project laravel/laravel my-app",
        ],
        "gotchas": [
            "composer install installs from composer.lock (reproducible); composer update resolves new versions and rewrites the lock file -- do not use update in production deployments",
            "Composer installs packages to vendor/ and generates an autoloader -- always include vendor/autoload.php in your code",
            "Running Composer as root is discouraged and will display a warning -- it can lead to file permission issues",
        ],
        "related": ["php", "pecl"],
        "difficulty": "intermediate",
    },
    "compress": {
        "description": "Compress files using the older LZW algorithm, producing .Z files. You use compress mainly for compatibility with legacy Unix systems, though gzip and xz have largely replaced it for modern use.",
        "flags": {
            "-f": "Force compression even if the file already has a .Z suffix or output exists",
            "-c": "Write compressed data to stdout, leaving the original file unchanged",
            "-v": "Verbose mode showing compression percentage for each file",
            "-r": "Recursively compress files in directories",
            "-b": "Set the maximum number of bits used in the LZW coding (9-16)"
        },
        "common_patterns": ["compress file.txt", "compress -v *.log", "compress -c file.txt > file.Z"],
        "man_url": "https://linux.die.net/man/1/compress",
        "use_cases": [
            "Compress a file (creates .Z file): compress file.txt",
            "Decompress a .Z file: compress -d file.Z",
            "Write compressed output to stdout: compress -c file.txt > file.Z",
        ],
        "gotchas": [
            "compress uses the LZW algorithm and is largely obsolete -- gzip, bzip2, xz, and zstd all provide better compression",
            "compress creates .Z files which are rarely seen on modern systems",
            "compress may not be installed by default on modern Linux distributions",
        ],
        "related": ["uncompress", "gzip", "bzip2"],
        "difficulty": "intermediate",
    },
    "conda": {
        "description": "A cross-platform package and environment manager for Python, R, and other languages used heavily in data science. It creates isolated environments with their own packages and Python versions to avoid conflicts.",
        "flags": {
            "install": "Install packages into the current or specified environment",
            "create": "Create a new isolated environment with specified packages",
            "update": "Update packages in an environment to their latest versions",
            "remove": "Remove packages from an environment",
            "list": "List all packages installed in an environment",
            "search": "Search for available packages in configured channels",
            "-n": "Specify the target environment by name",
            "-c": "Specify an additional channel to search for packages",
            "activate": "Activate an environment",
            "deactivate": "Deactivate the current environment",
            "env list": "List all environments",
            "env remove": "Delete an environment",
            "clean": "Remove unused packages and caches",
            "--override-channels": "Ignore default channels",
            "config": "Manage conda configuration",
        },
        "common_patterns": ["conda create -n myenv python=3.11", "conda install package_name", "conda activate myenv", "conda list"],
        "man_url": "https://docs.conda.io/projects/conda/en/stable/",
        "use_cases": [
            "Create a new environment with specific Python version: conda create -n myenv python=3.11",
            "Activate an environment: conda activate myenv",
            "Install a package: conda install numpy",
            "Export an environment for reproducibility: conda env export > environment.yml",
            "Recreate an environment from a file: conda env create -f environment.yml",
        ],
        "gotchas": [
            "Mixing pip and conda in the same environment can break dependency resolution -- install everything with conda first, then use pip only for packages not in conda channels",
            "conda environments can be large (gigabytes) because conda installs compiled binaries for everything including the Python interpreter itself",
            "The default channel may have older versions -- use conda-forge channel (conda install -c conda-forge package) for more up-to-date packages",
            "conda activate does not work in shell scripts by default -- you must run 'eval \"$(conda shell.bash hook)\"' first or use conda run",
        ],
        "related": ["pip", "poetry", "uv", "mamba"],
        "difficulty": "intermediate",
    },
    "continue": {
        "description": "Skip the remaining body of the enclosing for, while, or until loop and jump to the next iteration. Use it to bypass specific iterations based on a condition without terminating the entire loop.",
        "flags": {},
        "common_patterns": ["continue", "continue 2", "[[ condition ]] && continue"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Skip an iteration: [[ $file == *.tmp ]] && continue",
            "Skip to the next iteration of an outer loop: continue 2",
            "Filter out unwanted items in a processing loop",
        ],
        "gotchas": [
            "continue N resumes the Nth enclosing loop, not the current one -- continue 2 affects the outer loop",
            "continue outside a loop causes an error in strict shells and a warning in bash",
            "continue does not skip the rest of a pipeline stage -- it skips the rest of the loop body",
        ],
        "related": ["break", "return", "for", "while"],
        "difficulty": "beginner",
    },
    "cron": {
        "description": "The background daemon that executes scheduled commands at specified times and intervals defined in crontab files. Use crontab to configure it -- cron itself runs automatically at boot and checks for jobs every minute.",
        "flags": {
            "-n": "Run in the foreground instead of daemonizing",
            "-f": "Stay in the foreground (used in containers)",
            "-l": "Enable extra logging of cron job execution",
            "-L": "Set the log level for cron"
        },
        "common_patterns": ["sudo service cron start", "sudo systemctl enable cron", "sudo systemctl status cron"],
        "man_url": "https://man7.org/linux/man-pages/man8/cron.8.html",
        "use_cases": [
            "Schedule recurring system tasks like log rotation and backups",
            "Run periodic maintenance scripts at off-peak hours",
            "Automate report generation on a daily or weekly schedule",
        ],
        "gotchas": [
            "cron jobs run with a minimal environment -- PATH and other variables may differ from your interactive shell",
            "cron has no dependency tracking -- if a job fails, subsequent dependent jobs still run",
            "Cron emails output to the user by default -- redirect output or set MAILTO to avoid mail buildup",
        ],
        "related": ["crontab", "at", "systemd-timer", "anacron"],
        "difficulty": "intermediate",
    },
    "deno": {
        "description": "A secure JavaScript and TypeScript runtime built on V8 that requires explicit permissions for file, network, and environment access. You'd use it as a modern alternative to Node.js with built-in TypeScript support, linting, and a standard library.",
        "flags": {
            "--allow-read": "Grant permission to read from the filesystem",
            "--allow-write": "Grant permission to write to the filesystem",
            "--allow-net": "Grant permission to make network requests",
            "--allow-env": "Grant permission to access environment variables",
            "--allow-all": "Grant all permissions to the script",
            "--watch": "Watch for file changes and restart the process automatically",
            "--inspect": "Activate the V8 inspector for debugging",
            "--unstable": "Enable unstable APIs that may change in future versions",
            "--allow-run": "Allow running subprocesses",
            "--allow-ffi": "Allow loading dynamic libraries",
            "--lock": "Check specified lockfile for integrity",
            "--no-check": "Skip TypeScript type checking for faster startup",
        },
        "common_patterns": ["deno run script.ts", "deno run --allow-net --allow-read server.ts", "deno run --watch main.ts", "deno fmt && deno lint && deno test"],
        "man_url": "https://docs.deno.com/runtime/reference/cli/",
        "use_cases": [
            "Run a TypeScript file directly without compilation with deno run script.ts",
            "Run a web server with explicit permissions with deno run --allow-net --allow-read server.ts",
            "Format and lint code with built-in tools with deno fmt && deno lint",
            "Run tests with deno test for built-in test runner support",
        ],
        "gotchas": [
            "Deno uses explicit permissions by default -- scripts cannot access files, network, or environment without --allow-* flags, which breaks scripts silently if forgotten",
            "Deno uses URL imports not package.json by default -- npm compatibility exists via npm: specifiers but the ecosystem differs from Node.js",
            "Deno does not support __dirname or require() -- use import.meta.url and ES module imports instead",
        ],
        "related": ["node", "bun", "npm", "tsc"],
        "difficulty": "intermediate",
    },
    "dirs": {
        "description": "Display the current directory stack managed by pushd and popd, showing the list of remembered directories. Use it to view or manipulate the directory stack when navigating between multiple working directories.",
        "flags": {
            "-v": "Print the directory stack with one entry per line, prefixed by its index",
            "-p": "Print the directory stack with one entry per line",
            "-c": "Clear the directory stack by deleting all entries",
            "-l": "Print full pathnames instead of using ~ for the home directory"
        },
        "common_patterns": ["dirs", "dirs -v", "dirs -c", "dirs -l"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Directory-Stack-Builtins.html",
        "use_cases": [
            "View the current directory stack: dirs -v (shows numbered list)",
            "Clear the directory stack: dirs -c",
            "Show full paths instead of tilde abbreviation: dirs -l",
        ],
        "gotchas": [
            "dirs always includes the current working directory as the first entry, even if pushd was never used",
            "dirs -v numbers entries from 0, which matches the +N argument for pushd and popd",
            "The output of dirs without flags is space-separated on one line, which is hard to parse for paths with spaces",
        ],
        "related": ["pushd", "popd", "cd", "pwd"],
        "difficulty": "intermediate",
    },
    "dnf": {
        "description": "The default package manager for Fedora, RHEL, and CentOS that replaces yum with improved dependency resolution. It manages RPM packages from configured software repositories.",
        "flags": {
            "install": "Install one or more packages and their dependencies",
            "remove": "Remove a package and its unneeded dependencies",
            "update": "Update all installed packages to the latest available versions",
            "search": "Search package metadata for a given string",
            "info": "Display detailed information about a package",
            "-y": "Automatically answer yes to all prompts",
            "--refresh": "Force a refresh of metadata before running the command",
            "autoremove": "Remove packages originally installed as dependencies that are no longer needed",
            "provides": "Find which package provides a file or capability",
            "repolist": "List enabled repositories",
            "module": "Manage modular content streams",
            "group": "Manage package groups",
            "--best": "Try to install the best available version of packages",
            "downgrade": "Downgrade a package to an earlier available version",
        },
        "common_patterns": ["dnf install package_name", "dnf update", "dnf search keyword", "dnf remove package_name"],
        "man_url": "https://man7.org/linux/man-pages/man8/dnf.8.html",
        "use_cases": [
            "Install a package on Fedora or RHEL: dnf install nginx",
            "Upgrade all packages on the system: dnf upgrade --refresh",
            "Search for packages by keyword: dnf search text editor",
            "List all installed packages: dnf list installed",
            "Remove unneeded dependency packages: dnf autoremove",
        ],
        "gotchas": [
            "dnf upgrade is the modern replacement for yum update -- dnf update exists as an alias but upgrade is the canonical command",
            "dnf module commands manage modular content streams (e.g., different Node.js versions) -- forgetting to enable a module stream before installing can give you an unexpected version",
            "dnf history undo can roll back a transaction but may fail if other packages now depend on what was installed",
        ],
        "related": ["yum", "rpm", "zypper"],
        "difficulty": "beginner",
    },
    "doas": {
        "description": "Execute a command as another user, serving as a simpler and more secure alternative to sudo, originally from OpenBSD. Use it when your system is configured with doas.conf for privilege escalation with a minimal and auditable policy.",
        "flags": {
            "-u": "Run the command as the specified user instead of root",
            "-s": "Run a shell as the target user",
            "-n": "Non-interactive mode; fail rather than prompt for a password",
            "-L": "Clear any cached authentication"
        },
        "common_patterns": ["doas command", "doas -u user command", "doas -s", "doas -n command"],
        "man_url": "https://man.openbsd.org/doas",
        "use_cases": [
            "Run a command as root: doas apt update",
            "Execute as another user: doas -u postgres psql",
            "Simpler alternative to sudo with a minimal config file",
        ],
        "gotchas": [
            "doas is not installed by default on most Linux distros -- it must be installed and configured",
            "Configuration file is /etc/doas.conf with different syntax than sudoers",
            "Fewer features than sudo -- no command logging, session caching is limited",
        ],
        "related": ["sudo", "su", "pkexec", "runuser"],
        "difficulty": "intermediate",
    },
    "dotnet": {
        "description": "The cross-platform CLI for .NET that manages projects, dependencies, builds, and deployments. It provides commands for creating, compiling, testing, and publishing .NET applications from the command line.",
        "flags": {
            "new": "Create a new .NET project or solution from a template",
            "build": "Compile the project and all of its dependencies",
            "run": "Compile and immediately execute the application from source",
            "test": "Run unit tests using the configured test framework",
            "publish": "Package the application for deployment to a target environment",
            "add package": "Add a NuGet package reference to the project",
            "--configuration": "Set the build configuration such as Debug or Release",
            "--no-restore": "Skip automatic NuGet package restore before building",
            "restore": "Restore NuGet dependencies",
            "add reference": "Add a project-to-project reference",
            "tool install": "Install a .NET global or local tool",
            "ef": "Entity Framework Core CLI commands (migrations, database)",
            "--runtime": "Specify the target runtime identifier (e.g., linux-x64)",
            "watch": "Watch for file changes and rerun the command",
        },
        "common_patterns": ["dotnet new console", "dotnet build", "dotnet run", "dotnet test"],
        "man_url": "https://learn.microsoft.com/en-us/dotnet/core/tools/",
        "use_cases": [
            "Create a new project from a template: dotnet new webapi -n MyApi",
            "Build the project: dotnet build",
            "Run the application: dotnet run",
            "Run tests: dotnet test",
            "Publish a self-contained application: dotnet publish -c Release --self-contained",
            "Add a NuGet package: dotnet add package Newtonsoft.Json",
        ],
        "gotchas": [
            "dotnet run compiles and runs in debug mode by default -- use -c Release for production-like performance during development testing",
            "dotnet restore is run implicitly by build, run, and test -- explicit restore is only needed in CI environments with --no-restore later",
            "Self-contained deployments (--self-contained) bundle the runtime and can be very large; use trimming (--self-contained -p:PublishTrimmed=true) to reduce size",
        ],
        "related": ["nuget", "msbuild"],
        "difficulty": "intermediate",
    },
    "dpkg": {
        "description": "The low-level package manager for Debian-based Linux systems that installs, removes, and inspects .deb packages. It operates on individual package files without automatic dependency resolution, unlike higher-level tools such as apt.",
        "flags": {
            "-i": "Install a .deb package file onto the system",
            "-r": "Remove an installed package but keep its configuration files",
            "-P": "Purge a package by removing it along with all configuration files",
            "-l": "List all installed packages matching an optional pattern",
            "-L": "List all files installed by a specific package",
            "-s": "Display the status and details of an installed package",
            "-S": "Search for which installed package owns a given file",
            "--configure": "Configure a package that has been unpacked but not yet set up",
            "-c": "List contents of a .deb archive file",
        },
        "common_patterns": ["dpkg -i package.deb", "dpkg -l | grep pattern", "dpkg -L package_name", "dpkg -r package_name"],
        "man_url": "https://man7.org/linux/man-pages/man1/dpkg.1.html",
        "use_cases": [
            "Install a locally downloaded .deb file: dpkg -i package.deb",
            "List all installed packages matching a pattern: dpkg -l 'nginx*'",
            "Find which package owns a specific file: dpkg -S /usr/bin/python3",
            "Show contents of a .deb file without installing: dpkg -c package.deb",
            "Reconfigure a package after installation: dpkg-reconfigure tzdata",
        ],
        "gotchas": [
            "dpkg does not resolve dependencies automatically -- if a .deb requires missing packages, dpkg -i will fail and you must run apt-get install -f to fix the broken state",
            "dpkg --purge removes configuration files too, while dpkg -r leaves them behind -- use --purge only when you want a clean removal",
            "dpkg -l output truncates long package names by default -- pipe through 'dpkg -l | cat' or set COLUMNS=200 for full output",
        ],
        "related": ["apt", "apt-get", "apt-cache"],
        "difficulty": "intermediate",
    },
    "ed": {
        "description": "A line-oriented text editor that is the original Unix editor, operating in command and input modes. You'd use it for scripted file editing in shell scripts where interactive editors are unavailable or impractical.",
        "flags": {
            "-p": "Set a custom prompt string for command mode",
            "-s": "Suppress byte counts and diagnostics for scripted use",
            "-G": "Force backward compatibility mode",
            "-v": "Enable verbose mode with diagnostic messages"
        },
        "common_patterns": ["ed filename.txt", "echo ',s/old/new/g\nw\nq' | ed -s file.txt", "ed -p '> ' script.sh"],
        "man_url": "https://man7.org/linux/man-pages/man1/ed.1.html",
        "use_cases": [
            "Perform scripted file editing without any terminal UI with echo '1,s/old/new/g\nw\nq' | ed -s file.txt",
            "Edit files in environments where no screen-oriented editor is available (recovery mode, minimal containers)",
        ],
        "gotchas": [
            "ed is a line editor with no visual display -- you must use commands like p (print) and n (number) to see file contents",
            "ed silently succeeds on most operations with no feedback -- use -p to set a prompt character so you know ed is waiting for input",
            "ed is the standard POSIX editor -- it works everywhere but is mainly used for scripted edits, not interactive editing",
        ],
        "related": ["ex", "sed", "vim", "vi"],
        "difficulty": "advanced",
    },
    "egrep": {
        "description": "Search for lines matching an extended regular expression pattern, equivalent to grep -E. You use egrep when your search pattern needs alternation (|), grouping, or quantifiers (+, ?) without backslash escaping.",
        "flags": {
            "-i": "Case-insensitive matching",
            "-v": "Invert match: print lines that do not match the pattern",
            "-c": "Print only the count of matching lines per file",
            "-n": "Prefix each matching line with its line number",
            "-r": "Recursively search files in directories",
            "-l": "Print only the names of files containing matches",
            "-o": "Print only the matched parts of each line",
            "-w": "Match the pattern only as a whole word"
        },
        "common_patterns": ["egrep 'error|warning|fatal' logfile.txt", "egrep -i 'pattern' *.txt", "egrep -rn 'TODO|FIXME' src/"],
        "man_url": "https://man7.org/linux/man-pages/man1/grep.1.html",
        "use_cases": [
            "Search with extended regex without escaping: egrep '(error|warning|critical)' log.txt",
            "Match complex patterns: egrep '^[0-9]{1,3}\\.' access.log",
            "Filter with alternation: egrep 'GET|POST|PUT' access.log",
        ],
        "gotchas": [
            "egrep is deprecated -- use grep -E instead for forward compatibility",
            "Some systems may remove egrep in future releases",
        ],
        "related": ["grep", "fgrep", "sed", "awk"],
        "difficulty": "beginner",
    },
    "emacs": {
        "description": "An extensible, self-documenting text editor and computing environment with a built-in Lisp interpreter for customization. You'd use it as a powerful development environment for coding, writing, and running shell commands all within one application.",
        "flags": {
            "-nw": "Run in terminal mode without a graphical window",
            "-q": "Do not load the user init file (~/.emacs)",
            "-Q": "Start with minimal configuration, skipping site and init files",
            "--batch": "Run in batch mode for non-interactive scripted operations",
            "-f": "Call a named Emacs Lisp function on startup",
            "-l": "Load and execute the specified Emacs Lisp file",
            "--eval": "Evaluate the given Emacs Lisp expression",
            "--daemon": "Start Emacs as a background server for fast client connections"
        },
        "common_patterns": ["emacs file.txt", "emacs -nw file.py", "emacs --daemon", "emacs --batch -l script.el"],
        "man_url": "https://www.gnu.org/software/emacs/manual/html_node/emacs/",
        "use_cases": [
            "Edit a file in terminal mode with emacs -nw file.txt",
            "Run Emacs as a daemon for instant startup with emacs --daemon then emacsclient file.txt",
            "Evaluate a Lisp expression for batch processing with emacs --batch --eval '(message \"hello\")'",
        ],
        "gotchas": [
            "Emacs uses Ctrl and Meta (Alt) key combinations extensively -- Ctrl+C Ctrl+F opens a file, Ctrl+X Ctrl+S saves, Ctrl+X Ctrl+C quits",
            "Emacs init files (.emacs or ~/.emacs.d/init.el) can slow startup significantly -- use emacs --daemon + emacsclient for fast subsequent access",
            "The learning curve is steep but different from vim -- Emacs is always in 'insert mode' and uses modifier keys instead of modal switching",
        ],
        "related": ["vim", "nvim", "code", "nano"],
        "difficulty": "advanced",
    },
    "enable": {
        "description": "Enable or disable shell builtin commands, allowing you to control which builtins are active in the current shell session. Use it to disable a builtin so that an external command with the same name is found instead, or to load dynamically loadable builtins.",
        "flags": {
            "-n": "Disable the specified builtin command(s)",
            "-a": "Print a list of all builtins showing whether each is enabled or disabled",
            "-f": "Load a new builtin command from the specified shared object file",
            "-d": "Delete a builtin that was loaded with -f",
            "-s": "Restrict output to POSIX special builtins",
            "-p": "Print builtins in a reusable format"
        },
        "common_patterns": ["enable -n echo", "enable -a", "enable echo", "enable -f /path/to/lib name"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "use_cases": [
            "Disable a builtin to use an external version: enable -n echo (then /bin/echo is used)",
            "List all builtins with their enabled/disabled status: enable -a",
            "Load a dynamically loadable builtin: enable -f /path/to/lib builtin_name",
            "Re-enable a previously disabled builtin: enable echo",
        ],
        "gotchas": [
            "Disabling a builtin is per-shell-session only -- it resets on new shell launch",
            "enable -f for loadable builtins requires that bash was compiled with loadable builtin support",
            "Disabling critical builtins (cd, exit) can make the shell session hard to use",
        ],
        "related": ["builtin", "command", "type"],
        "difficulty": "advanced",
    },
    "ex": {
        "description": "A line-oriented text editor that serves as the underlying command mode of vi, supporting scripted batch editing operations. You'd use it to perform non-interactive, scriptable text editing from shell scripts or pipelines.",
        "flags": {
            "-s": "Run in silent batch mode, suppressing prompts and messages",
            "-c": "Execute the given ex command after loading the file",
            "-R": "Open files in read-only mode",
            "-v": "Start in visual mode, effectively launching vi",
            "-r": "Recover a file after a crash using swap file data",
            "+": "Begin editing at a specified line number"
        },
        "common_patterns": ["ex -s -c '%s/old/new/g|x' file.txt", "ex -sc 'g/pattern/d|x' file.txt", "ex +10 file.txt"],
        "man_url": "https://man7.org/linux/man-pages/man1/ex.1p.html",
        "use_cases": [
            "Perform batch find-and-replace without opening a visual editor with ex -sc '%s/old/new/g|x' file.txt",
            "Delete all lines matching a pattern with ex -sc 'g/DEBUG/d|x' logfile.txt",
            "Script complex multi-step edits with ex commands piped from a file",
        ],
        "gotchas": [
            "ex is essentially vim's command mode run standalone -- the commands are identical to vim : commands",
            "Use -s for silent batch mode to suppress prompts and messages -- without it ex waits for interactive input",
            "The x command saves and exits (write-quit) -- use q! to discard changes if the script fails midway",
        ],
        "related": ["ed", "vim", "sed"],
        "difficulty": "advanced",
    },
    "exa": {
        "description": "A modern replacement for ls written in Rust with sensible defaults, color coding, and git integration built in. Use it for enhanced directory listings that show git status, extended attributes, and tree views out of the box.",
        "flags": {
            "-l": "Long format with permissions, size, and date",
            "-a": "Show all files including hidden ones",
            "-T": "Display entries in a tree-like format",
            "--git": "Show git status for each file",
            "--icons": "Display icons next to file names (requires Nerd Font)",
            "-h": "Add a header row to long format output",
            "-s": "Sort by the specified field (name, size, date, etc.)",
            "--group-directories-first": "List directories before files",
            "-d": "List directories themselves, not their contents",
            "--no-permissions": "Suppress the permissions column",
            "--time-style": "Set time display format (default, iso, long-iso, full-iso)",
        },
        "common_patterns": ["exa -la", "exa -T", "exa -la --git", "exa -la --icons"],
        "man_url": "https://github.com/ogham/exa",
        "use_cases": [
            "List files with git status indicators with exa -la --git",
            "View a directory tree with file sizes with exa -T -L 3 --icons -s size",
            "List files sorted by modification time with exa -la -s modified --reverse",
        ],
        "gotchas": [
            "exa is no longer maintained as of 2023 -- the community fork eza is the actively maintained successor",
            "The --icons flag requires a Nerd Font installed and configured in your terminal -- without it you get garbled characters",
            "exa uses different flags than ls -- muscle memory for ls -ltr will not work (exa uses -s modified --reverse instead of -t -r)",
        ],
        "related": ["ls", "lsd", "eza", "tree"],
        "difficulty": "beginner",
    },
    "exit": {
        "description": "Terminate the current shell session or script with an optional exit status code. Use it to end a script and communicate success (0) or failure (non-zero) to the calling process.",
        "flags": {},
        "common_patterns": ["exit", "exit 0", "exit 1", "|| exit 1"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "End a script with success: exit 0",
            "Signal an error condition: exit 1",
            "Use in error handlers: || { echo 'Failed'; exit 1; }",
            "Exit with the status of the last command: exit $?",
        ],
        "gotchas": [
            "exit in a sourced script terminates the CALLING shell, not just the script -- use return instead in sourced files",
            "Exit codes above 125 have special meanings: 126 = command not executable, 127 = command not found, 128+N = killed by signal N",
            "exit triggers the EXIT trap -- do not call exit inside an EXIT trap handler or you risk infinite recursion",
            "In a subshell (parentheses or pipe), exit only exits the subshell, not the parent script",
        ],
        "related": ["return", "trap", "break"],
        "difficulty": "beginner",
    },
    "fc": {
        "description": "List, edit, or re-execute commands from the shell history, opening your editor for modification before running them. Use it to fix and re-run a previous command by editing it in your preferred text editor, or to list recent history entries.",
        "flags": {
            "-l": "List history entries instead of editing them",
            "-n": "Suppress line numbers when listing history",
            "-r": "Reverse the order of listed history entries",
            "-e": "Specify the editor to use (default is FCEDIT or EDITOR or vi)",
            "-s": "Re-execute a command from history without editing"
        },
        "common_patterns": ["fc -l", "fc -l -10", "fc -s", "fc -e vim"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-History-Builtins.html",
        "use_cases": [
            "Edit and re-run the last command in your editor: fc",
            "List the last 10 commands: fc -l -10",
            "Re-execute a command by number without editing: fc -s 42",
            "Quick substitution and re-run: fc -s old=new (replaces 'old' with 'new' in the last command)",
            "Use a specific editor: fc -e vim",
        ],
        "gotchas": [
            "fc with no arguments opens the LAST command in an editor -- saving and quitting immediately re-runs it",
            "The editor used depends on FCEDIT, then EDITOR, then defaults to vi -- make sure you know which one",
            "fc -s with no pattern re-runs the last command, which can be dangerous if the last command was destructive",
            "fc -l without -n includes line numbers, which may confuse copy-paste workflows",
        ],
        "related": ["history", "bind"],
        "difficulty": "intermediate",
    },
    "fdisk": {
        "description": "A dialog-driven utility for creating and manipulating disk partition tables on MBR and GPT disks. You use fdisk when you need to partition a new drive, resize partitions, or inspect the partition layout of a block device.",
        "flags": {
            "-l": "List the partition tables for all disks or the specified disk",
            "-b": "Specify the sector size of the disk (512, 1024, 2048, or 4096)",
            "-u": "Display sizes in sectors instead of cylinders",
            "-B": "Do not erase the beginning of the first disk sector when creating a new label",
            "-W": "Wipe filesystem and partition-table signatures from new partitions (auto, never, always)",
            "-c": "Specify compatibility mode: dos or nondos"
        },
        "common_patterns": ["sudo fdisk -l", "sudo fdisk /dev/sda", "fdisk -l /dev/nvme0n1"],
        "man_url": "https://man7.org/linux/man-pages/man8/fdisk.8.html",
        "use_cases": [
            "List all disk partitions: fdisk -l",
            "Create, delete, and modify disk partitions interactively",
            "View partition table details for a specific disk: fdisk -l /dev/sda",
        ],
        "gotchas": [
            "Destructive operations; wrong disk selection can destroy all data",
            "Changes are not written until you explicitly press 'w' in interactive mode",
            "Does not support GPT well; use gdisk or parted for GPT disks",
        ],
        "related": ["lsblk", "blkid", "mkfs", "mount"],
        "difficulty": "advanced",
    },
    "fgrep": {
        "description": "Search for lines matching a fixed string literally, equivalent to grep -F, with no regular expression interpretation. You use fgrep when searching for strings that contain regex metacharacters like dots or brackets that you want matched literally.",
        "flags": {
            "-i": "Case-insensitive matching",
            "-v": "Invert match: print lines that do not match",
            "-c": "Print only the count of matching lines",
            "-n": "Prefix each matching line with its line number",
            "-r": "Recursively search files in directories",
            "-l": "Print only the names of files containing matches",
            "-w": "Match the string only as a whole word",
            "-x": "Match only whole lines that exactly equal the string"
        },
        "common_patterns": ["fgrep 'exact.string' file.txt", "fgrep -c 'pattern' *.log", "fgrep -rl 'search_term' /path/to/dir"],
        "man_url": "https://man7.org/linux/man-pages/man1/grep.1.html",
        "use_cases": [
            "Search for literal strings with special characters: fgrep 'price=$9.99' orders.txt",
            "Fast multi-pattern search from a file: fgrep -f patterns.txt data.txt",
            "Search for strings containing regex metacharacters without escaping",
        ],
        "gotchas": [
            "fgrep is deprecated -- use grep -F instead for forward compatibility",
            "Cannot use any regex features -- patterns are strictly literal",
        ],
        "related": ["grep", "egrep", "strings", "awk"],
        "difficulty": "beginner",
    },
    "finger": {
        "description": "Display information about local and remote user accounts including login name, real name, terminal, idle time, and plan file. Use it to look up user details, though it is considered legacy and may not be installed on modern systems.",
        "flags": {
            "-l": "Force long output format with detailed user information",
            "-s": "Force short output format with one line per user",
            "-m": "Match arguments only against user names, not real names",
            "-p": "Suppress display of .plan and .project files"
        },
        "common_patterns": ["finger username", "finger -l username", "finger @remotehost"],
        "man_url": "https://man7.org/linux/man-pages/man1/finger.1.html",
        "use_cases": [
            "Display user account details: finger username",
            "Check a user's real name, login time, and shell",
        ],
        "gotchas": [
            "finger is considered a security risk because it can expose user information remotely; it is often uninstalled or disabled on modern systems",
            "The finger daemon (fingerd) is almost never enabled on production systems",
        ],
        "related": ["id", "who", "w"],
        "difficulty": "beginner",
    },
    "firewall-cmd": {
        "description": "Manage the firewalld dynamic firewall using zones and services on RHEL, CentOS, and Fedora systems. Use it to configure persistent or runtime-only firewall rules with a higher-level interface than raw iptables or nftables.",
        "flags": {
            "--add-service": "Allow traffic for a predefined service (e.g., http, ssh)",
            "--remove-service": "Remove a service from allowed traffic",
            "--add-port": "Open a specific port/protocol combination",
            "--remove-port": "Close a specific port/protocol",
            "--permanent": "Make changes persistent across reboots",
            "--reload": "Reload the firewall to apply permanent changes",
            "--list-all": "Show all current settings for the active zone",
            "--zone": "Specify the zone to operate on",
            "--get-active-zones": "Show which zones are active and their interfaces",
            "--get-default-zone": "Show the default zone",
            "--set-default-zone": "Change the default zone",
            "--add-rich-rule": "Add a complex rule with source/destination filtering",
        },
        "common_patterns": ["sudo firewall-cmd --add-service=http --permanent", "sudo firewall-cmd --reload", "sudo firewall-cmd --list-all", "sudo firewall-cmd --add-port=8080/tcp --permanent"],
        "man_url": "https://firewalld.org/documentation/man-pages/firewall-cmd.html",
        "use_cases": [
            "Open HTTP permanently: firewall-cmd --add-service=http --permanent && firewall-cmd --reload",
            "List all allowed services and ports: firewall-cmd --list-all",
            "Temporarily open a port for testing (removed on reload): firewall-cmd --add-port=8080/tcp",
            "Add a rich rule for IP-based access control: firewall-cmd --add-rich-rule='rule family=ipv4 source address=10.0.0.0/24 accept' --permanent",
        ],
        "gotchas": [
            "Changes without --permanent are lost on firewalld restart or reload",
            "After adding --permanent rules, you must --reload for them to take effect immediately",
            "firewall-cmd is specific to RHEL/CentOS/Fedora; Debian/Ubuntu systems use ufw instead",
        ],
        "related": ["iptables", "ufw", "nft"],
        "difficulty": "intermediate",
    },
    "flatpak": {
        "description": "A framework for distributing sandboxed desktop applications across Linux distributions. It isolates apps from the host system using containers and provides a consistent runtime environment regardless of the underlying distro.",
        "flags": {
            "install": "Install an application or runtime from a remote repository",
            "uninstall": "Remove an installed application or runtime",
            "update": "Update all installed applications and runtimes",
            "list": "List all installed applications and runtimes",
            "search": "Search remote repositories for available applications",
            "run": "Launch an installed Flatpak application",
            "--user": "Perform the operation for the current user only",
            "--system": "Perform the operation system-wide for all users",
            "override": "Override application permissions",
        },
        "common_patterns": ["flatpak install flathub app.id", "flatpak update", "flatpak list", "flatpak run app.id"],
        "man_url": "https://www.man7.org/linux/man-pages/man1/flatpak.1.html",
        "use_cases": [
            "Install an application from Flathub: flatpak install flathub org.gimp.GIMP",
            "Run an installed Flatpak application: flatpak run org.gimp.GIMP",
            "Update all installed Flatpak applications: flatpak update",
            "List installed applications and runtimes: flatpak list",
            "Add the Flathub repository: flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo",
        ],
        "gotchas": [
            "Flatpak uses application IDs (reverse DNS like org.gimp.GIMP) not simple names -- you must know or search for the full ID",
            "Flatpak apps are sandboxed and may not see your home directory or USB drives -- use Flatseal or flatpak override to manage permissions",
            "Runtimes take significant disk space since each app bundles its own dependencies -- use flatpak uninstall --unused to remove orphaned runtimes",
        ],
        "related": ["snap", "apt", "apt-get"],
        "difficulty": "beginner",
    },
    "fsck": {
        "description": "Check and optionally repair Linux filesystems for consistency errors such as bad blocks, orphaned inodes, and corrupted metadata. You use fsck on unmounted partitions after a crash or unclean shutdown to restore filesystem integrity.",
        "flags": {
            "-a": "Automatically repair the filesystem without prompting",
            "-y": "Answer yes to all repair prompts automatically",
            "-n": "Check the filesystem without making any repairs (read-only mode)",
            "-f": "Force a full check even if the filesystem appears clean",
            "-t": "Specify the filesystem type to check",
            "-A": "Check all filesystems listed in /etc/fstab",
            "-C": "Display a progress bar during the check",
            "-V": "Verbose mode, show all commands being executed"
        },
        "common_patterns": ["sudo fsck /dev/sda1", "sudo fsck -y /dev/sdb1", "fsck -n /dev/sda2", "sudo fsck -A"],
        "man_url": "https://man7.org/linux/man-pages/man8/fsck.8.html",
        "use_cases": [
            "Check and repair a filesystem: fsck /dev/sda1",
            "Force check even if filesystem appears clean: fsck -f /dev/sda1",
            "Automatically fix errors: fsck -y /dev/sda1",
        ],
        "gotchas": [
            "Never run fsck on a mounted filesystem; it can cause data corruption",
            "Running fsck on the root filesystem requires booting into recovery mode",
        ],
        "related": ["mkfs", "mount", "lsblk", "fdisk"],
        "difficulty": "advanced",
    },
    "ftp": {
        "description": "Connect to and transfer files from a remote FTP server using the classic File Transfer Protocol with interactive or scripted commands. Use it to upload or download files from legacy FTP servers, though sftp or scp should be preferred for security since FTP transmits credentials in plain text.",
        "flags": {
            "-n": "Suppress auto-login on initial connection",
            "-v": "Verbose mode showing all server responses",
            "-i": "Disable interactive prompting during multiple file transfers",
            "-p": "Use passive mode for data transfers (useful behind firewalls)",
            "-g": "Disable filename globbing"
        },
        "common_patterns": ["ftp ftp.example.com", "ftp -n ftp.example.com", "ftp -i -n ftp.example.com < commands.txt", "ftp -p ftp.example.com"],
        "man_url": "https://man7.org/linux/man-pages/man1/ftp.1.html",
        "use_cases": [
            "Upload files to a legacy web hosting provider that only supports FTP",
            "Automate file transfers from an FTP server using a script with -n and heredoc commands",
            "Download firmware updates from embedded device FTP servers during maintenance windows",
        ],
        "gotchas": [
            "FTP transmits credentials and data in plain text -- use sftp or scp for anything involving sensitive data",
            "Active mode FTP requires the server to connect back to your machine, which fails behind most NAT/firewalls; use -p for passive mode",
            "Binary mode must be set explicitly with 'binary' command before transferring non-text files, or they will be corrupted",
        ],
        "related": ["sftp", "scp", "rsync", "curl"],
        "difficulty": "beginner",
    },
    "fuser": {
        "description": "Identify which processes are currently using specified files, sockets, or filesystems. Use it to find out why a device is busy and cannot be unmounted, or which process is holding a file lock.",
        "flags": {
            "-k": "Kill all processes accessing the named file",
            "-m": "Name a file on a mounted filesystem to find all processes using that filesystem",
            "-v": "Verbose mode showing PID, user, access type, and command",
            "-u": "Append the username of the process owner to each PID",
            "-n": "Select the namespace (file, udp, tcp) to search",
            "-i": "Ask for confirmation before killing a process"
        },
        "common_patterns": ["fuser -v /dev/sda1", "fuser -km /mnt/usb", "fuser -n tcp 8080", "fuser -v ."],
        "man_url": "https://man7.org/linux/man-pages/man1/fuser.1.html",
        "use_cases": [
            "Find which process is using a file: fuser -v /path/to/file",
            "Kill all processes accessing a stuck mount point: fuser -km /mnt/usb",
            "Find which process is listening on a TCP port: fuser -n tcp 8080",
        ],
        "gotchas": [
            "fuser -k kills ALL processes accessing the file/filesystem -- be very careful with this on system directories",
            "Use -i for interactive confirmation before killing",
        ],
        "related": ["lsof", "kill", "umount"],
        "difficulty": "intermediate",
    },
    "g++": {
        "description": "The GNU C++ compiler that compiles C++ source code into native executables with extensive optimization and warning capabilities. You'd use it to build C++ programs on Linux and other platforms with fine-grained control over standards compliance and optimization.",
        "flags": {
            "-o": "Specify the output executable file name",
            "-c": "Compile to object files without linking",
            "-std": "Set the C++ language standard (c++11, c++14, c++17, c++20)",
            "-Wall": "Enable all common warning messages",
            "-Wextra": "Enable additional warnings beyond -Wall",
            "-g": "Include debugging information for gdb",
            "-O2": "Enable standard optimization for better performance",
            "-pedantic": "Issue warnings required by strict ISO C++ compliance"
        },
        "common_patterns": ["g++ -o program main.cpp", "g++ -std=c++17 -Wall -Wextra -o app main.cpp", "g++ -c -O2 module.cpp", "g++ -g -o debug_app main.cpp utils.cpp -lpthread"],
        "man_url": "https://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html",
        "use_cases": [
            "Compile a C++17 program with g++ -std=c++17 -Wall -o app main.cpp",
            "Build with AddressSanitizer for memory bug detection with g++ -fsanitize=address -g -o test test.cpp",
            "Compile and link with pthread support with g++ -o server server.cpp -lpthread",
        ],
        "gotchas": [
            "g++ links the C++ standard library automatically unlike gcc -- use g++ (not gcc) for C++ code to avoid linker errors",
            "The default C++ standard varies by GCC version -- always specify -std=c++17 or -std=c++20 explicitly for portability",
            "Template errors produce notoriously long error messages -- read from the bottom up to find the actual source of the error",
        ],
        "related": ["gcc", "clang++", "make", "gdb"],
        "difficulty": "intermediate",
    },
    "gawk": {
        "description": "GNU implementation of awk, a pattern-scanning and text-processing language for extracting and transforming structured data. You use gawk for field-based text processing, report generation, and data transformation tasks that are too complex for simple grep/sed pipelines.",
        "flags": {
            "-F": "Set the input field separator (equivalent to setting FS variable)",
            "-v": "Assign a value to a variable before program execution begins",
            "-f": "Read the awk program from a file instead of the command line",
            "-i": "Include an awk source library file",
            "-o": "Enable pretty-printed output to a file",
            "-S": "Run in sandbox mode, disabling system() and I/O redirection",
            "--csv": "Enable proper CSV parsing mode (gawk 5.3+)",
            "--sandbox": "Disable I/O redirection and system() for safe execution",
        },
        "common_patterns": ["gawk -F: '{print $1}' /etc/passwd", "gawk '{sum += $1} END {print sum}' data.txt", "gawk '/pattern/ {print $0}' file.txt"],
        "man_url": "https://www.gnu.org/software/gawk/manual/gawk.html",
        "use_cases": [
            "Use GNU-specific features like FPAT for CSV parsing: gawk -v FPAT='[^,]*|\"[^\"]*\"'",
            "Process multi-dimensional arrays: gawk '{a[$1][$2]+=$3}'",
            "Use networking with /inet/tcp for simple socket programming",
            "Profile awk scripts with --profile for performance analysis",
        ],
        "gotchas": [
            "gawk extensions are not portable to mawk or nawk -- avoid them in scripts that must run on BSD or macOS",
            "The @include directive and @namespace are gawk-only features",
            "gawk is significantly slower than mawk for simple text processing tasks",
        ],
        "related": ["awk", "sed", "perl", "cut"],
        "difficulty": "intermediate",
    },
    "gem": {
        "description": "The package manager for Ruby that installs and manages RubyGems from rubygems.org. It handles downloading, building, installing, and managing Ruby libraries and their dependencies.",
        "flags": {
            "install": "Install a gem and its dependencies from a remote or local source",
            "uninstall": "Remove a gem from the system",
            "list": "List installed gems optionally filtered by name pattern",
            "search": "Search for gems in the remote repository by keyword",
            "update": "Update installed gems to their latest versions",
            "build": "Build a gem from a gemspec file",
            "--no-document": "Skip generating RDoc and ri documentation during install",
            "-v": "Specify the exact version of a gem to install",
            "environment": "Show RubyGems environment info (paths, config)",
            "pristine": "Restore installed gems to their original state",
            "cleanup": "Remove old versions of installed gems",
        },
        "common_patterns": ["gem install gem_name", "gem list --local", "gem update --system", "gem uninstall gem_name"],
        "man_url": "https://guides.rubygems.org/rubygems-basics/",
        "use_cases": [
            "Install a Ruby gem: gem install rails",
            "List installed gems: gem list",
            "Update a specific gem: gem update nokogiri",
            "Search for available gems: gem search json",
            "Uninstall a gem: gem uninstall rails",
        ],
        "gotchas": [
            "Installing gems without a version manager (rbenv, rvm) can pollute the system Ruby and require sudo -- always use a Ruby version manager",
            "gem install does not respect Gemfile constraints -- use bundle install for project-level dependency management",
            "Some gems require native C extensions and need build tools (gcc, make) and system libraries to compile during installation",
        ],
        "related": ["bundle", "ruby", "rbenv"],
        "difficulty": "beginner",
    },
    "getfacl": {
        "description": "Display the Access Control Lists (ACLs) for files and directories, showing fine-grained permissions beyond the standard owner/group/other model. Use it to audit or inspect ACL entries that grant or deny access to specific users or groups.",
        "flags": {
            "-R": "Recurse into subdirectories and list ACLs for all files",
            "-a": "Display the file access ACL only",
            "-d": "Display the default ACL only",
            "-c": "Do not display the comment header",
            "-t": "Use tabular output format",
            "-p": "Display absolute pathnames (do not strip leading slashes)"
        },
        "common_patterns": ["getfacl filename", "getfacl -R /path/to/dir", "getfacl -d directory"],
        "man_url": "https://man7.org/linux/man-pages/man1/getfacl.1.html",
        "use_cases": [
            "View access control lists on a file: getfacl /shared/project",
            "Backup ACLs for restoration: getfacl -R /data > acl_backup.txt",
            "Audit fine-grained permissions beyond standard Unix owner/group/other",
        ],
        "gotchas": [
            "ACLs require filesystem support (ext4, xfs) and must be mounted with acl option",
            "cp and mv may not preserve ACLs by default -- use cp -a or rsync -A",
            "ACL mask can restrict effective permissions below what individual entries grant",
        ],
        "related": ["setfacl", "chmod", "chown", "ls"],
        "difficulty": "advanced",
    },
    "gh": {
        "description": "Official GitHub CLI that brings pull requests, issues, repos, and GitHub Actions to your terminal. You use gh to manage your GitHub workflow entirely from the command line, avoiding context switches to the browser.",
        "flags": {
            "repo clone": "Clone a GitHub repository by owner/repo shorthand",
            "pr create": "Create a pull request from the current branch",
            "pr list": "List pull requests in the repository",
            "issue create": "Open a new issue on the repository",
            "issue list": "List issues with optional state, label, and assignee filters",
            "run list": "List recent GitHub Actions workflow runs",
            "auth login": "Authenticate with your GitHub account",
            "api": "Make authenticated requests to any GitHub REST or GraphQL API endpoint",
        
            "pr view": "View details of a pull request",
            "pr merge": "Merge a pull request",
            "pr checkout": "Check out a pull request branch locally",
            "release create": "Create a new GitHub release",
            "repo fork": "Fork a repository",
            "codespace": "Manage GitHub Codespaces",
            "secret": "Manage repository secrets",
            "variable": "Manage repository variables",
            "--json": "Output specific fields in JSON format",
            "--jq": "Filter JSON output with jq expressions",
        },
        "common_patterns": ["gh repo clone owner/repo", "gh pr create --title 'Fix bug' --body 'Details'", "gh issue list --state open", "gh run list"],
        "man_url": "https://cli.github.com/manual/",
        "use_cases": [
            "Clone a repo by shorthand: gh repo clone owner/repo",
            "Create a pull request from the current branch: gh pr create --fill",
            "List and filter issues: gh issue list --label bug --state open",
            "View CI/CD workflow run status: gh run list",
            "Make an authenticated GitHub API request: gh api repos/owner/repo/releases",
            "Create a new repo from the current directory: gh repo create my-repo --public --source=.",
        ],
        "gotchas": [
            "gh requires authentication first -- run gh auth login before any operations; it supports both browser-based OAuth and personal access tokens",
            "gh pr create uses the current branch's diff against the default branch -- make sure you have committed and pushed your changes first",
            "gh api returns raw JSON; pipe to jq for filtering: gh api repos/owner/repo/issues | jq '.[].title'",
        ],
        "related": ["git", "hub", "tig"],
        "difficulty": "beginner",
    },
    "git-lfs": {
        "description": "Git extension that replaces large files (audio, video, datasets, binaries) with lightweight text pointers while storing actual content on a remote server. You use git-lfs to keep your Git repository small and fast when working with large binary assets.",
        "flags": {
            "install": "Set up Git LFS hooks in the current repository",
            "track": "Start tracking a file pattern with LFS (updates .gitattributes)",
            "untrack": "Stop tracking a file pattern with LFS",
            "ls-files": "List all files currently tracked by LFS in the working copy",
            "fetch": "Download LFS objects from the remote without checking them out",
            "pull": "Fetch and checkout LFS files for the current ref",
            "push": "Push LFS objects to the remote that are referenced by local commits",
            "migrate": "Convert existing files in history to or from LFS tracking",
            "env": "Display the LFS environment configuration",
            "prune": "Delete old LFS files that are no longer referenced",
            "status": "Show the status of LFS files in the working tree",
            "logs": "Show LFS error logs for debugging",
        },
        "common_patterns": ["git lfs install", "git lfs track '*.psd'", "git lfs ls-files", "git lfs migrate import --include='*.bin'"],
        "man_url": "https://git-lfs.com/",
        "use_cases": [
            "Initialize LFS in a repository: git lfs install",
            "Track large file patterns: git lfs track '*.psd' '*.zip'",
            "List all files tracked by LFS: git lfs ls-files",
            "Migrate existing large files to LFS: git lfs migrate import --include='*.bin'",
            "Pull LFS files after cloning: git lfs pull",
        ],
        "gotchas": [
            "git lfs track only updates .gitattributes -- you still need to git add and commit the .gitattributes file",
            "LFS requires a compatible remote server (GitHub, GitLab, Bitbucket all support it) -- self-hosted Git servers need a separate LFS server",
            "Cloning an LFS repo downloads all LFS pointers but fetches only the current revision's files -- use git lfs fetch --all to get all versions",
            "LFS has storage and bandwidth limits on GitHub free plans -- large projects may need paid plans or self-hosted LFS",
        ],
        "related": ["git", "gh"],
        "difficulty": "intermediate",
    },
    "gitk": {
        "description": "Graphical Git repository browser that displays commit history, diffs, and branch topology in a GUI window. You use gitk to visually explore project history, trace file changes across commits, and understand branch relationships.",
        "flags": {
            "--all": "Show all branches and refs, not just the current HEAD",
            "--since": "Show only commits more recent than the specified date",
            "--until": "Show only commits older than the specified date",
            "--max-count": "Limit the number of commits displayed",
            "--date-order": "Sort commits by date rather than topological order",
            "--merge": "Show commits that are involved in current merge conflicts"
        },
        "common_patterns": ["gitk", "gitk --all", "gitk --since='2 weeks ago'", "gitk -- path/to/file"],
        "man_url": "https://git-scm.com/docs/gitk",
        "use_cases": [
            "View the entire commit history graphically: gitk --all",
            "Inspect history of a specific file: gitk -- path/to/file",
            "View recent commits: gitk --since='2 weeks ago'",
            "Explore merge conflicts: gitk --merge",
        ],
        "gotchas": [
            "gitk requires a graphical display (X11/Wayland) -- it will not work over SSH without X forwarding or on headless servers",
            "gitk is part of the git-gui package, which may not be installed by default -- install it separately on some distributions",
            "gitk can be slow on repositories with very large histories -- use --max-count to limit",
        ],
        "related": ["git", "tig", "git-gui"],
        "difficulty": "beginner",
    },
    "go": {
        "description": "The command-line tool for the Go programming language that manages source code, dependencies, compilation, and testing. It provides subcommands for building, running, testing, and managing Go modules.",
        "flags": {
            "build": "Compile Go packages and dependencies into an executable binary",
            "run": "Compile and immediately execute a Go program",
            "test": "Run unit tests and benchmarks for Go packages",
            "get": "Download and install packages and their dependencies",
            "mod": "Manage Go module dependencies and the go.mod file",
            "install": "Compile and install packages and executables to GOPATH/bin",
            "-v": "Print the names of packages as they are compiled",
            "-race": "Enable the data race detector during build or test",
        
            "mod init": "Initialize a new Go module in the current directory",
            "mod tidy": "Add missing and remove unused dependencies",
            "vet": "Report suspicious constructs in Go code",
            "generate": "Run code generation directives in source files",
            "work": "Manage Go workspaces for multi-module development",
            "-ldflags": "Pass flags to the linker (e.g., to set version at build time)",
            "-trimpath": "Remove filesystem paths from compiled binary",
        },
        "common_patterns": ["go build ./...", "go run main.go", "go test ./...", "go mod tidy"],
        "man_url": "https://pkg.go.dev/cmd/go",
        "use_cases": [
            "Initialize a new Go module: go mod init github.com/user/project",
            "Build and run a Go program: go run main.go",
            "Run all tests in the project: go test ./...",
            "Add a dependency: go get github.com/gin-gonic/gin",
            "Tidy up unused dependencies: go mod tidy",
            "Build a static binary: CGO_ENABLED=0 go build -o myapp",
        ],
        "gotchas": [
            "go get now only updates go.mod -- use go install to install executables; go get no longer builds and installs binaries",
            "go mod tidy can remove indirect dependencies that are actually needed -- always run tests after tidying",
            "Go module proxy (GOPROXY) caches modules and can serve stale versions -- set GONOSUMCHECK or GOFLAGS=-mod=mod when debugging dependency issues",
        ],
        "related": ["gofmt", "golint", "delve"],
        "difficulty": "intermediate",
    },
    "gradle": {
        "description": "A build automation tool for JVM projects that uses Groovy or Kotlin DSL for configuration. It supports incremental builds and a build cache for fast Java, Android, and multi-project builds.",
        "flags": {
            "build": "Compile the source code, run tests, and assemble the output",
            "clean": "Delete the build directory and all generated build artifacts",
            "test": "Run the unit test suite for the project",
            "run": "Execute the application main class defined in the build script",
            "--info": "Set the log level to info for more detailed build output",
            "--parallel": "Build independent subprojects in parallel for faster builds",
            "--offline": "Execute the build without accessing network resources",
            "--continuous": "Re-execute tasks automatically when source files change",
            "tasks": "List all available tasks in the project",
            "dependencies": "Display dependency tree",
            "--daemon": "Run using the Gradle daemon (default)",
            "--no-daemon": "Run without the Gradle daemon",
            "--stop": "Stop the Gradle daemon",
            "--refresh-dependencies": "Force refresh of all dependencies",
            "--scan": "Create a build scan for debugging build issues",
            "-x": "Exclude a task from execution",
            "--stacktrace": "Print full stack trace on error",
        },
        "common_patterns": ["gradle build", "gradle clean test", "gradle run", "gradle build --parallel"],
        "man_url": "https://docs.gradle.org/current/userguide/command_line_interface.html",
        "use_cases": [
            "Build the project: gradle build",
            "Run tests: gradle test",
            "Run the application: gradle run",
            "Clean build artifacts and rebuild: gradle clean build",
            "List available tasks: gradle tasks",
            "Build multiple subprojects in parallel: gradle build --parallel",
        ],
        "gotchas": [
            "Use the Gradle wrapper (./gradlew) instead of the system gradle command to ensure the correct Gradle version for each project",
            "Gradle's daemon stays in memory between builds for speed but can consume significant RAM -- use gradle --stop to kill it",
            "Gradle uses Groovy DSL (build.gradle) or Kotlin DSL (build.gradle.kts) -- they are not interchangeable and have different syntax",
            "The --continuous flag watches for file changes and re-runs tasks automatically, but it can miss changes in some edge cases",
        ],
        "related": ["mvn", "java", "javac"],
        "difficulty": "intermediate",
    },
    "groupadd": {
        "description": "Create a new group account on the system with a specified name and optional GID. Use it when setting up access control for shared resources by organizing users into logical groups.",
        "flags": {
            "-g": "Specify the numeric GID for the new group",
            "-r": "Create a system group with a GID from the system group range",
            "-f": "Exit successfully if the group already exists, and force the specified GID if used with -g",
            "-o": "Allow creating a group with a non-unique (duplicate) GID"
        },
        "common_patterns": ["groupadd groupname", "groupadd -g 1001 groupname", "sudo groupadd -r systemgroup"],
        "man_url": "https://man7.org/linux/man-pages/man8/groupadd.8.html",
        "use_cases": [
            "Create a new group: groupadd developers",
            "Create a system group: groupadd -r appservice",
            "Create with specific GID: groupadd -g 1500 team",
        ],
        "gotchas": [
            "Requires root privileges",
            "Does not automatically add any users to the new group -- use usermod -aG",
            "System groups (-r) use GIDs from the system range defined in /etc/login.defs",
        ],
        "related": ["groupdel", "groupmod", "useradd", "usermod"],
        "difficulty": "intermediate",
    },
    "groupdel": {
        "description": "Delete a group account from the system by removing its entry from /etc/group and /etc/gshadow. Use it when a group is no longer needed, but only after ensuring no users have it as their primary group.",
        "flags": {
            "-f": "Force removal even if it is a user's primary group"
        },
        "common_patterns": ["groupdel groupname", "sudo groupdel oldgroup"],
        "man_url": "https://man7.org/linux/man-pages/man8/groupdel.8.html",
        "use_cases": [
            "Remove a group: groupdel oldteam",
            "Clean up groups after project decommissioning",
            "Remove groups as part of user offboarding automation",
        ],
        "gotchas": [
            "Cannot delete a group that is any user's primary group -- change the user's primary group first",
            "Files owned by the deleted group will show a numeric GID instead of a group name",
        ],
        "related": ["groupadd", "groupmod", "userdel", "find"],
        "difficulty": "intermediate",
    },
    "groupmod": {
        "description": "Modify the attributes of an existing group account such as its name or GID. Use it when you need to rename a group or change its numeric group ID without deleting and recreating it.",
        "flags": {
            "-n": "Change the group name to a new name",
            "-g": "Change the numeric group ID to a new GID",
            "-o": "Allow a non-unique (duplicate) GID"
        },
        "common_patterns": ["groupmod -n newname oldname", "groupmod -g 1001 groupname", "sudo groupmod -n developers devs"],
        "man_url": "https://man7.org/linux/man-pages/man8/groupmod.8.html",
        "use_cases": [
            "Rename a group: groupmod -n newname oldname",
            "Change a group's GID: groupmod -g 2000 developers",
            "Modify group properties during organizational changes",
        ],
        "gotchas": [
            "Changing GID does not update file ownership -- run find / -gid OLD_GID -exec chgrp NEW_GID {} +",
            "Renaming a group does not update references in sudoers or other config files",
        ],
        "related": ["groupadd", "groupdel", "usermod", "chgrp"],
        "difficulty": "intermediate",
    },
    "groups": {
        "description": "Print the group memberships for a user, showing both primary and supplementary groups. Use it to quickly check which groups a user belongs to for troubleshooting permission issues.",
        "flags": {},
        "common_patterns": ["groups", "groups username", "groups $(whoami)"],
        "man_url": "https://man7.org/linux/man-pages/man1/groups.1.html",
        "use_cases": [
            "List groups for the current user: groups",
            "Check another user's groups: groups username",
            "Verify group membership after usermod changes",
        ],
        "gotchas": [
            "Group changes from usermod -aG do not take effect until the user logs out and back in (or uses newgrp)",
            "The first group listed is the primary group; others are supplementary",
        ],
        "related": ["id", "newgrp", "usermod", "getent"],
        "difficulty": "beginner",
    },
    "grpck": {
        "description": "Verify the integrity of the group files /etc/group and /etc/gshadow by checking for formatting errors and inconsistencies. Use it as a system administration tool to detect and fix corrupted group database entries.",
        "flags": {
            "-r": "Run in read-only mode without making changes",
            "-s": "Sort entries by GID in /etc/group and /etc/gshadow"
        },
        "common_patterns": ["grpck", "grpck -r", "sudo grpck"],
        "man_url": "https://man7.org/linux/man-pages/man8/grpck.8.html",
        "use_cases": [
            "Verify integrity of /etc/group and /etc/gshadow: grpck",
            "Fix inconsistencies in group databases: grpck -r (read-only check)",
            "Run as part of system health audits",
        ],
        "gotchas": [
            "Must be run as root to modify files; use -r for read-only checks as non-root",
            "Interactive prompts for fixes can be disruptive in automated scripts -- review changes carefully",
        ],
        "related": ["pwck", "groupmod", "vigr", "getent"],
        "difficulty": "advanced",
    },
    "gunzip": {
        "description": "Decompress files compressed with gzip, restoring them to their original name and attributes. You use gunzip to extract .gz files, which is the most common compression format on Unix systems for single files.",
        "flags": {
            "-k": "Keep the original .gz file after decompression",
            "-f": "Force decompression even if the output file already exists",
            "-c": "Write decompressed data to stdout, leaving the original file intact",
            "-l": "List compression statistics (ratio, sizes) without decompressing",
            "-r": "Recursively decompress all .gz files in a directory tree",
            "-t": "Test file integrity without decompressing",
            "-v": "Verbose mode showing filename and compression ratio"
        },
        "common_patterns": ["gunzip file.gz", "gunzip -k file.gz", "gunzip -l file.gz", "gunzip -r /path/to/dir"],
        "man_url": "https://www.gnu.org/software/gzip/manual/gzip.html",
        "use_cases": [
            "Decompress a .gz file: gunzip file.txt.gz",
            "Decompress and keep the original .gz file: gunzip -k file.txt.gz",
            "View compression statistics without decompressing: gunzip -l file.gz",
            "Test file integrity: gunzip -t file.gz",
        ],
        "gotchas": [
            "gunzip is equivalent to gzip -d -- they are the same program; use whichever is more readable in your context",
            "gunzip deletes the .gz file after decompression by default -- use -k to keep both files",
            "If the output file already exists, gunzip will refuse to overwrite unless -f is passed",
        ],
        "related": ["gzip", "zcat", "bzip2", "xz"],
        "difficulty": "beginner",
    },
    "halt": {
        "description": "Instruct the kernel to stop all CPU activity and halt the system without necessarily powering off the hardware. Use it when you want to stop the system in a state where it is safe to turn off the power manually, though on modern systems it often behaves identically to poweroff.",
        "flags": {
            "-f": "Force immediate halt without contacting init",
            "-w": "Only write the wtmp record without actually halting",
            "--no-wall": "Do not send wall message before halting",
            "-p": "Power off the machine after halting"
        },
        "common_patterns": ["sudo halt", "sudo halt -p", "sudo halt -f", "halt --no-wall"],
        "man_url": "https://man7.org/linux/man-pages/man8/halt.8.html",
        "use_cases": [
            "Stop the system without powering off the hardware: sudo halt",
            "On modern systems, halt usually behaves identically to poweroff",
        ],
        "gotchas": [
            "On modern systemd systems, halt, poweroff, and reboot all redirect to systemctl",
            "halt -f forcibly halts without proper shutdown, risking filesystem corruption",
        ],
        "related": ["shutdown", "poweroff", "reboot"],
        "difficulty": "beginner",
    },
    "hash": {
        "description": "Manage the shell's internal hash table that caches the full pathnames of previously executed commands for faster lookup. Use it to view, clear, or manually set cached command paths when the PATH changes or a command has moved.",
        "flags": {
            "-r": "Clear (reset) the entire hash table",
            "-d": "Delete a specific command from the hash table",
            "-l": "Display cached commands in a reusable format",
            "-p": "Associate a specific pathname with a command name in the hash table",
            "-t": "Print the cached path for the specified command name"
        },
        "common_patterns": ["hash", "hash -r", "hash -d command", "hash -p /usr/local/bin/python python"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Clear the command path cache after installing new software: hash -r",
            "See which commands have been cached and their hit counts: hash",
            "Force bash to use a specific path for a command: hash -p /usr/local/bin/python python",
            "Remove a single stale entry: hash -d old_command",
        ],
        "gotchas": [
            "If you install a new version of a command in a different PATH location, bash may still use the old cached path until you run hash -r",
            "hash -r clears the entire table -- there is no way to selectively refresh entries",
            "The hash table is per-shell-session and not shared between terminal windows",
            "In scripts with set -e, hash -d on a command not in the table causes the script to exit",
        ],
        "related": ["command", "type", "which", "enable"],
        "difficulty": "intermediate",
    },
    "helm": {
        "description": "The Kubernetes package manager that installs, upgrades, and manages applications defined as reusable chart templates. You'd use it to deploy complex multi-resource Kubernetes applications with a single command using versioned, configurable charts.",
        "flags": {
            "--set": "Override chart values on the command line as key=value pairs",
            "--values": "Specify a YAML file of values to override chart defaults",
            "--namespace": "Set the Kubernetes namespace for the operation",
            "--create-namespace": "Create the namespace if it does not already exist",
            "--wait": "Wait until all resources are ready before marking success",
            "--timeout": "Set the time to wait for operations to complete",
            "--dry-run": "Simulate the operation and print the rendered manifests",
            "--kube-context": "Specify which kubeconfig context to use",
            "--atomic": "Roll back automatically if the install/upgrade fails",
            "--debug": "Show verbose debug output and rendered templates",
            "template": "Render chart templates locally without deploying",
            "rollback": "Roll back a release to a previous revision",
        },
        "common_patterns": ["helm install myrelease ./mychart", "helm upgrade --install myrelease repo/chart --values values.yaml", "helm list --all-namespaces", "helm uninstall myrelease --namespace production"],
        "man_url": "https://helm.sh/docs/helm/",
        "use_cases": [
            "Install a chart from a repository with helm install myrelease bitnami/nginx",
            "Upgrade a release with new values with helm upgrade myrelease ./mychart --values prod-values.yaml",
            "Preview rendered manifests before applying with helm template myrelease ./mychart",
            "Rollback to a previous release version with helm rollback myrelease 2",
        ],
        "gotchas": [
            "helm install and helm upgrade are separate operations -- use helm upgrade --install for idempotent deployments that work regardless of whether the release exists",
            "Helm stores release metadata as Secrets in the namespace -- deleting those secrets breaks Helm's ability to manage the release",
            "Chart values are merged, not replaced -- nested YAML structures may accumulate unexpected values across upgrades",
            "Always use --dry-run and helm diff (plugin) to preview changes before upgrading production releases",
        ],
        "related": ["kubectl", "minikube", "docker"],
        "difficulty": "intermediate",
    },
    "help": {
        "description": "Display help information for bash shell builtin commands, providing a quick reference without opening a man page. Use it to look up the syntax and options of builtins like cd, export, or alias that are not found via man.",
        "flags": {
            "-d": "Output a short description for each builtin",
            "-m": "Display usage in a man page-like format",
            "-s": "Output only a short usage synopsis"
        },
        "common_patterns": ["help cd", "help export", "help -d '*'", "help -s test"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "use_cases": [
            "Look up syntax for a shell builtin with help test or help [[ when man page is unavailable",
            "Get a quick list of all builtins with help -d '*'",
            "View man-page-style formatted help with help -m export",
        ],
        "gotchas": [
            "help only works for bash builtins -- external commands like grep or find need man instead",
            "help is itself a builtin and is not available in sh or dash -- it is bash-specific",
            "Some builtins have both a help entry and a man page -- the help version covers the bash-specific behavior",
        ],
        "related": ["man", "whatis", "apropos", "info"],
        "difficulty": "beginner",
    },
    "host": {
        "description": "Perform DNS lookups to resolve hostnames to IP addresses and vice versa using a simple, straightforward interface. Use it for quick DNS queries when you need a simpler alternative to dig without the verbose output.",
        "flags": {
            "-t": "Specify the DNS record type to query (A, AAAA, MX, NS, etc.)",
            "-a": "Equivalent to -t ANY, showing all record types",
            "-v": "Verbose output with full DNS response details",
            "-4": "Use IPv4 query transport only",
            "-6": "Use IPv6 query transport only"
        },
        "common_patterns": ["host example.com", "host -t MX example.com", "host 8.8.8.8", "host -a example.com"],
        "man_url": "https://man7.org/linux/man-pages/man1/host.1.html",
        "use_cases": [
            "Quick DNS lookup with clean output: host example.com",
            "Reverse DNS lookup to find hostname for an IP: host 8.8.8.8",
            "Check all record types for a domain: host -a example.com",
        ],
        "gotchas": [
            "host output format varies between versions; scripts should use dig +short for reliable parsing",
            "Like dig, host bypasses /etc/hosts and queries DNS servers directly",
        ],
        "related": ["dig", "nslookup", "whois"],
        "difficulty": "beginner",
    },
    "hostnamectl": {
        "description": "Query and change the system hostname and related machine metadata using systemd. Use it to permanently set the hostname on modern Linux distributions instead of manually editing /etc/hostname.",
        "flags": {
            "status": "Show current hostname and machine info",
            "set-hostname": "Set the system hostname",
            "--static": "Operate on the static hostname only",
            "--transient": "Operate on the transient hostname only",
            "--pretty": "Operate on the pretty hostname (free-form UTF-8)"
        },
        "common_patterns": ["hostnamectl", "sudo hostnamectl set-hostname webserver01", "hostnamectl status", "sudo hostnamectl set-hostname 'Web Server 01' --pretty"],
        "man_url": "https://man7.org/linux/man-pages/man1/hostnamectl.1.html",
        "use_cases": [
            "Permanently set the system hostname: sudo hostnamectl set-hostname webserver01",
            "Display all hostname types and machine info: hostnamectl status",
        ],
        "gotchas": [
            "hostnamectl requires systemd; it does not work on SysVinit systems",
            "Changing the hostname does not update /etc/hosts automatically; update it manually to avoid sudo and other resolution issues",
        ],
        "related": ["hostname", "uname"],
        "difficulty": "beginner",
    },
    "http": {
        "description": "The HTTPie command-line HTTP client that provides a natural, expressive syntax for making HTTP requests with colorized and formatted output. Use it for API testing and development when you want human-readable output without remembering curl's cryptic flag combinations.",
        "flags": {
            "--json": "Send data as JSON (default for non-form data)",
            "--form": "Send data as form-encoded",
            "--auth": "Specify username:password for authentication",
            "--verify": "Control SSL certificate verification (yes/no/path)",
            "--output": "Save the response body to a file",
            "--print": "Control which parts of the request/response to print (HhBb)",
            "--download": "Download the response body to a file",
            "--session": "Create or reuse a named session with persistent headers/cookies",
            "--timeout": "Set the request timeout in seconds",
        },
        "common_patterns": ["http GET https://api.example.com/data", "http POST https://api.example.com/items name=test", "http --auth user:pass GET https://api.example.com", "http --print=HhBb https://example.com"],
        "man_url": "https://httpie.io/docs/cli",
        "use_cases": [
            "Quick API testing with readable output: http GET https://api.example.com/users",
            "POST JSON data intuitively: http POST api.example.com/items name=widget price:=9.99",
            "Download a file: http --download https://example.com/file.zip",
            "Debug HTTP by printing full request and response: http --print=HhBb example.com",
        ],
        "gotchas": [
            "HTTPie uses 'http' as the command name, which can conflict with other tools; the package name is 'httpie'",
            "The := syntax sends raw JSON values (numbers, booleans); = sends strings -- mixing them up causes type errors in APIs",
            "HTTPie follows redirects by default (unlike curl), which may hide redirect issues during debugging",
        ],
        "related": ["curl", "wget"],
        "difficulty": "beginner",
    },
    "httpie": {
        "description": "A user-friendly command-line HTTP client with intuitive syntax, JSON support, and colorized output designed as a modern alternative to curl. Use it when you want readable, well-formatted HTTP request/response output for API testing and debugging.",
        "flags": {
            "--json": "Set Content-Type to application/json and serialize data as JSON",
            "--form": "Send data as a form submission",
            "--auth": "Specify username:password for authentication",
            "--verify": "Control SSL certificate verification",
            "--output": "Save response body to a file",
            "--follow": "Follow HTTP redirects"
        },
        "common_patterns": ["http GET https://api.example.com/users", "http POST https://api.example.com/users name=John", "http --auth user:pass https://api.example.com", "http PUT https://api.example.com/item/1 data=value"],
        "man_url": "https://httpie.io/docs/cli",
        "use_cases": [
            "Test REST APIs with human-friendly output formatting and syntax highlighting",
            "Submit forms: http --form POST example.com/login username=admin password=secret",
            "Send authenticated requests: http --auth user:pass GET api.example.com/data",
        ],
        "gotchas": [
            "httpie is the package name; the actual command is 'http' (or 'https' for HTTPS)",
            "HTTPie 3.x changed some defaults from 2.x; check the changelog when upgrading",
        ],
        "related": ["curl", "wget", "http"],
        "difficulty": "beginner",
    },
    "hub": {
        "description": "Command-line wrapper around Git that adds GitHub-specific features like forking, pull requests, and repository creation. You use hub as a drop-in replacement for git that makes GitHub operations feel like native git commands.",
        "flags": {
            "clone": "Clone a repo using shorthand owner/repo notation",
            "fork": "Fork the current repository on GitHub and add a remote",
            "create": "Create a new GitHub repository from the current local repo",
            "pull-request": "Open a pull request from the current branch",
            "browse": "Open the repository page in your web browser",
            "ci-status": "Show CI status for the current branch",
            "sync": "Fetch and fast-forward the default branch",
            "release": "Manage GitHub releases",
            "issue": "Create and list GitHub issues",
        },
        "common_patterns": ["hub clone owner/repo", "hub create -p", "hub pull-request -m 'My PR'", "hub browse"],
        "man_url": "https://hub.github.com/hub.1.html",
        "use_cases": [
            "Clone a repo by shorthand: hub clone owner/repo",
            "Fork the current repo and add a remote: hub fork",
            "Create a pull request: hub pull-request -m 'My PR title'",
            "Open the repo page in a browser: hub browse",
            "Create a new GitHub repository: hub create my-new-repo",
        ],
        "gotchas": [
            "hub is deprecated in favor of GitHub CLI (gh) -- GitHub recommends migrating to gh for active support and new features",
            "hub can be aliased to git (alias git=hub) to seamlessly extend git commands, but this can cause confusion when sharing scripts",
            "hub uses GITHUB_TOKEN environment variable for authentication, while gh uses its own credential store",
        ],
        "related": ["gh", "git", "tig"],
        "difficulty": "intermediate",
    },
    "ifconfig": {
        "description": "Display and configure network interface parameters including IP addresses, netmasks, and hardware addresses. Use it for quick network interface inspection, though the ip command is its modern replacement with more features and consistent syntax.",
        "flags": {
            "-a": "Display all interfaces including those that are down",
            "-s": "Display a short summary of each interface",
            "up": "Activate the specified network interface",
            "down": "Deactivate the specified network interface",
            "netmask": "Set the subnet mask for the interface",
            "broadcast": "Set the broadcast address for the interface"
        },
        "common_patterns": ["ifconfig", "ifconfig -a", "sudo ifconfig eth0 192.168.1.10 netmask 255.255.255.0", "sudo ifconfig eth0 down"],
        "man_url": "https://man7.org/linux/man-pages/man8/ifconfig.8.html",
        "use_cases": [
            "Quick check of your IP address: ifconfig (or ifconfig eth0 for a specific interface)",
            "Temporarily assign an IP address: ifconfig eth0 192.168.1.100 netmask 255.255.255.0",
            "Bring an interface up or down: ifconfig eth0 up / ifconfig eth0 down",
        ],
        "gotchas": [
            "ifconfig is deprecated in favor of the ip command on modern Linux systems -- it may not be installed by default",
            "ifconfig cannot display or manage multiple IP addresses per interface properly; ip addr handles this correctly",
            "On many modern distros, ifconfig is in /sbin which may not be in a regular user's PATH",
        ],
        "related": ["ip", "route", "netstat"],
        "difficulty": "beginner",
    },
    "info": {
        "description": "Read documentation in GNU info format, which provides hyperlinked, hierarchically organized pages with more detail than traditional man pages. Use it when man page coverage is sparse and the program ships GNU info documentation instead.",
        "flags": {
            "-f": "Specify the info file to display",
            "-n": "Go directly to the specified node within the info document",
            "-w": "Print the location of the info file without displaying it",
            "--vi-keys": "Use vi-like key bindings for navigation"
        },
        "common_patterns": ["info coreutils", "info bash", "info grep", "info -n 'Invoking' tar"],
        "man_url": "https://www.gnu.org/software/texinfo/manual/info-stnd/info-stnd.html",
        "use_cases": [
            "Read detailed GNU coreutils documentation with info coreutils for comprehensive examples",
            "Navigate directly to a specific topic with info bash 'Shell Expansions'",
            "Read info pages that contain more detail than their man page counterparts, especially for GNU tools",
        ],
        "gotchas": [
            "info uses Emacs-style navigation by default (Ctrl+F forward, Ctrl+B back, Tab for links) -- use --vi-keys for vi-style",
            "Not all commands have info pages -- if no info page exists, info falls back to displaying the man page",
            "The info reader is separate from man -- info coreutils has a full tutorial that man pages lack",
        ],
        "related": ["man", "help", "whatis", "apropos"],
        "difficulty": "beginner",
    },
    "init": {
        "description": "The first process started by the kernel that becomes the ancestor of all other processes and manages system runlevels. Use it to switch runlevels on SysVinit systems, such as transitioning to single-user mode for maintenance.",
        "flags": {
            "0": "Halt the system (runlevel 0)",
            "1": "Switch to single-user mode for maintenance",
            "3": "Switch to multi-user mode without GUI",
            "5": "Switch to multi-user mode with GUI",
            "6": "Reboot the system (runlevel 6)"
        },
        "common_patterns": ["sudo init 0", "sudo init 6", "sudo init 1", "sudo init 3"],
        "man_url": "https://man7.org/linux/man-pages/man1/init.1.html",
        "use_cases": [
            "Switch to single-user mode for emergency maintenance: sudo init 1",
            "On SysVinit systems, change runlevels to control which services run",
        ],
        "gotchas": [
            "On systemd systems, init is symlinked to systemd; use systemctl isolate instead of init for changing targets",
            "init 0 halts and init 6 reboots; confusing these can be catastrophic on remote servers",
        ],
        "related": ["systemctl", "runlevel", "shutdown"],
        "difficulty": "advanced",
    },
    "iostat": {
        "description": "Report CPU utilization and disk I/O statistics for devices and partitions, helping identify storage bottlenecks. Use it to determine whether slow performance is caused by disk throughput limits, high I/O wait times, or CPU saturation.",
        "flags": {
            "-c": "Display only CPU utilization statistics",
            "-d": "Display only device utilization statistics",
            "-x": "Display extended statistics including await, svctm, and utilization",
            "-h": "Human-readable output with units",
            "-k": "Display statistics in kilobytes per second",
            "-m": "Display statistics in megabytes per second"
        },
        "common_patterns": ["iostat", "iostat -x 1 5", "iostat -d -x", "iostat -c 2"],
        "man_url": "https://man7.org/linux/man-pages/man1/iostat.1.html",
        "use_cases": [
            "Identify disk bottlenecks: iostat -x 1 (watch the %util and await columns)",
            "Monitor disk throughput in human-readable format: iostat -h 1",
            "Determine if slow performance is disk-related by checking average wait times",
        ],
        "gotchas": [
            "iostat is part of the sysstat package and may not be installed by default",
            "Like vmstat, the first report shows averages since boot; subsequent reports show current intervals",
            "%util at 100% does not always mean the disk is saturated (especially for SSDs and RAID arrays that handle concurrent I/O)",
        ],
        "related": ["vmstat", "sar", "iotop"],
        "difficulty": "intermediate",
    },
    "java": {
        "description": "The Java Virtual Machine launcher that executes compiled Java bytecode class files and JAR archives. You'd use it to run Java applications with options to tune memory allocation, garbage collection, and JVM behavior.",
        "flags": {
            "-jar": "Execute a program from a JAR file using its manifest Main-Class",
            "-cp": "Set the classpath for finding application classes and resources",
            "-Xmx": "Set the maximum heap memory size (e.g., -Xmx2g for 2 gigabytes)",
            "-Xms": "Set the initial heap memory size",
            "-D": "Set a system property as a key=value pair",
            "-verbose": "Enable verbose output for class loading, gc, or jni",
            "-XX:+UseG1GC": "Select the G1 garbage collector for balanced throughput",
            "-ea": "Enable Java assertion checking at runtime",
            "--add-modules": "Add modules to the module graph for compatibility",
            "--add-opens": "Open a module's packages for deep reflection access",
            "-Xss": "Set thread stack size",
        },
        "common_patterns": ["java -jar app.jar", "java -cp classes:lib/* com.example.Main", "java -Xmx4g -Xms1g -jar server.jar", "java -D\"config.path=/etc/app\" MainApp"],
        "man_url": "https://docs.oracle.com/en/java/javase/21/docs/specs/man/java.html",
        "use_cases": [
            "Run a JAR application with java -jar app.jar",
            "Run a class with specific memory limits with java -Xmx4g -Xms1g -cp classes com.example.Main",
            "Run a single-file source program directly with java Main.java (Java 11+)",
        ],
        "gotchas": [
            "JAVA_HOME must be set correctly -- many tools rely on it and misconfiguration causes confusing errors",
            "-Xmx sets the maximum heap but the JVM uses additional memory for stack, metaspace, and native allocations -- total memory usage is always higher",
            "Classpath separator is : on Unix but ; on Windows -- cross-platform scripts need to handle this",
            "Java 9+ introduced the module system (JPMS) which can cause 'module not found' errors with older code -- use --add-modules or --add-opens for compatibility",
        ],
        "related": ["javac", "mvn", "gradle"],
        "difficulty": "intermediate",
    },
    "javac": {
        "description": "The Java compiler that translates Java source files into platform-independent bytecode class files for the JVM. You'd use it to compile Java programs, with options to control language version, classpath, and debug information.",
        "flags": {
            "-d": "Set the destination directory for generated class files",
            "-cp": "Specify the classpath for finding dependent classes",
            "-source": "Set the Java language version accepted by the compiler",
            "-target": "Generate class files for the specified JVM version",
            "--release": "Compile for a specific Java SE release version",
            "-g": "Generate all debugging information including local variables",
            "-Xlint": "Enable recommended compiler warnings",
            "-verbose": "Output messages about what the compiler is doing"
        },
        "common_patterns": ["javac Main.java", "javac -d out/ -cp lib/* src/*.java", "javac --release 17 -d build/ Main.java", "javac -Xlint:all -Werror Main.java"],
        "man_url": "https://docs.oracle.com/en/java/javase/21/docs/specs/man/javac.html",
        "use_cases": [
            "Compile a Java file with javac Main.java",
            "Compile to a specific output directory with javac -d build/ src/*.java",
            "Compile for a specific Java release with javac --release 17 Main.java",
        ],
        "gotchas": [
            "javac requires all dependent classes on the classpath -- missing dependencies cause compilation errors even if the source is correct",
            "The --release flag is preferred over -source/-target combination because it also checks API availability",
            "javac only compiles .java files explicitly listed -- use build tools (Maven, Gradle) for multi-module projects",
        ],
        "related": ["java", "mvn", "gradle"],
        "difficulty": "intermediate",
    },
    "jsonnet": {
        "description": "A data templating language and processor that generates JSON, YAML, or other structured data from parameterized templates. You'd use it to manage complex configurations for Kubernetes, Terraform, or other systems that consume JSON.",
        "flags": {
            "-e": "Treat the argument as Jsonnet code instead of a filename",
            "-o": "Write output to a file instead of stdout",
            "-m": "Write multiple output files to a directory",
            "-S": "Expect output to be a string and render as plain text",
            "-J": "Add a directory to the library search path",
            "--ext-str": "Pass an external string variable to the template",
            "--ext-code": "Pass an external code variable to the template",
            "--tla-str": "Pass a top-level string argument to the template"
        },
        "common_patterns": ["jsonnet template.jsonnet", "jsonnet -e '{ a: 1+1 }'", "jsonnet -m outputdir/ multi.jsonnet", "jsonnet --ext-str env=prod config.jsonnet"],
        "man_url": "https://jsonnet.org/ref/language.html",
        "use_cases": [
            "Generate Kubernetes manifests from templates with jsonnet -J lib/ -m output/ k8s.jsonnet",
            "Evaluate a simple expression with jsonnet -e '{ result: 1 + 2 }'",
            "Pass external variables for environment-specific config with jsonnet --ext-str env=prod config.jsonnet",
        ],
        "gotchas": [
            "Jsonnet is purely functional with no side effects -- you cannot read files or make network calls from Jsonnet code",
            "Output is JSON by default -- use -S for string output or -y for YAML (if using the Go implementation)",
            "Jsonnet evaluation is lazy -- errors in unused branches are not reported until those branches are actually referenced",
        ],
        "related": ["jq", "yq", "kubectl", "terraform"],
        "difficulty": "advanced",
    },
    "kotlin": {
        "description": "The Kotlin compiler and interactive shell that compiles Kotlin source code to JVM bytecode or runs Kotlin scripts. You'd use it to compile Kotlin files directly without a build tool or to run quick Kotlin scripts from the command line.",
        "flags": {
            "-d": "Set the output directory or JAR file for compiled classes",
            "-include-runtime": "Bundle the Kotlin runtime into the output JAR",
            "-classpath": "Specify the classpath for compilation dependencies",
            "-nowarn": "Suppress all compiler warning messages",
            "-verbose": "Enable verbose logging of the compilation process",
            "-script": "Evaluate the given Kotlin script file",
            "-progressive": "Enable progressive mode for stricter compilation"
        },
        "common_patterns": ["kotlinc hello.kt -include-runtime -d hello.jar", "kotlin hello.jar", "kotlinc -script script.kts", "kotlinc -classpath lib.jar main.kt -d out.jar"],
        "man_url": "https://kotlinlang.org/docs/command-line.html",
        "use_cases": [
            "Compile and bundle a self-contained JAR with kotlinc hello.kt -include-runtime -d hello.jar",
            "Run a Kotlin script with kotlinc -script script.kts",
            "Start the Kotlin REPL for quick prototyping with kotlinc",
        ],
        "gotchas": [
            "kotlinc without -include-runtime creates a JAR that requires the Kotlin runtime on the classpath -- use -include-runtime for standalone JARs",
            "The kotlin command runs JARs while kotlinc compiles -- they are separate tools",
            "Kotlin scripts (.kts) cannot import local .kt files without additional configuration -- use a build tool for multi-file projects",
        ],
        "related": ["java", "javac", "gradle", "scala"],
        "difficulty": "intermediate",
    },
    "last": {
        "description": "Display a listing of the most recent user login sessions by reading /var/log/wtmp, showing login times, durations, and source addresses. Use it to investigate login history, track down unauthorized access, or verify when users were active.",
        "flags": {
            "-n": "Show only the specified number of most recent entries",
            "-a": "Display the hostname in the last column for better formatting",
            "-x": "Display system shutdown and runlevel change entries",
            "-f": "Use a specific wtmp file instead of the default",
            "-i": "Show IP addresses instead of hostnames",
            "-R": "Suppress display of the hostname field",
            "-F": "Show full login and logout times",
        },
        "common_patterns": ["last", "last -n 10", "last username", "last reboot"],
        "man_url": "https://man7.org/linux/man-pages/man1/last.1.html",
        "use_cases": [
            "View recent login history: last",
            "Check logins for a specific user: last username",
            "View reboot history: last reboot",
        ],
        "gotchas": [
            "last reads /var/log/wtmp which may be rotated -- old entries are lost after rotation",
            "Still-logged-in sessions show 'still logged in' with no duration",
            "System clock changes can make timestamps inaccurate in the log",
        ],
        "related": ["lastlog", "w", "who", "utmpdump"],
        "difficulty": "beginner",
    },
    "lastlog": {
        "description": "Display the most recent login for all user accounts or a specific user by reading /var/log/lastlog. Use it to audit which accounts have been used recently and which may be stale or unused.",
        "flags": {
            "-u": "Display lastlog record for the specified user only",
            "-b": "Show only users who have not logged in for more than the specified number of days",
            "-t": "Show only users who have logged in within the specified number of days"
        },
        "common_patterns": ["lastlog", "lastlog -u username", "lastlog -t 30"],
        "man_url": "https://man7.org/linux/man-pages/man8/lastlog.8.html",
        "use_cases": [
            "Show last login time for all users: lastlog",
            "Check when a specific user last logged in: lastlog -u username",
            "Find accounts that have never logged in: lastlog | grep 'Never'",
        ],
        "gotchas": [
            "lastlog reads /var/log/lastlog which uses a sparse file indexed by UID -- very high UIDs can make this file large",
            "Service accounts show 'Never logged in' which is expected, not a problem",
        ],
        "related": ["last", "who", "w", "faillog"],
        "difficulty": "beginner",
    },
    "ld": {
        "description": "The GNU linker that combines object files and libraries into a single executable or shared library binary. You'd use it to link compiled object files together, though it is usually invoked automatically by the compiler driver (gcc/clang).",
        "flags": {
            "-o": "Specify the name of the output executable or library",
            "-l": "Link against the named library (searches lib<name>.a or .so)",
            "-L": "Add a directory to the library search path",
            "-T": "Use a custom linker script for memory layout control",
            "-r": "Generate relocatable output for incremental linking",
            "-shared": "Create a shared library instead of an executable",
            "-Map": "Write a link map file showing symbol and section placement",
            "--gc-sections": "Remove unused sections to reduce binary size",
            "-static": "Do not link against shared libraries",
            "-pie": "Create a position-independent executable",
            "--as-needed": "Only link libraries that resolve undefined symbols",
        },
        "common_patterns": ["ld -o program main.o utils.o -lc", "ld -shared -o libfoo.so foo.o", "ld -r -o combined.o file1.o file2.o", "ld -T linker.ld -o firmware.elf startup.o main.o"],
        "man_url": "https://sourceware.org/binutils/docs/ld/",
        "use_cases": [
            "Link object files into an executable with ld -o program main.o utils.o -lc",
            "Create a shared library with ld -shared -o libfoo.so foo.o",
            "Use a custom linker script for embedded firmware with ld -T linker.ld -o firmware.elf startup.o main.o",
        ],
        "gotchas": [
            "ld is usually invoked indirectly through gcc or clang which add necessary startup files and library paths -- calling ld directly requires specifying crt0.o and other platform files",
            "Library order matters: ld processes libraries left to right and only includes symbols needed at that point -- put -l flags after the .o files that need them",
            "ld uses the system default linker script unless -T is specified -- this controls memory layout and is critical for embedded/OS development",
        ],
        "related": ["gcc", "as", "ar", "nm", "ldd"],
        "difficulty": "advanced",
    },
    "ldd": {
        "description": "A utility that prints the shared library dependencies required by a dynamically linked executable or shared library. You'd use it to troubleshoot missing library errors, verify linking, or understand an application's runtime dependencies.",
        "flags": {
            "-v": "Print all information including symbol versioning data",
            "-u": "Print unused direct dependencies",
            "-d": "Perform data relocations and report missing objects",
            "-r": "Perform relocations for both data and functions and report missing items"
        },
        "common_patterns": ["ldd /usr/bin/python3", "ldd -v ./myapp", "ldd /usr/lib/libssl.so", "ldd -u ./program"],
        "man_url": "https://man7.org/linux/man-pages/man1/ldd.1.html",
        "use_cases": [
            "Find all shared library dependencies of a binary with ldd ./myapp",
            "Diagnose 'cannot open shared object file' errors by checking which libraries are missing",
            "Verify that a binary links to the expected version of a library with ldd -v ./myapp",
        ],
        "gotchas": [
            "NEVER run ldd on untrusted binaries -- ldd can execute the binary's code to resolve dependencies, which is a security risk. Use objdump -p or readelf -d instead",
            "ldd shows the resolved paths at the current moment -- results depend on LD_LIBRARY_PATH and ldconfig cache",
            "If ldd shows 'not found' for a library, the library is either not installed or not in the linker search path -- fix with ldconfig or LD_LIBRARY_PATH",
        ],
        "related": ["readelf", "nm", "ldconfig", "objdump"],
        "difficulty": "intermediate",
    },
    "let": {
        "description": "Evaluate arithmetic expressions in the shell, assigning results to variables or testing numeric conditions. Use it as a concise way to perform integer math directly in bash without external tools like expr or bc.",
        "flags": {},
        "common_patterns": ["let x=5+3", "let 'count++'", "let 'result = a * b'"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "use_cases": [
            "Increment a counter: let count++",
            "Perform arithmetic assignment: let 'result = a + b'",
            "Multiple operations: let 'x = 5' 'y = x * 2'",
            "Evaluate a condition arithmetically: let 'x > 0' (returns 0 if true)",
        ],
        "gotchas": [
            "let with an expression that evaluates to 0 returns exit code 1 (failure) -- let 'x = 0' returns 1, which triggers set -e",
            "let only handles integer arithmetic -- no floating point support",
            "Quoting is important: let x = 5 fails (spaces make them separate arguments); use let 'x = 5' or let x=5",
            "Prefer (( )) arithmetic syntax in modern bash: (( count++ )) is clearer than let 'count++'",
        ],
        "related": ["expr", "bc"],
        "difficulty": "intermediate",
    },
    "lf": {
        "description": "A terminal file manager written in Go, inspired by ranger, with a single-column layout and scriptable configuration. Use it as a fast, minimal alternative to ranger when you want a customizable terminal file manager with low resource usage.",
        "flags": {
            "-command": "Execute a command after startup",
            "-doc": "Print the documentation",
            "-last-dir-path": "Write the last visited directory to a file on exit",
            "-selection-path": "Write the selected file paths to a file on exit",
            "-version": "Print version information"
        },
        "common_patterns": ["lf", "lf /path/to/dir", "lf -last-dir-path=/tmp/lfdir"],
        "man_url": "https://github.com/gokcehan/lf",
        "use_cases": [
            "Navigate files with a ranger-like interface but faster startup due to Go implementation",
            "Configure custom file openers and previews through the lfrc configuration file",
            "Use with fzf for fuzzy file search within the file manager",
        ],
        "gotchas": [
            "lf configuration uses its own command language, not shell script -- refer to lf -doc for syntax",
            "Like nnn and ranger, cd-on-quit requires a shell wrapper function -- use the lfcd function from the documentation",
            "lf defaults to a single-column view unlike ranger's three-column layout -- customize with set ratios",
        ],
        "related": ["ranger", "nnn", "mc", "broot"],
        "difficulty": "intermediate",
    },
    "lldb": {
        "description": "The LLVM project debugger that provides source-level debugging for C, C++, Objective-C, and Swift programs. You'd use it as the default debugger on macOS or as a GDB alternative on Linux for inspecting crashes, setting breakpoints, and stepping through code.",
        "flags": {
            "-f": "Specify the executable file to debug",
            "--arch": "Set the target architecture for the debug session",
            "-c": "Load a core dump file for post-mortem debugging",
            "-o": "Execute debugger commands after loading the target",
            "-O": "Execute debugger commands before loading the target",
            "-s": "Source a file of debugger commands after loading",
            "-n": "Attach to a running process by name",
            "-p": "Attach to a running process by its process ID"
        },
        "common_patterns": ["lldb ./program", "lldb -c core.dump ./program", "lldb -o 'run' -o 'bt' -- ./program arg1", "lldb -p 12345"],
        "man_url": "https://lldb.llvm.org/use/tutorial.html",
        "use_cases": [
            "Debug a program on macOS with lldb ./program (lldb is the default macOS debugger)",
            "Attach to a running process with lldb -p $(pgrep myapp)",
            "Analyze a core dump with lldb -c core ./program for post-mortem debugging",
        ],
        "gotchas": [
            "lldb commands differ from gdb: use 'thread backtrace' instead of 'bt', 'breakpoint set -n main' instead of 'break main'",
            "On macOS, codesigning is required to debug other processes -- lldb shipped with Xcode has the proper entitlements",
            "lldb uses the LLVM expression parser which can evaluate C++ and Swift but has quirks with complex template expressions",
        ],
        "related": ["gdb", "clang", "valgrind"],
        "difficulty": "intermediate",
    },
    "localectl": {
        "description": "Query and change the system locale and keyboard layout settings using systemd. Use it to set the language, character encoding, and keyboard mapping on modern Linux distributions without manually editing locale configuration files.",
        "flags": {
            "status": "Show current locale and keyboard settings",
            "set-locale": "Set the system locale (e.g., LANG=en_US.UTF-8)",
            "set-keymap": "Set the console keyboard mapping",
            "set-x11-keymap": "Set the X11 keyboard mapping",
            "list-locales": "List available locales",
            "list-keymaps": "List available console keymaps"
        },
        "common_patterns": ["localectl", "sudo localectl set-locale LANG=en_US.UTF-8", "localectl list-locales", "sudo localectl set-keymap us"],
        "man_url": "https://man7.org/linux/man-pages/man1/localectl.1.html",
        "use_cases": [
            "View current locale settings: localectl",
            "Set the system locale: sudo localectl set-locale LANG=en_US.UTF-8",
            "Change the keyboard layout: sudo localectl set-keymap us",
        ],
        "gotchas": [
            "localectl changes are system-wide and require root; they take effect on next login, not the current session",
            "The locale must be generated first (with locale-gen or similar) before it can be set with localectl",
        ],
        "related": ["timedatectl", "hostnamectl"],
        "difficulty": "beginner",
    },
    "lsblk": {
        "description": "List information about all available block devices in a tree format showing relationships between disks, partitions, and mount points. You use lsblk to get a quick overview of your storage layout without needing root privileges.",
        "flags": {
            "-a": "Show all devices including empty ones",
            "-f": "Show filesystem info (type, label, UUID, mount point)",
            "-l": "Use list format instead of the default tree format",
            "-o": "Specify which output columns to display (e.g., NAME,SIZE,TYPE,MOUNTPOINT)",
            "-b": "Print sizes in bytes instead of human-readable format",
            "-d": "Show only disks, not their partitions or holders",
            "-n": "Suppress the column header line",
            "-p": "Print full device paths"
        },
        "common_patterns": ["lsblk", "lsblk -f", "lsblk -o NAME,SIZE,TYPE,MOUNTPOINT", "lsblk -d"],
        "man_url": "https://man7.org/linux/man-pages/man8/lsblk.8.html",
        "use_cases": [
            "List all block devices and their mount points: lsblk",
            "Show filesystem type and size: lsblk -f",
            "Identify disk partitions and their hierarchy",
        ],
        "gotchas": [
            "Does not show unpartitioned space; use fdisk -l for that",
            "Loop devices from snap packages can clutter the output",
        ],
        "related": ["blkid", "fdisk", "mount", "df"],
        "difficulty": "beginner",
    },
    "lsd": {
        "description": "A modern replacement for ls with color-coded output, file type icons, and tree-view support built in Rust. Use it for visually enhanced directory listings when you want a more readable ls with git-awareness and Nerd Font icons.",
        "flags": {
            "-l": "Use long listing format with details",
            "-a": "Show all files including hidden ones",
            "-t": "Sort by modification time",
            "--tree": "Display entries in a tree-like format",
            "--depth": "Set the depth for tree display",
            "-S": "Sort by file size",
            "-r": "Reverse the sort order",
            "--icon": "Set icon display mode (always, auto, never)",
            "--blocks": "Configure which metadata blocks to show",
            "--date": "Set date format (date, relative, +format-string)",
            "--group-directories-first": "List directories before files",
            "--no-symlink": "Do not follow symbolic links",
        },
        "common_patterns": ["lsd", "lsd -la", "lsd --tree", "lsd --tree --depth 2"],
        "man_url": "https://github.com/lsd-rs/lsd",
        "use_cases": [
            "Get a visually rich directory listing with lsd -la for quick file inspection",
            "View a colorful directory tree with lsd --tree --depth 2",
            "Sort files by size to find large files with lsd -lS",
        ],
        "gotchas": [
            "lsd requires a Nerd Font for icons to render correctly -- without it icons appear as broken characters",
            "lsd's flag compatibility with ls is intentional but not 100% -- some obscure ls flags may not work",
            "Color output is on by default which can interfere with pipe processing -- use --color never for scripts",
        ],
        "related": ["ls", "exa", "tree"],
        "difficulty": "beginner",
    },
    "ltrace": {
        "description": "Trace dynamic library calls made by a running program, showing function names, arguments, and return values. Use it to debug programs at the library level when strace (system calls) is too low-level and you want to see calls to libc, libm, or other shared libraries.",
        "flags": {
            "-p": "Attach to an existing process by PID",
            "-e": "Filter which library calls to trace",
            "-o": "Write output to a file instead of stderr",
            "-c": "Count time and calls for each library function and print summary",
            "-S": "Also display system calls in addition to library calls",
            "-f": "Follow child processes created by fork"
        },
        "common_patterns": ["ltrace ./myprogram", "ltrace -p 1234", "ltrace -e malloc+free ./myprogram", "ltrace -c ./myprogram"],
        "man_url": "https://man7.org/linux/man-pages/man1/ltrace.1.html",
        "use_cases": [
            "Trace library calls: ltrace ./program",
            "Debug shared library loading issues: ltrace -e dlopen ./prog",
            "Compare library call patterns between program versions",
        ],
        "gotchas": [
            "ltrace does not work with statically linked binaries -- only dynamic libraries are traced",
            "Significant performance overhead, similar to strace",
            "May not be installed by default on minimal systems",
        ],
        "related": ["strace", "ldd", "nm", "objdump"],
        "difficulty": "advanced",
    },
    "lz4": {
        "description": "Extremely fast compression and decompression tool optimized for speed over compression ratio. You use lz4 when you need the fastest possible compression, such as for real-time data pipelines, temporary backups, or filesystem compression.",
        "flags": {
            "-d": "Decompress the input file",
            "-f": "Force overwrite of existing output files without prompting",
            "-k": "Keep the source file after compression or decompression",
            "-c": "Write output to standard output (stdout)",
            "-1": "Fastest compression (default), lowest ratio",
            "-9": "Best compression ratio, slower speed",
            "-v": "Verbose mode showing compression statistics",
            "-m": "Compress multiple files (appends .lz4 suffix to each)",
            "-b": "Benchmark mode: measure compression/decompression speed",
            "-B": "Set block size for compression",
            "--content-size": "Store original content size in the frame header",
        },
        "common_patterns": ["lz4 file.txt", "lz4 -d file.lz4", "lz4 -9 -k largefile.dat", "lz4 -c file.txt > file.lz4"],
        "man_url": "https://github.com/lz4/lz4/blob/dev/programs/lz4.1.md",
        "use_cases": [
            "Compress a file extremely fast: lz4 file.txt",
            "Decompress a .lz4 file: lz4 -d file.lz4",
            "Compress with higher ratio (slower): lz4 -9 file.txt",
            "Compress and keep the original: lz4 -k file.txt",
            "Benchmark compression speed: lz4 -b file.txt",
        ],
        "gotchas": [
            "lz4 prioritizes speed over compression ratio -- files will be larger than gzip output but compress/decompress much faster",
            "lz4 is ideal for real-time applications like filesystem compression (btrfs/zfs), database pages, and network compression",
            "lz4 replaces the original file by default -- use -k to keep it",
        ],
        "related": ["zstd", "gzip", "lzop"],
        "difficulty": "beginner",
    },
    "lzop": {
        "description": "Compress and decompress files using the LZO algorithm, prioritizing speed over compression ratio. You use lzop when you need very fast compression for large files or real-time applications where speed matters more than file size.",
        "flags": {
            "-d": "Decompress the input file(s)",
            "-c": "Write output to standard output, keep original files",
            "-f": "Force overwrite of existing output files",
            "-k": "Keep the original files after compression or decompression",
            "-v": "Verbose mode showing compression statistics",
            "-t": "Test the integrity of compressed files",
            "-l": "List contents and compression info of .lzo files",
            "-1": "Fastest compression (least ratio)",
            "-9": "Best compression ratio (slowest)"
        },
        "common_patterns": ["lzop file.txt", "lzop -d file.lzo", "lzop -9 largefile.dat", "lzop -tv archive.lzo"],
        "man_url": "https://www.lzop.org/lzop_man.php",
        "use_cases": [
            "Compress a file fast: lzop file.txt",
            "Decompress a .lzo file: lzop -d file.lzo",
            "Compress with best ratio: lzop -9 file.txt",
            "Test archive integrity: lzop -t file.lzo",
        ],
        "gotchas": [
            "lzop is an older speed-focused compressor; lz4 and zstd have largely replaced it for most use cases",
            "lzop replaces the original file by default -- use -k to keep it",
        ],
        "related": ["lz4", "gzip", "zstd"],
        "difficulty": "intermediate",
    },
    "masscan": {
        "description": "An extremely fast port scanner capable of scanning the entire Internet in under 6 minutes by using asynchronous packet transmission. Use it when you need to scan large IP ranges quickly, though its speed means results may be less accurate than nmap for individual hosts.",
        "flags": {
            "-p": "Specify ports or port ranges to scan",
            "--rate": "Set the maximum packet transmission rate (packets per second)",
            "--banners": "Grab service banners from open ports",
            "-oX": "Output results in XML format",
            "-oJ": "Output results in JSON format",
            "-oL": "Output results in simple list format",
            "--exclude": "Exclude specific IP addresses or ranges"
        },
        "common_patterns": ["sudo masscan -p80,443 10.0.0.0/8 --rate=10000", "sudo masscan -p1-65535 192.168.1.0/24", "sudo masscan -p80 0.0.0.0/0 --rate=100000 --banners", "sudo masscan -p22 10.0.0.0/24 -oJ results.json"],
        "man_url": "https://github.com/robertdavidgraham/masscan",
        "use_cases": [
            "Rapidly scan a large IP range for specific open ports: masscan 10.0.0.0/8 -p80,443 --rate=50000",
            "Discover all web servers on a /16 network in minutes",
            "Feed masscan results into nmap for detailed follow-up scanning of discovered hosts",
        ],
        "gotchas": [
            "High scan rates can overwhelm networks, trigger IDS alerts, and crash fragile devices -- start with conservative rates",
            "masscan uses its own TCP stack and does not go through the OS, so firewall rules on the scanning host are bypassed",
            "Results are less accurate than nmap for individual hosts due to the asynchronous scanning approach",
            "Requires root for raw socket access",
        ],
        "related": ["nmap", "nc", "tcpdump"],
        "difficulty": "advanced",
    },
    "mc": {
        "description": "Midnight Commander, a full-featured two-pane terminal file manager with a built-in editor, viewer, and FTP/SFTP client. Use it when you need a visual, mouse-capable file manager in the terminal for complex file operations across local and remote paths.",
        "flags": {
            "-a": "Disable the use of langstrstrk characters for line drawing",
            "-b": "Force black and white mode",
            "-c": "Force color mode",
            "-d": "Disable mouse support",
            "-e": "Open the built-in editor instead of the file manager",
            "-v": "Open the built-in viewer on the specified file",
            "-s": "Run in slow terminal mode for better compatibility",
            "-u": "Disable concurrent shell (use subshell only if needed)",
        },
        "common_patterns": ["mc", "mc /path/left /path/right", "mc -e filename", "mc -v filename"],
        "man_url": "https://midnight-commander.org/",
        "use_cases": [
            "Manage files across two directories simultaneously with a dual-pane view",
            "Connect to remote servers via SFTP/FTP with mc's built-in virtual filesystem",
            "Edit files with the built-in editor mcedit which supports syntax highlighting",
        ],
        "gotchas": [
            "mc captures the F-keys which may conflict with terminal or tmux key bindings -- use Esc+number as an alternative",
            "mc's FTP/SFTP panel (accessed via cd sh://user@host) can be slow on high-latency connections",
            "The mouse support can interfere with terminal copy-paste -- hold Shift while selecting to use the terminal's native selection",
        ],
        "related": ["ranger", "nnn", "lf"],
        "difficulty": "intermediate",
    },
    "meson": {
        "description": "A fast, user-friendly build system that generates optimized Ninja build files from simple Python-like project descriptions. You'd use it as a modern alternative to CMake or Autotools for C/C++, Rust, and other compiled language projects.",
        "flags": {
            "--buildtype": "Set the build type (debug, release, debugoptimized, plain)",
            "--prefix": "Set the installation prefix directory",
            "--default-library": "Set the default library type (shared, static, both)",
            "--warnlevel": "Set the compiler warning level (0, 1, 2, 3)",
            "-D": "Set a project build option key-value pair",
            "--backend": "Select the backend build system (ninja, vs, xcode)",
            "--reconfigure": "Regenerate build configuration without clearing the build directory",
            "--wipe": "Clear the build directory and reconfigure from scratch",
        },
        "common_patterns": ["meson setup builddir", "meson setup --buildtype=release builddir", "meson compile -C builddir", "meson install -C builddir"],
        "man_url": "https://mesonbuild.com/Reference-manual.html",
        "use_cases": [
            "Set up a new C/C++ project build with meson setup builddir",
            "Create a release build with meson setup --buildtype=release builddir",
            "Run project tests after building with meson test -C builddir",
        ],
        "gotchas": [
            "Meson requires a separate build directory -- in-source builds are not supported",
            "Meson uses Python-like syntax in meson.build files but is not actually Python -- it is a custom DSL",
            "Build options can only be changed with meson configure, not by editing the build directory -- regenerate with meson setup --reconfigure if needed",
        ],
        "related": ["ninja", "cmake", "make"],
        "difficulty": "intermediate",
    },
    "minikube": {
        "description": "A tool that runs a single-node Kubernetes cluster locally inside a VM or container for development and testing. You'd use it to learn Kubernetes, develop microservices locally, or test deployments before pushing to production clusters.",
        "flags": {
            "--memory": "Set the amount of RAM allocated to the cluster",
            "--cpus": "Set the number of CPUs allocated to the cluster",
            "--disk-size": "Set the disk size allocated to the cluster VM",
            "--driver": "Specify the virtualization driver (docker, virtualbox, hyperv)",
            "--kubernetes-version": "Set the specific Kubernetes version to deploy",
            "-p": "Use a named profile to manage multiple clusters",
            "--addons": "Enable specific minikube addons (metrics-server, ingress, etc.)",
            "tunnel": "Create a route to services deployed with type LoadBalancer",
            "service": "Get the URL of a service for browser access",
        },
        "common_patterns": ["minikube start", "minikube start --memory=4096 --cpus=2", "minikube dashboard", "minikube stop && minikube delete"],
        "man_url": "https://minikube.sigs.k8s.io/docs/",
        "use_cases": [
            "Start a local Kubernetes cluster for development with minikube start",
            "Access the Kubernetes dashboard with minikube dashboard",
            "Use minikube's Docker daemon to build images directly with eval $(minikube docker-env)",
            "Test with a specific Kubernetes version with minikube start --kubernetes-version=v1.28.0",
        ],
        "gotchas": [
            "minikube runs a single-node cluster -- it does not simulate multi-node scenarios or network policies accurately",
            "minikube tunnel is required for LoadBalancer services to get external IPs -- without it they stay pending",
            "minikube consumes significant memory and CPU -- allocate at least 2 CPUs and 4GB RAM or workloads will be unstable",
        ],
        "related": ["kubectl", "helm", "docker", "kind"],
        "difficulty": "intermediate",
    },
    "mkfs": {
        "description": "Build a new filesystem on a device or partition, effectively formatting it for use. You use mkfs when setting up a new disk, reformatting an existing partition, or creating a filesystem inside a file for loop-mounting.",
        "flags": {
            "-t": "Specify the filesystem type to create (ext4, xfs, btrfs, vfat, etc.)",
            "-V": "Verbose mode; with a second -V, run in dry-run mode without executing",
            "-c": "Check the device for bad blocks before creating the filesystem",
            "-L": "Set the volume label for the new filesystem",
            "-n": "Do not actually create the filesystem, just show what would be done"
        },
        "common_patterns": ["sudo mkfs -t ext4 /dev/sdb1", "sudo mkfs.xfs /dev/sdc1", "mkfs -t vfat /dev/sdb1"],
        "man_url": "https://man7.org/linux/man-pages/man8/mkfs.8.html",
        "use_cases": [
            "Create a new filesystem: mkfs.ext4 /dev/sdb1",
            "Format a USB drive: mkfs.vfat /dev/sdc1",
            "Initialize a partition with a specific filesystem type",
        ],
        "gotchas": [
            "Destroys all data on the target partition; double-check the device name",
            "Use mkfs.TYPE (e.g., mkfs.ext4, mkfs.xfs) for specific filesystem types",
        ],
        "related": ["fdisk", "mount", "lsblk", "fsck"],
        "difficulty": "advanced",
    },
    "mlocate": {
        "description": "Find files by name using a prebuilt database that is faster than real-time filesystem searching. Use it when you need to quickly locate files by name pattern without the overhead of traversing the entire directory tree.",
        "flags": {
            "-i": "Ignore case when matching patterns",
            "-c": "Print only a count of matching entries instead of filenames",
            "-l": "Limit the output to the specified number of entries",
            "-r": "Interpret the pattern as a POSIX extended regular expression",
            "-e": "Print only entries for files that currently exist on disk",
            "-b": "Match only against the basename of path names"
        },
        "common_patterns": ["mlocate filename", "mlocate -i pattern", "mlocate -c '*.conf'", "mlocate -r 'regex'"],
        "man_url": "https://man7.org/linux/man-pages/man1/locate.1.html",
        "use_cases": [
            "Find files by name quickly: locate nginx.conf",
            "Search with regex: locate -r '/etc/.*\\.conf$'",
            "Count matches: locate -c '*.py'",
        ],
        "gotchas": [
            "Results may be stale -- run updatedb to refresh the database",
            "mlocate checks file permissions so users only see files they can access, unlike older locate",
            "Many distros have replaced mlocate with plocate for better performance",
        ],
        "related": ["plocate", "updatedb", "find", "fd"],
        "difficulty": "beginner",
    },
    "mount": {
        "description": "Attach a filesystem found on a device to the directory tree so its contents become accessible at a mount point. You use mount to access USB drives, network shares, disk images, and any additional filesystems beyond the root.",
        "flags": {
            "-t": "Specify the filesystem type (ext4, ntfs, vfat, nfs, etc.)",
            "-o": "Comma-separated mount options (ro, rw, noexec, nosuid, remount, defaults)",
            "-a": "Mount all filesystems listed in /etc/fstab",
            "-r": "Mount the filesystem as read-only",
            "-w": "Mount the filesystem as read-write",
            "-v": "Verbose mode, print each mount action",
            "-l": "List all mounted filesystems with their labels",
            "-U": "Mount the partition matching the given UUID"
        },
        "common_patterns": ["mount /dev/sdb1 /mnt/usb", "mount -t nfs server:/share /mnt/nfs", "mount -o remount,rw /", "mount -a"],
        "man_url": "https://man7.org/linux/man-pages/man8/mount.8.html",
        "use_cases": [
            "Mount a filesystem: mount /dev/sdb1 /mnt/usb",
            "List all mounted filesystems: mount | column -t",
            "Mount with specific options: mount -o ro,noexec /dev/sda1 /mnt",
        ],
        "gotchas": [
            "Mounting requires root unless the filesystem is listed in /etc/fstab with user option",
            "Mount points must be empty directories; existing contents are hidden while mounted",
        ],
        "related": ["umount", "lsblk", "fdisk", "blkid"],
        "difficulty": "intermediate",
    },
    "mpstat": {
        "description": "Report per-processor CPU statistics showing how workload is distributed across individual CPU cores. Use it to detect unbalanced loads where one core is saturated while others are idle, indicating a single-threaded bottleneck.",
        "flags": {
            "-P": "Specify which processors to report on (ALL for all, or comma-separated list)",
            "-u": "Report CPU utilization (default)",
            "-I": "Report interrupt statistics",
            "-A": "Equivalent to -u -I ALL, showing all information"
        },
        "common_patterns": ["mpstat", "mpstat -P ALL 1 5", "mpstat -P 0,1 2", "mpstat -I ALL"],
        "man_url": "https://man7.org/linux/man-pages/man1/mpstat.1.html",
        "use_cases": [
            "Check per-CPU utilization to find single-threaded bottlenecks: mpstat -P ALL 1",
            "Identify if workload is evenly distributed across cores",
            "Monitor interrupt distribution: mpstat -I ALL 1",
        ],
        "gotchas": [
            "mpstat is part of the sysstat package and may not be installed by default",
            "If one CPU is at 100% while others are idle, the application likely has a single-threaded bottleneck",
        ],
        "related": ["vmstat", "iostat", "sar", "top"],
        "difficulty": "intermediate",
    },
    "mtr": {
        "description": "Combine the functionality of traceroute and ping into a single real-time network diagnostic tool that continuously probes each hop. Use it to identify intermittent network issues like packet loss at specific routers that a one-shot traceroute would miss.",
        "flags": {
            "-r": "Generate a report after a specified number of cycles and exit",
            "-c": "Set the number of ping cycles to send",
            "-n": "Do not resolve hostnames (numeric only)",
            "-w": "Wide report mode with full hostnames",
            "-T": "Use TCP instead of ICMP",
            "-P": "Specify the target port when using TCP mode",
        
            "-4": "Use IPv4 only",
            "-6": "Use IPv6 only",
            "-s": "Set the packet size in bytes",
            "-i": "Set the interval between ICMP ECHO requests",
            "-e": "Display MPLS information in report mode",
        },
        "common_patterns": ["mtr example.com", "mtr -r -c 100 example.com", "mtr -n 8.8.8.8", "mtr -T -P 443 example.com"],
        "man_url": "https://linux.die.net/man/8/mtr",
        "use_cases": [
            "Diagnose intermittent packet loss at a specific network hop that one-shot traceroute misses",
            "Generate a network quality report for an ISP support ticket with mtr -r -c 100 host",
            "Monitor real-time latency to a game server or VoIP endpoint to correlate with quality drops",
            "Test if a firewall is blocking TCP traffic with mtr -T -P 443 host",
        ],
        "gotchas": [
            "Packet loss shown at intermediate hops does not always indicate a problem -- many routers deprioritize ICMP responses causing false loss readings",
            "mtr requires root privileges for raw socket access; some distributions provide a setuid wrapper",
            "The -r report mode sends 10 cycles by default, which may not be enough to catch intermittent issues; use -c 100 or more",
        ],
        "related": ["traceroute", "tracepath", "ping"],
        "difficulty": "intermediate",
    },
    "mvn": {
        "description": "The command-line interface for Apache Maven that builds, tests, and manages Java project lifecycles. It uses a pom.xml file to define project structure, dependencies, and build plugins following convention over configuration.",
        "flags": {
            "clean": "Remove the target directory containing all build artifacts",
            "compile": "Compile the source code of the project",
            "test": "Run unit tests using the configured testing framework",
            "package": "Compile, test, and package the project into a JAR or WAR file",
            "install": "Build the project and install the artifact into the local repository",
            "-DskipTests": "Skip running tests during the build lifecycle",
            "-q": "Run in quiet mode showing only errors",
            "-pl": "Build only the specified modules in a multi-module project",
            "verify": "Run integration tests",
            "deploy": "Copy the artifact to a remote repository",
            "-am": "Also build dependent modules",
            "-U": "Force update of snapshots from remote repositories",
            "-o": "Work offline (use only local repository)",
            "-B": "Run in non-interactive batch mode",
            "-X": "Enable debug output for troubleshooting",
        },
        "common_patterns": ["mvn clean install", "mvn package -DskipTests", "mvn test", "mvn dependency:tree"],
        "man_url": "https://maven.apache.org/run.html",
        "use_cases": [
            "Compile the project: mvn compile",
            "Run tests: mvn test",
            "Package the project as a JAR or WAR: mvn package",
            "Install the artifact to the local Maven repository: mvn install",
            "Clean build artifacts and rebuild: mvn clean install",
            "Generate a project from an archetype: mvn archetype:generate",
        ],
        "gotchas": [
            "Maven downloads the entire internet on first run (all dependencies) -- use mvn dependency:go-offline to pre-download for air-gapped builds",
            "mvn install puts artifacts in ~/.m2/repository which can grow very large over time -- periodically clean it manually",
            "Maven's verbose output makes errors hard to find -- use mvn -q for quiet mode or pipe through grep to find ERROR lines",
            "The pom.xml is XML and easy to make syntax errors in -- use mvn validate to check for basic POM errors",
        ],
        "related": ["gradle", "java", "javac"],
        "difficulty": "intermediate",
    },
    "ncat": {
        "description": "An improved reimplementation of netcat from the Nmap project with added features like SSL encryption, proxy support, and IPv6. Use it when you need netcat functionality with encryption or when connecting through HTTP/SOCKS proxies.",
        "flags": {
            "-l": "Listen mode for incoming connections",
            "--ssl": "Use SSL/TLS encryption on the connection",
            "--proxy": "Connect through an HTTP or SOCKS proxy",
            "-e": "Execute a command upon connection",
            "-v": "Verbose output",
            "-w": "Set connection timeout in seconds",
            "--allow": "Allow only specific hosts to connect",
            "--ssl-verify": "Require and verify the server certificate",
            "-k": "Accept multiple connections in listen mode",
            "--broker": "Enable connection brokering between multiple clients",
            "--chat": "Start a simple chat server",
            "-m": "Maximum number of simultaneous connections",
        },
        "common_patterns": ["ncat -l 8080", "ncat --ssl host 443", "ncat -l --ssl -p 4444", "ncat --proxy proxyhost:8080 targethost 80"],
        "man_url": "https://man7.org/linux/man-pages/man1/ncat.1.html",
        "use_cases": [
            "Create an encrypted tunnel with ncat --ssl -l 4444 for secure ad-hoc communication",
            "Set up a simple chat server with ncat -l --chat 8080 for team debugging sessions",
            "Proxy connections through an HTTP proxy to reach internal services with --proxy",
            "Serve a single file over HTTPS by combining --ssl with --exec",
        ],
        "gotchas": [
            "ncat is part of the nmap package and may not be installed by default on minimal systems",
            "The --ssl flag generates a temporary certificate; clients will see certificate warnings unless you provide --ssl-cert and --ssl-key",
        ],
        "related": ["nc", "socat", "openssl", "nmap"],
        "difficulty": "intermediate",
    },
    "netcat": {
        "description": "A versatile networking utility that reads and writes data across TCP and UDP connections, often called the Swiss Army knife of networking. Use it for port scanning, file transfers, banner grabbing, creating simple chat servers, or testing network services.",
        "flags": {
            "-l": "Listen mode, waiting for incoming connections",
            "-p": "Specify the local port number",
            "-v": "Verbose output showing connection details",
            "-z": "Zero-I/O mode for port scanning without sending data",
            "-u": "Use UDP instead of TCP",
            "-w": "Set timeout in seconds for connections",
            "-e": "Execute a program after connection (available in some versions)"
        },
        "common_patterns": ["nc -zv host 80", "nc -l -p 8080", "nc host 8080 < file.txt", "echo 'test' | nc host 80"],
        "man_url": "https://man7.org/linux/man-pages/man1/ncat.1.html",
        "use_cases": [
            "Quick port scan of common ports with nc -zv host 20-100",
            "Test SMTP server connectivity by connecting to port 25 and typing HELO commands",
            "Banner grab a service to identify its version: echo '' | nc -w3 host 22",
        ],
        "gotchas": [
            "The netcat command may point to different implementations depending on your distro -- check which version with nc -h or readlink $(which nc)",
            "Port scanning with -z is slow compared to nmap; use nmap for serious scanning work",
        ],
        "related": ["nc", "ncat", "socat", "nmap"],
        "difficulty": "intermediate",
    },
    "newgrp": {
        "description": "Change the current real group ID to the specified group, starting a new shell with that group as the primary group. Use it when you need to create files owned by a different group without changing your user account.",
        "flags": {
            "-": "Start a login shell, reinitializing the environment as if the user had logged in with the new group"
        },
        "common_patterns": ["newgrp groupname", "newgrp - groupname"],
        "man_url": "https://man7.org/linux/man-pages/man1/newgrp.1.html",
        "use_cases": [
            "Switch active group without logging out: newgrp docker",
            "Activate a newly assigned supplementary group in the current session",
            "Create files with a specific group ownership by switching first",
        ],
        "gotchas": [
            "newgrp starts a new shell -- exit to return to the original shell with original groups",
            "If a group password is set and the user is not a member, newgrp prompts for it",
        ],
        "related": ["groups", "id", "usermod", "sg"],
        "difficulty": "intermediate",
    },
    "nft": {
        "description": "Configure the nftables packet filtering framework that replaces iptables, ip6tables, arptables, and ebtables with a unified interface. Use it to manage firewall rules, NAT, and packet classification on modern Linux systems with cleaner syntax and better performance than legacy iptables.",
        "flags": {
            "list": "List rules, chains, tables, or rulesets",
            "add": "Add a new table, chain, or rule",
            "delete": "Delete a table, chain, or rule",
            "flush": "Remove all rules from a chain or table",
            "-f": "Read commands from a file",
            "-n": "Show numerical output without resolving names",
            "-a": "Show rule handles for deletion or insertion",
            "-j": "Output in JSON format for programmatic use",
            "-s": "Translate numeric protocols and services to names",
            "-c": "Check command validity without applying changes",
        },
        "common_patterns": ["sudo nft list ruleset", "sudo nft add table inet filter", "sudo nft add rule inet filter input tcp dport 80 accept", "sudo nft flush ruleset"],
        "man_url": "https://www.netfilter.org/projects/nftables/manpage.html",
        "use_cases": [
            "List the entire active ruleset: nft list ruleset",
            "Create a basic firewall accepting established connections and dropping others",
            "Replace complex iptables + ip6tables rules with a single unified nft ruleset",
            "Load a firewall configuration from a file: nft -f /etc/nftables.conf",
        ],
        "gotchas": [
            "nftables uses a different syntax from iptables; existing iptables rules cannot be pasted directly",
            "The iptables-translate tool can help convert iptables rules to nft syntax",
            "nft requires root privileges for all operations",
            "Flushing the ruleset on a remote server will lock you out if the default policy is drop",
        ],
        "related": ["iptables", "ufw", "firewall-cmd"],
        "difficulty": "advanced",
    },
    "nikto": {
        "description": "An open-source web server scanner that tests for dangerous files, outdated server software, and known vulnerabilities across thousands of checks. Use it during security assessments to quickly identify common web server misconfigurations and potential attack vectors.",
        "flags": {
            "-h": "Specify the target host to scan",
            "-p": "Specify the target port (default 80)",
            "-ssl": "Force SSL mode on the connection",
            "-o": "Write output to a file",
            "-Format": "Specify output format (csv, htm, txt, xml)",
            "-Tuning": "Control which test categories to include",
            "-timeout": "Set timeout for requests in seconds"
        },
        "common_patterns": ["nikto -h http://target.com", "nikto -h target.com -p 443 -ssl", "nikto -h target.com -o report.html", "nikto -h target.com -Tuning 1"],
        "man_url": "https://github.com/sullo/nikto/wiki",
        "use_cases": [
            "Quick web server security audit: nikto -h http://target.com",
            "Scan an HTTPS site: nikto -h target.com -p 443 -ssl",
            "Generate an HTML report for a security assessment: nikto -h target -o report.html -Format htm",
        ],
        "gotchas": [
            "Nikto is extremely noisy and generates hundreds of requests -- it will be detected by any WAF or IDS",
            "Only scan systems you have explicit authorization to test",
            "Nikto checks for known vulnerabilities and misconfigurations; it does not find custom application bugs",
            "Results include many false positives; manual verification is always required",
        ],
        "related": ["nmap", "curl", "openssl"],
        "difficulty": "advanced",
    },
    "ninja": {
        "description": "A small, fast build system focused on speed that reads build rules generated by higher-level build tools like CMake or Meson. You'd use it as the backend build executor that runs compilation commands in parallel with minimal overhead.",
        "flags": {
            "-j": "Set the number of parallel jobs (0 means unlimited)",
            "-C": "Change to the specified directory before doing anything",
            "-f": "Specify the input build file instead of the default build.ninja",
            "-v": "Show all command lines while building",
            "-n": "Dry run without executing any commands",
            "-k": "Keep going until N jobs fail (0 means keep going forever)",
            "-t": "Run a subtool such as clean, browse, or graph",
            "-l": "Do not start new jobs if load average exceeds this value"
        },
        "common_patterns": ["ninja", "ninja -j4", "ninja -C builddir", "ninja -t clean"],
        "man_url": "https://ninja-build.org/manual.html",
        "use_cases": [
            "Build a CMake project faster by generating Ninja files with cmake -G Ninja -S . -B build && ninja -C build",
            "Build with verbose output to debug compilation issues with ninja -v",
            "Clean build artifacts with ninja -t clean",
        ],
        "gotchas": [
            "Ninja is not designed to be written by hand -- use CMake or Meson to generate build.ninja files",
            "Ninja defaults to parallel builds using all available cores -- unlike make, you rarely need -j",
            "Ninja does not support pattern rules or includes like Makefiles -- it is intentionally minimal and relies on a generator",
        ],
        "related": ["cmake", "meson", "make"],
        "difficulty": "intermediate",
    },
    "nm": {
        "description": "A utility that lists the symbols (functions, variables, and their types) contained in object files, libraries, and executables. You'd use it to inspect which functions a library exports, debug undefined symbol errors, or analyze binary composition.",
        "flags": {
            "-C": "Demangle C++ symbol names into human-readable form",
            "-D": "Display dynamic symbols from shared libraries",
            "-g": "Display only external (global) symbols",
            "-a": "Display all symbols including debugger-only symbols",
            "-n": "Sort symbols numerically by address instead of alphabetically",
            "-u": "Display only undefined symbols that need to be resolved",
            "-S": "Print both the value and size of each defined symbol",
            "-p": "Do not sort symbols, print in the order encountered"
        },
        "common_patterns": ["nm program", "nm -C libcpp.so", "nm -gD /usr/lib/libssl.so", "nm -u program.o"],
        "man_url": "https://sourceware.org/binutils/docs/binutils/nm.html",
        "use_cases": [
            "List all exported symbols in a shared library with nm -gD libfoo.so",
            "Find undefined symbols that need resolving with nm -u program.o",
            "Demangle C++ symbols for readability with nm -C libcpp.so",
        ],
        "gotchas": [
            "nm cannot read stripped binaries -- if nm shows no symbols, the binary was stripped with strip",
            "For shared libraries, use -D to show dynamic symbols -- regular nm may show nothing for .so files",
            "Symbol types: T=text/code, D=data, U=undefined, B=BSS -- U symbols are what the linker needs to resolve",
        ],
        "related": ["objdump", "readelf", "ldd", "ar"],
        "difficulty": "advanced",
    },
    "nnn": {
        "description": "A fast, minimal terminal file manager that uses a single-pane interface with powerful filtering, sorting, and plugin support. Use it when you want a lightweight, resource-efficient file manager that can be extended through shell plugins.",
        "flags": {
            "-a": "Use access time instead of modification time",
            "-d": "Detail mode showing file information",
            "-H": "Show hidden files on startup",
            "-n": "Start in type-to-nav (navigate-as-you-type) mode",
            "-p": "Write selection to a file on exit",
            "-P": "Specify a plugin to run on startup",
            "-t": "Specify a temporary directory for plugins",
            "-c": "Set NNN_FCOLORS environment for 8-color scheme",
            "-e": "Open text files in $VISUAL or $EDITOR on Enter",
            "-o": "Open files with only a single click in navigation",
            "-x": "Enable various system notifications and copy path to clipboard",
        },
        "common_patterns": ["nnn", "nnn -d", "nnn -H /path/to/dir", "nnn -p /tmp/selected"],
        "man_url": "https://github.com/jarun/nnn",
        "use_cases": [
            "Navigate large directory trees quickly with minimal resource usage",
            "Use plugins for previewing files, opening in editors, or batch renaming with nnn -P preview",
            "Select multiple files for batch operations with nnn -p /tmp/sel and process the selection file",
        ],
        "gotchas": [
            "nnn does not cd on quit by default -- you must configure the shell function (n) using the nnn-quitcd setup",
            "nnn uses single-key shortcuts that are case-sensitive -- capital letters do different things than lowercase",
            "nnn requires the NNN_PLUG environment variable to be set for plugins to work",
        ],
        "related": ["ranger", "lf", "mc", "broot"],
        "difficulty": "intermediate",
    },
    "nuget": {
        "description": "The package manager for .NET that facilitates sharing and consuming reusable code libraries. It manages NuGet packages from nuget.org and private feeds for .NET projects.",
        "flags": {
            "install": "Install a package into the current project or solution",
            "restore": "Restore all packages referenced by a project",
            "push": "Publish a package to a NuGet server or feed",
            "pack": "Create a NuGet package from a nuspec or project file",
            "list": "List packages from a source matching a search term",
            "-Source": "Specify the package source URL or feed to use",
            "-OutputDirectory": "Set the directory where packages are installed",
            "-Version": "Install a specific version of a package",
            "sources": "Manage NuGet package sources",
            "config": "Get or set NuGet configuration values",
            "-ApiKey": "API key for publishing packages",
        },
        "common_patterns": ["nuget install package_name", "nuget restore solution.sln", "nuget push package.nupkg -Source url", "nuget pack project.nuspec"],
        "man_url": "https://learn.microsoft.com/en-us/nuget/reference/nuget-exe-cli-reference",
        "use_cases": [
            "Restore packages for a .NET project: nuget restore solution.sln",
            "Install a package to a project: nuget install Newtonsoft.Json",
            "Pack a project into a .nupkg file: nuget pack MyProject.nuspec",
            "Push a package to the NuGet gallery: nuget push package.nupkg -Source nuget.org",
            "List package sources: nuget sources list",
        ],
        "gotchas": [
            "For .NET Core and .NET 5+ projects, prefer dotnet nuget commands over nuget.exe -- nuget.exe is primarily for .NET Framework projects",
            "nuget.exe is Windows-only by default; on macOS/Linux use dotnet CLI or Mono-based nuget",
            "NuGet package restore can fail in CI if the package source is not configured -- ensure nuget.config is committed with the project",
        ],
        "related": ["dotnet", "msbuild"],
        "difficulty": "intermediate",
    },
    "nvim": {
        "description": "Neovim, a modern refactor of Vim with better defaults, built-in LSP support, and Lua-based extensibility for efficient text editing. You'd use it as an improved replacement for Vim with asynchronous plugins, embedded terminal, and a thriving extension ecosystem.",
        "flags": {
            "-u": "Use the specified init file instead of the default config",
            "--noplugin": "Skip loading all plugins on startup",
            "-R": "Open files in read-only mode",
            "-d": "Open in diff mode to compare two or more files side by side",
            "-c": "Execute an ex command after loading the first file",
            "--headless": "Run without a user interface for scripted operations",
            "-p": "Open each file argument in a separate tab page",
            "--clean": "Start with factory defaults, ignoring all user configuration",
            "--startuptime": "Write startup timing to a file for performance profiling",
            "-l": "Execute a Lua script and exit",
        },
        "common_patterns": ["nvim file.txt", "nvim -d file1.txt file2.txt", "nvim --headless +PlugInstall +qa", "nvim -u NONE --clean file.py"],
        "man_url": "https://neovim.io/doc/",
        "use_cases": [
            "Open a file with nvim file.txt and enjoy built-in LSP support for code completion",
            "Run headless for plugin installation with nvim --headless '+Lazy sync' +qa",
            "Start with no configuration to debug plugin issues with nvim --clean file.txt",
            "Use diff mode to compare files with nvim -d file1.txt file2.txt",
        ],
        "gotchas": [
            "Neovim uses ~/.config/nvim/init.lua (or init.vim) not ~/.vimrc -- migrating vim config requires renaming and possibly converting to Lua",
            "Neovim's built-in LSP and Treesitter provide IDE-like features but require plugin setup (mason.nvim, nvim-lspconfig) -- they are not configured out of the box",
            "nvim --headless is useful for CI/CD plugin management but requires proper exit commands (+qa) or it hangs",
        ],
        "related": ["vim", "vi", "code", "emacs"],
        "difficulty": "intermediate",
    },
    "objdump": {
        "description": "A utility that displays detailed information from object files including disassembled machine code, headers, and symbol tables. You'd use it for reverse engineering, debugging compiled binaries, or understanding the machine code generated by a compiler.",
        "flags": {
            "-d": "Disassemble executable sections into assembly instructions",
            "-D": "Disassemble all sections, not just executable ones",
            "-S": "Intermix source code with disassembly when debug info is available",
            "-t": "Print the symbol table entries",
            "-h": "Display the section headers with sizes and addresses",
            "-f": "Display file header information including architecture",
            "-x": "Display all available header information",
            "-r": "Display relocation entries",
            "-M": "Pass disassembler options (e.g., -M intel for Intel syntax)",
            "-j": "Disassemble only the specified section",
        },
        "common_patterns": ["objdump -d program", "objdump -d -S -l program", "objdump -t library.o", "objdump -x -h binary"],
        "man_url": "https://sourceware.org/binutils/docs/binutils/objdump.html",
        "use_cases": [
            "Disassemble a binary to view assembly with objdump -d program",
            "View disassembly interleaved with source code with objdump -d -S -l program (requires -g)",
            "Inspect section headers and sizes with objdump -h program to understand binary layout",
        ],
        "gotchas": [
            "objdump -d only disassembles executable sections -- use -D to disassemble ALL sections including data",
            "Source interleaving with -S requires the binary to be compiled with -g debug info",
            "objdump uses AT&T syntax by default on x86 -- use -M intel for Intel syntax if you prefer it",
        ],
        "related": ["nm", "readelf", "gdb", "strings"],
        "difficulty": "advanced",
    },
    "pacman": {
        "description": "The default package manager for Arch Linux that manages binary packages from official repositories. It handles installation, upgrades, removal, and querying of packages with dependency resolution.",
        "flags": {
            "-S": "Synchronize and install a package from the remote repository",
            "-R": "Remove a package from the system",
            "-Syu": "Refresh all package databases and upgrade the entire system",
            "-Ss": "Search the remote sync database for packages matching a pattern",
            "-Q": "Query the local database of installed packages",
            "-Qs": "Search locally installed packages by name or description",
            "-Sc": "Remove cached packages that are no longer installed",
            "-U": "Install a local package file directly",
            "-Qi": "Show detailed info about an installed package",
            "-Qo": "Query which package owns a given file",
        },
        "common_patterns": ["pacman -S package_name", "pacman -Syu", "pacman -Ss search_term", "pacman -R package_name"],
        "man_url": "https://man.archlinux.org/man/pacman.8",
        "use_cases": [
            "Synchronize package databases and upgrade system: pacman -Syu",
            "Install a package from the repositories: pacman -S nginx",
            "Search for a package by name: pacman -Ss web server",
            "Remove a package and its orphaned dependencies: pacman -Rns package-name",
            "Query which package owns a file: pacman -Qo /usr/bin/vim",
        ],
        "gotchas": [
            "Arch is a rolling release -- always run pacman -Syu (full sync) rather than pacman -Sy package, which can cause partial upgrades and break the system",
            "pacman -R will not remove dependencies that were pulled in; use -Rns to also remove orphaned dependencies and config backups",
            "Package signing is enforced by default; if you get signature errors, update the keyring first with pacman -S archlinux-keyring",
        ],
        "related": ["yay", "paru", "makepkg"],
        "difficulty": "intermediate",
    },
    "paru": {
        "description": "An AUR helper and pacman wrapper for Arch Linux written in Rust. It simplifies installing packages from the Arch User Repository while also handling official repository packages.",
        "flags": {
            "-S": "Synchronize and install packages from repositories or AUR",
            "-R": "Remove an installed package",
            "-Q": "Query the local package database for installed packages",
            "-Syu": "Refresh package databases and perform a full system upgrade",
            "-c": "Remove unneeded dependencies no longer required by any package",
            "-a": "Assume targets are from the AUR only",
            "--repo": "Assume targets are from the official repositories only",
            "-G": "Download PKGBUILD source files from ABS or AUR",
            "--review": "Review PKGBUILD and related files before building",
            "--skipreview": "Skip PKGBUILD review",
            "--devel": "Update VCS (git/svn) packages",
            "--removemake": "Remove makedepends after installation",
        },
        "common_patterns": ["paru -S package_name", "paru -Syu", "paru -R package_name", "paru -Ss search_term"],
        "man_url": "https://github.com/Morganamilo/paru",
        "use_cases": [
            "Install a package from AUR or official repos: paru -S package-name",
            "Full system upgrade including AUR packages: paru (defaults to -Syu)",
            "Search for packages interactively: paru search-term",
            "View and edit PKGBUILD before installing: paru -S --review package-name",
            "Clean unneeded build dependencies: paru -c",
        ],
        "gotchas": [
            "paru opens the PKGBUILD for review by default before building, which is safer but slower -- set SkipReview in paru.conf to disable",
            "Like yay, running paru without arguments performs a full system upgrade (-Syu)",
            "paru is written in Rust and must be built from source via makepkg since it is an AUR package itself",
        ],
        "related": ["pacman", "yay", "makepkg"],
        "difficulty": "intermediate",
    },
    "patch": {
        "description": "Apply a diff file (patch) to one or more original files, updating them with the recorded changes. You use patch to apply code changes received as diff output, which is fundamental to open-source contribution workflows and software distribution.",
        "flags": {
            "-p": "Strip the specified number of leading directory components from filenames in the patch",
            "-R": "Reverse the patch, undoing previously applied changes",
            "-b": "Create backup files of originals before patching",
            "--dry-run": "Simulate the patch without actually modifying any files",
            "-s": "Work silently unless an error occurs",
            "-u": "Interpret the patch file as a unified diff",
            "-c": "Interpret the patch file as a context diff"
        },
        "common_patterns": ["patch -p1 < fix.patch", "patch -R < fix.patch", "patch --dry-run -p1 < fix.patch"],
        "man_url": "https://man7.org/linux/man-pages/man1/patch.1.html",
        "use_cases": [
            "Apply a diff/patch file: patch -p1 < fix.patch",
            "Reverse a previously applied patch: patch -R -p1 < fix.patch",
            "Dry-run to test a patch: patch --dry-run -p1 < fix.patch",
        ],
        "gotchas": [
            "The -p (strip) level must match how the patch was created -- -p1 strips the first path component",
            "Patches may fail on files that have been modified since the diff was generated (fuzz/offset warnings)",
            "patch creates .orig backup files by default which can clutter the directory",
        ],
        "related": ["diff", "git", "quilt", "merge"],
        "difficulty": "intermediate",
    },
    "perf": {
        "description": "A powerful Linux profiling tool that uses hardware performance counters and kernel tracepoints to analyze CPU cycles, cache misses, branch mispredictions, and more. Use it for deep performance analysis of programs to find hotspots, bottlenecks, and optimization opportunities.",
        "flags": {
            "stat": "Run a command and gather performance counter statistics",
            "record": "Record performance data into a file for later analysis",
            "report": "Display the recorded performance data",
            "top": "Show real-time performance counter profile similar to top",
            "list": "List available events and hardware counters",
            "-g": "Enable call-graph (stack trace) recording"
        },
        "common_patterns": ["perf stat ./myprogram", "perf record -g ./myprogram", "perf report", "perf top"],
        "man_url": "https://man7.org/linux/man-pages/man1/perf.1.html",
        "use_cases": [
            "Profile CPU usage: perf record -g ./program && perf report",
            "Count hardware events: perf stat ./program",
            "Find performance hotspots: perf top",
            "Trace specific events: perf trace -e syscalls:sys_enter_write",
        ],
        "gotchas": [
            "perf requires kernel support and may need kernel debug symbols for full stack traces",
            "Permission restrictions (perf_event_paranoid) may require root or sysctl tuning",
            "perf record files can grow very large for long-running programs -- use -F to lower sample frequency",
        ],
        "related": ["strace", "valgrind", "gprof", "flamegraph"],
        "difficulty": "advanced",
    },
    "perl": {
        "description": "The Perl programming language interpreter, excelling at text processing, regex operations, and system administration scripting. You'd use it for powerful one-liners that transform text, process log files, or perform complex find-and-replace operations.",
        "flags": {
            "-e": "Execute the given Perl code from the command line",
            "-n": "Wrap code in a while-read loop for line-by-line input processing",
            "-p": "Same as -n but automatically prints each line after processing",
            "-i": "Edit files in-place, with optional backup extension",
            "-l": "Automatically chomp input and add newline to output",
            "-a": "Enable autosplit mode, splitting input into the @F array",
            "-F": "Set the field separator pattern for autosplit mode",
            "-M": "Load a Perl module before executing the script"
        },
        "common_patterns": ["perl script.pl", "perl -pe 's/old/new/g' file.txt", "perl -i.bak -pe 's/foo/bar/g' *.txt", "perl -lane 'print $F[2]' data.tsv"],
        "man_url": "https://perldoc.perl.org/perl",
        "use_cases": [
            "Perform complex find-and-replace across files with perl -pi -e 's/old_api/new_api/g' *.py",
            "Process structured text with field splitting with perl -lane 'print $F[2]' data.tsv",
            "One-liner to sum a column of numbers with perl -lane '$s+=$F[0]; END{print $s}' data.txt",
        ],
        "gotchas": [
            "perl -i edits files in-place and DESTROYS the original -- use -i.bak to create backups",
            "Perl regex is the reference implementation for PCRE -- what works in Perl regex generally works in other PCRE-based tools",
            "The difference between -n (loop without print) and -p (loop with auto-print) is critical for one-liners",
        ],
        "related": ["sed", "awk", "ruby", "grep"],
        "difficulty": "intermediate",
    },
    "php": {
        "description": "The PHP scripting language interpreter that executes PHP scripts from the command line or runs a built-in development web server. You'd use it to run PHP scripts for web development, task automation, or to quickly test PHP code snippets.",
        "flags": {
            "-r": "Execute PHP code directly from the command line string",
            "-f": "Parse and execute the specified PHP file",
            "-S": "Start the built-in development web server on the given address and port",
            "-a": "Run PHP in interactive REPL mode",
            "-i": "Display the PHP configuration information (phpinfo)",
            "-l": "Check the syntax of the given PHP file without executing it",
            "-m": "List all compiled-in modules and extensions",
            "-c": "Specify the php.ini configuration file to use"
        },
        "common_patterns": ["php script.php", "php -S localhost:8000", "php -r 'echo phpversion();'", "php -l syntax_check.php"],
        "man_url": "https://www.php.net/manual/en/features.commandline.php",
        "use_cases": [
            "Start a quick development server with php -S localhost:8000",
            "Check file syntax without executing with php -l script.php",
            "Run a quick expression with php -r 'echo phpversion() . \"\n\";'",
        ],
        "gotchas": [
            "php -S is for development only -- it is single-threaded and not suitable for production traffic",
            "PHP's command-line SAPI uses different php.ini than the web server SAPI -- check with php --ini",
            "PHP's -r flag requires careful shell quoting because PHP uses $ for variables which conflicts with shell variable expansion",
        ],
        "related": ["composer", "node", "python"],
        "difficulty": "intermediate",
    },
    "pip3": {
        "description": "The standard package installer for Python 3 that downloads and installs packages from the Python Package Index (PyPI). It manages dependencies and can install from requirements files, version control systems, and local archives.",
        "flags": {
            "install": "Install a package and its dependencies from PyPI or a local source",
            "uninstall": "Remove an installed Python package",
            "freeze": "Output installed packages in requirements format for reproducibility",
            "list": "List all installed Python packages with their versions",
            "show": "Display detailed metadata about an installed package",
            "--upgrade": "Upgrade an already installed package to the latest version",
            "--user": "Install to the user site-packages directory instead of system-wide",
            "-r": "Install all packages listed in a requirements file"
        },
        "common_patterns": ["pip3 install package_name", "pip3 install -r requirements.txt", "pip3 freeze > requirements.txt", "pip3 install --upgrade package_name"],
        "man_url": "https://pip.pypa.io/en/stable/",
        "use_cases": [
            "Explicitly use Python 3 pip when both Python 2 and 3 are installed: pip3 install flask",
            "Install packages in the user directory: pip3 install --user package-name",
            "Upgrade pip itself: pip3 install --upgrade pip",
        ],
        "gotchas": [
            "On most modern systems, pip and pip3 are the same command since Python 2 is EOL -- but on older systems they may point to different Python versions",
            "Use python3 -m pip instead of pip3 for clarity about which Python interpreter is being used, especially in scripts",
        ],
        "related": ["pip", "pipx", "python3"],
        "difficulty": "beginner",
    },
    "pipx": {
        "description": "A tool for installing and running Python command-line applications in isolated virtual environments. It prevents dependency conflicts between tools by giving each application its own environment while exposing its executables globally.",
        "flags": {
            "install": "Install a Python application in its own isolated environment",
            "uninstall": "Remove an application and its isolated environment",
            "upgrade": "Upgrade an installed application to its latest version",
            "run": "Run an application in a temporary environment without installing it",
            "list": "List all applications installed with pipx",
            "inject": "Add additional packages into an existing application environment",
            "--include-deps": "Also install executables provided by dependency packages",
            "--global": "Perform the operation globally for all users on the system",
            "ensurepath": "Add pipx binary directory to PATH if not already present",
            "reinstall-all": "Reinstall all pipx-managed packages (useful after Python upgrade)",
            "--python": "Specify which Python interpreter to use for the virtual environment",
        },
        "common_patterns": ["pipx install package_name", "pipx run package_name", "pipx upgrade-all", "pipx list"],
        "man_url": "https://pipx.pypa.io/stable/",
        "use_cases": [
            "Install a Python CLI tool in its own isolated environment: pipx install black",
            "Run a tool once without installing: pipx run cowsay hello",
            "Upgrade an installed tool: pipx upgrade black",
            "List all pipx-installed applications: pipx list",
            "Inject an extra package into a tool's isolated environment: pipx inject black click",
        ],
        "gotchas": [
            "pipx is for end-user applications (CLI tools), not libraries -- if you need a library in your project, use pip inside a virtual environment instead",
            "pipx creates one virtual environment per tool, so disk usage can add up with many tools installed",
            "pipx uses the Python version it was installed with -- if you need a tool to use a specific Python, pass --python python3.12",
        ],
        "related": ["pip", "pip3", "uv"],
        "difficulty": "beginner",
    },
    "pkg": {
        "description": "The binary package manager for FreeBSD that handles installing, upgrading, and removing software. It resolves dependencies automatically and connects to remote package repositories.",
        "flags": {
            "install": "Install a package and its dependencies from a repository",
            "remove": "Remove an installed package from the system",
            "search": "Search for packages in remote repositories by name or description",
            "upgrade": "Upgrade all installed packages to their latest versions",
            "info": "Display detailed information about an installed package",
            "autoremove": "Remove automatically installed packages no longer needed",
            "-f": "Force reinstallation of a package even if already installed",
            "-n": "Perform a dry run showing changes without applying them",
            "audit": "Check installed packages for known vulnerabilities",
            "lock": "Lock a package to prevent upgrades",
            "which": "Find which package installed a given file",
        },
        "common_patterns": ["pkg install package_name", "pkg upgrade", "pkg search pattern", "pkg info package_name"],
        "man_url": "https://man.freebsd.org/cgi/man.cgi?query=pkg&sektion=8",
        "use_cases": [
            "Install a package on FreeBSD: pkg install nginx",
            "Update the package repository catalog: pkg update",
            "Upgrade all installed packages: pkg upgrade",
            "Search for packages by name: pkg search keyword",
            "Remove a package and its unused dependencies: pkg delete -a package-name && pkg autoremove",
        ],
        "gotchas": [
            "On a fresh FreeBSD install, pkg must be bootstrapped on first run -- it will prompt to install itself",
            "pkg lock can prevent accidental upgrades of critical packages but can also block security updates if forgotten",
        ],
        "related": ["apt", "dnf", "pacman"],
        "difficulty": "intermediate",
    },
    "plocate": {
        "description": "Find files by name using a prebuilt database, serving as a faster and more modern replacement for mlocate with the same interface. Use it for instant file searches by name, as it uses an I/O-efficient index format for significantly faster queries.",
        "flags": {
            "-i": "Ignore case when matching patterns",
            "-c": "Print only a count of matching entries",
            "-l": "Limit the output to the specified number of entries",
            "-r": "Interpret the pattern as a POSIX extended regular expression",
            "-b": "Match only against the basename of path names",
            "-N": "Suppress errors about permission-denied database reads"
        },
        "common_patterns": ["plocate filename", "plocate -i pattern", "plocate -c '*.log'"],
        "man_url": "https://man7.org/linux/man-pages/man1/plocate.1.html",
        "use_cases": [
            "Fast file search by name: plocate config.yaml",
            "Case-insensitive search: plocate -i README",
            "Drop-in replacement for mlocate with significantly faster queries",
        ],
        "gotchas": [
            "Still requires updatedb to be run (typically via cron) -- results lag behind filesystem changes",
            "Database format is incompatible with mlocate -- migration creates a new database",
        ],
        "related": ["mlocate", "updatedb", "find", "fd"],
        "difficulty": "beginner",
    },
    "pnpm": {
        "description": "A fast and disk-space efficient Node.js package manager that uses a content-addressable store for deduplication. It creates a non-flat node_modules layout using symlinks to enforce strict dependency isolation.",
        "flags": {
            "install": "Install all dependencies listed in package.json",
            "add": "Add a new dependency to the project",
            "remove": "Remove a dependency from the project",
            "update": "Update installed packages to their latest versions",
            "-D": "Save the package as a development dependency",
            "-g": "Install the package globally for system-wide use",
            "--filter": "Restrict a command to specific packages in a monorepo workspace",
            "--frozen-lockfile": "Fail if the lockfile needs updating during install",
            "--shamefully-hoist": "Hoist all packages to root (compatibility escape hatch)",
            "store prune": "Remove unused packages from the content-addressable store",
            "dlx": "Download and execute a package (like npx)",
            "why": "Show why a package is installed",
        },
        "common_patterns": ["pnpm install", "pnpm add package_name", "pnpm run build", "pnpm remove package_name"],
        "man_url": "https://pnpm.io/cli/add",
        "use_cases": [
            "Install all project dependencies: pnpm install",
            "Add a new dependency: pnpm add express",
            "Add a development dependency: pnpm add -D typescript",
            "Run a script from package.json: pnpm run build",
            "Install dependencies in a monorepo workspace: pnpm install --filter @my-org/package-name",
        ],
        "gotchas": [
            "pnpm uses a content-addressable store and hard links, so node_modules has a different structure than npm -- some tools that walk node_modules directly may not work",
            "pnpm is strict about peer dependencies by default, which catches real issues but can be annoying when libraries have sloppy peer dependency declarations -- use --shamefully-hoist as a last resort",
            "pnpm does not hoist packages to the root node_modules by default, so accessing undeclared dependencies fails immediately -- this is by design to enforce correctness",
        ],
        "related": ["npm", "yarn", "bun", "npx"],
        "difficulty": "intermediate",
    },
    "podman": {
        "description": "A daemonless container engine for running OCI containers that is compatible with Docker but does not require root privileges. You'd use it as a drop-in Docker replacement for building, running, and managing containers without a background daemon.",
        "flags": {
            "--name": "Assign a meaningful name to the container",
            "-d": "Run the container in detached background mode",
            "-p": "Publish container ports to the host system",
            "-e": "Set environment variables inside the container",
            "-v": "Mount a host directory as a volume inside the container",
            "--rm": "Automatically remove the container when it exits",
            "-it": "Run interactively with a pseudo-TTY attached",
            "--replace": "Replace any existing container with the same name"
        },
        "common_patterns": ["podman run -d -p 8080:80 nginx", "podman build -t myapp .", "podman ps -a", "podman run --rm -it ubuntu bash"],
        "man_url": "https://docs.podman.io/en/latest/",
        "use_cases": [
            "Run containers without root privileges with podman run --rm -it ubuntu bash",
            "Use as a drop-in Docker replacement with alias docker=podman in your shell config",
            "Build OCI images with podman build -t myapp . using the same Dockerfile syntax",
        ],
        "gotchas": [
            "Podman is daemonless -- there is no background service to start, which means podman ps only shows your containers not other users'",
            "Rootless podman uses user namespaces which can cause UID mapping issues -- files created inside containers may appear as 'nobody' on the host",
            "podman-compose exists but is less mature than docker compose -- for complex stacks, test compatibility carefully",
        ],
        "related": ["docker", "docker-compose", "buildah", "kubectl"],
        "difficulty": "intermediate",
    },
    "poetry": {
        "description": "A Python dependency management and packaging tool that uses pyproject.toml for configuration. It provides deterministic builds through a lockfile and manages virtual environments automatically.",
        "flags": {
            "install": "Install all dependencies defined in pyproject.toml",
            "add": "Add a new dependency to the project",
            "remove": "Remove a dependency from the project",
            "update": "Update dependencies to their latest allowed versions",
            "lock": "Resolve and lock dependencies without installing them",
            "run": "Execute a command within the project virtual environment",
            "--group": "Specify a dependency group for add or install operations",
            "--no-dev": "Exclude development dependencies during installation",
            "show": "Show information about installed packages",
            "shell": "Spawn a shell within the project's virtual environment",
            "env": "Manage the project's virtual environment",
            "export": "Export the lock file to other formats (e.g., requirements.txt)",
            "self update": "Update Poetry itself to the latest version",
        },
        "common_patterns": ["poetry install", "poetry add package_name", "poetry run python script.py", "poetry update"],
        "man_url": "https://python-poetry.org/docs/",
        "use_cases": [
            "Create a new Python project with pyproject.toml: poetry new my-project",
            "Add a dependency: poetry add requests",
            "Add a development dependency: poetry add --group dev pytest",
            "Install all dependencies from the lock file: poetry install",
            "Build and publish a package to PyPI: poetry build && poetry publish",
        ],
        "gotchas": [
            "Poetry manages its own virtual environments and may create them in unexpected locations -- use poetry env info to find the active environment path",
            "poetry install recreates the virtual environment from poetry.lock, not pyproject.toml -- run poetry lock first if you edited pyproject.toml manually",
            "Poetry does not interoperate well with conda environments -- use one or the other, not both",
            "The poetry shell command spawns a new subshell rather than activating in-place like conda activate",
        ],
        "related": ["pip", "pipx", "conda", "uv"],
        "difficulty": "intermediate",
    },
    "port": {
        "description": "The command-line interface for MacPorts that installs and manages open-source software on macOS. It builds packages from source using portfiles and supports variant-based customization of builds.",
        "flags": {
            "install": "Build and install a port and its dependencies",
            "uninstall": "Remove an installed port from the system",
            "search": "Search the ports collection for packages matching a pattern",
            "upgrade": "Upgrade an installed port to the latest available version",
            "selfupdate": "Update the MacPorts infrastructure and port definitions",
            "list": "List available ports matching a pattern",
            "-v": "Enable verbose output to show detailed build progress",
            "-f": "Force an operation even if the port is already active",
            "outdated": "List ports that have available upgrades",
            "contents": "List files installed by a port",
            "variants": "Show available build variants for a port",
            "deps": "Show dependencies of a port",
        },
        "common_patterns": ["sudo port install package_name", "sudo port selfupdate", "port search pattern", "sudo port upgrade outdated"],
        "man_url": "https://man.macports.org/port.1.html",
        "use_cases": [
            "Install a package on macOS via MacPorts: sudo port install wget",
            "Update the port tree and upgrade installed packages: sudo port selfupdate && sudo port upgrade outdated",
            "Search for available ports: port search keyword",
            "List installed ports: port installed",
            "Remove inactive (old) versions of ports: sudo port uninstall inactive",
        ],
        "gotchas": [
            "MacPorts installs everything under /opt/local, which means you need to add /opt/local/bin to PATH to find installed commands",
            "MacPorts compiles from source by default, which can be slow -- Homebrew uses prebuilt bottles and is often faster for common packages",
            "Mixing MacPorts and Homebrew on the same system can cause path conflicts and library version mismatches",
        ],
        "related": ["brew", "apt", "dpkg"],
        "difficulty": "intermediate",
    },
    "poweroff": {
        "description": "Immediately shut down and power off the system by sending ACPI signals to halt all processes and cut power. Use it for a clean shutdown when you want the machine completely off, typically requiring root privileges.",
        "flags": {
            "-f": "Force immediate poweroff without contacting init",
            "-w": "Only write wtmp shutdown record without actually powering off",
            "--no-wall": "Do not send wall message before poweroff",
            "-p": "Power off the machine (default behavior)"
        },
        "common_patterns": ["sudo poweroff", "poweroff --no-wall", "sudo poweroff -f"],
        "man_url": "https://man7.org/linux/man-pages/man8/shutdown.8.html",
        "use_cases": [
            "Cleanly power off a server: sudo poweroff",
            "Equivalent to shutdown -h now on modern systems",
        ],
        "gotchas": ["poweroff -f bypasses init and can cause filesystem corruption"],
        "related": ["shutdown", "halt", "reboot"],
        "difficulty": "beginner",
    },
    "pr": {
        "description": "Format text files for printing by adding headers, page numbers, columns, and line numbers. You use pr when you need to prepare plain text for clean paginated output or to arrange data in multi-column layouts.",
        "flags": {
            "-d": "Double-space the output",
            "-h": "Replace the default filename header with a custom string",
            "-l": "Set the number of lines per page (default 66)",
            "-m": "Print all files in parallel, one per column, side by side",
            "-n": "Number lines in the output",
            "-o": "Set the left margin offset in spaces",
            "-w": "Set the page width in characters (default 72)",
            "-t": "Suppress headers and trailers",
            "-T": "Suppress headers, trailers, and form feeds",
            "-W": "Set page width including margin (overrides -w)",
            "-J": "Merge full lines, overriding -W truncation",
        },
        "common_patterns": ["pr -n file.txt", "pr -2 file.txt", "pr -m file1.txt file2.txt", "pr -h 'Report Title' data.txt"],
        "man_url": "https://man7.org/linux/man-pages/man1/pr.1.html",
        "use_cases": [
            "Add headers and page numbers to a file for printing with pr -h 'Report' data.txt | lpr",
            "Display two files side by side with pr -m -t file1.txt file2.txt for comparison",
            "Format output into multiple columns with pr -3 -t wordlist.txt",
        ],
        "gotchas": [
            "By default pr adds 5-line headers and trailers on each page -- use -t to suppress them for pipeline use",
            "The default page length is 66 lines (standard US letter at 6 lines/inch) -- adjust with -l for other formats",
            "pr paginates output with form feeds -- pipe to head or less if you want continuous output",
        ],
        "related": ["column", "nl", "fmt", "fold"],
        "difficulty": "intermediate",
    },
    "puppet": {
        "description": "A configuration management tool that enforces desired state on servers using a declarative language for infrastructure automation. You'd use it to maintain consistent configurations across hundreds of servers and automatically remediate configuration drift.",
        "flags": {
            "--test": "Enable common testing options including onetime, verbose, and no-daemonize",
            "--noop": "Run in dry-run mode to preview changes without applying them",
            "--verbose": "Turn on verbose reporting of operations performed",
            "--debug": "Enable full debugging output with maximum detail",
            "--environment": "Specify which Puppet environment to use",
            "--certname": "Set the unique certificate identity of the node"
        },
        "common_patterns": ["puppet apply manifest.pp", "puppet agent --test", "puppet agent --test --noop", "puppet apply --verbose --debug site.pp"],
        "man_url": "https://www.puppet.com/docs/puppet/latest/man/overview.html",
        "use_cases": [
            "Apply a manifest locally with puppet apply manifest.pp for testing",
            "Run the Puppet agent in test mode with puppet agent --test to see what changes would be made",
            "Dry-run a manifest without making changes with puppet apply --noop site.pp",
        ],
        "gotchas": [
            "Puppet uses a declarative language that is not Ruby despite looking similar -- it has its own syntax rules",
            "Puppet runs are not instant -- the agent checks in periodically (default 30 minutes) and convergence takes multiple runs for complex catalogs",
            "Resource ordering is not guaranteed unless you specify explicit dependencies with require, before, notify, or subscribe",
        ],
        "related": ["ansible", "chef", "terraform"],
        "difficulty": "advanced",
    },
    "pwck": {
        "description": "Verify the integrity of the password files /etc/passwd and /etc/shadow by checking for formatting errors, orphaned entries, and inconsistencies. Use it as a system administration tool to detect and repair corrupted password database entries.",
        "flags": {
            "-r": "Run in read-only mode without making changes",
            "-s": "Sort entries by UID in the password files",
            "-q": "Report only errors (quiet mode)"
        },
        "common_patterns": ["pwck", "pwck -r", "sudo pwck"],
        "man_url": "https://man7.org/linux/man-pages/man8/pwck.8.html",
        "use_cases": [
            "Verify integrity of /etc/passwd and /etc/shadow: pwck",
            "Read-only check without modifications: pwck -r",
            "Part of routine system integrity audits",
        ],
        "gotchas": [
            "Must be run as root to modify files; use -r for safe read-only checking",
            "May prompt to fix issues interactively -- not suitable for fully unattended automation without -r",
        ],
        "related": ["grpck", "vipw", "passwd", "useradd"],
        "difficulty": "advanced",
    },
    "python2": {
        "description": "The Python 2 interpreter for running legacy Python scripts that have not been ported to Python 3. You'd use it to maintain or run older codebases that depend on Python 2 syntax and library behavior.",
        "flags": {
            "-c": "Execute a Python command passed as a string",
            "-m": "Run a library module as a script",
            "-i": "Enter interactive mode after executing a script",
            "-O": "Optimize by removing assert statements from bytecode",
            "-v": "Verbose mode showing module imports and cleanup",
            "-B": "Do not write .pyc bytecode cache files",
            "-u": "Force unbuffered stdout and stderr output",
            "-W": "Control warning message behavior"
        },
        "common_patterns": ["python2 script.py", "python2 -c 'print \"hello\"'", "python2 -m SimpleHTTPServer 8080", "python2 -i debug_script.py"],
        "man_url": "https://docs.python.org/2/using/cmdline.html",
        "use_cases": [
            "Run legacy Python 2 scripts: python2 legacy_script.py",
            "Check if Python 2 is still installed: python2 --version",
            "Maintain compatibility during Python 2 to 3 migration",
        ],
        "gotchas": [
            "Python 2 reached end-of-life on January 1, 2020 -- no security patches are issued",
            "print is a statement in Python 2 (print 'x') but a function in Python 3 (print('x'))",
            "Integer division in Python 2 truncates: 3/2 == 1, not 1.5",
        ],
        "related": ["python3", "pip", "virtualenv", "2to3"],
        "difficulty": "intermediate",
    },
    "python3": {
        "description": "The Python 3 interpreter that executes Python scripts, runs modules, and provides an interactive REPL for rapid prototyping. You'd use it to run Python applications, test code snippets interactively, or invoke built-in tools like pip and venv.",
        "flags": {
            "-c": "Execute a Python command passed as a string argument",
            "-m": "Run a library module as a script by its module name",
            "-i": "Enter interactive mode after executing a script for inspection",
            "-O": "Optimize bytecode by removing assert statements",
            "-B": "Do not write .pyc bytecode cache files on import",
            "-v": "Verbose mode showing module imports and file locations",
            "-u": "Force unbuffered stdout and stderr for real-time output",
            "-E": "Ignore all Python-related environment variables"
        },
        "common_patterns": ["python3 script.py", "python3 -m venv myenv", "python3 -c 'import sys; print(sys.version)'", "python3 -m http.server 8080"],
        "man_url": "https://docs.python.org/3/using/cmdline.html",
        "use_cases": [
            "Run Python scripts: python3 script.py",
            "Quick one-liner: python3 -c 'import json; print(json.dumps({\"a\":1}))'",
            "Start a simple HTTP server: python3 -m http.server 8080",
            "Create virtual environments: python3 -m venv .venv",
        ],
        "gotchas": [
            "python may point to python2 or python3 depending on the system -- always use python3 explicitly",
            "pip install without --user or a venv may require sudo and can break system packages",
            "The GIL limits true parallelism for CPU-bound threads -- use multiprocessing for CPU-heavy work",
        ],
        "related": ["pip", "venv", "ipython", "python2"],
        "difficulty": "beginner",
    },
    "ranger": {
        "description": "A terminal-based file manager with VI key bindings that provides a multi-column directory view with file previews. Use it when you want a visual, keyboard-driven way to browse and manage files without leaving the terminal.",
        "flags": {
            "--choosefile": "Write the selected file path to a file on exit",
            "--choosedir": "Write the last visited directory to a file on exit",
            "--cmd": "Execute a ranger command after startup",
            "--clean": "Do not load any configuration files",
            "--copy-config": "Create a copy of the default config files for customization",
        },
        "common_patterns": ["ranger", "ranger /path/to/dir", "ranger --choosedir=/tmp/rangerdir"],
        "man_url": "https://github.com/ranger/ranger",
        "use_cases": [
            "Navigate and preview files visually in a three-column Miller layout",
            "Perform bulk file operations (rename, move, copy) with vi keybindings",
            "Preview images in terminal with ranger (requires w3m or ueberzug for image support)",
        ],
        "gotchas": [
            "ranger uses vi keybindings by default -- j/k to move, h to go up, l to enter directories",
            "To cd to the last ranger directory on quit, you must use the shell function: add source ranger-cd to your shell config",
            "ranger can be slow on very large directories because it stats every file for preview -- use nnn or lf for large directory trees",
        ],
        "related": ["nnn", "mc", "lf", "broot"],
        "difficulty": "intermediate",
    },
    "rar": {
        "description": "Create and manage RAR archives with support for compression, encryption, multi-volume spanning, and recovery records. You use rar when you need to create .rar files for distribution or when you want features like solid compression and error recovery.",
        "flags": {
            "a": "Add files to a new or existing RAR archive",
            "d": "Delete files from the archive",
            "u": "Update files in the archive, adding new and replacing older versions",
            "t": "Test archive integrity",
            "-p": "Set a password for the archive (prompts for input)",
            "-m": "Set compression level from 0 (store) to 5 (best)",
            "-v": "Create multi-volume archives with the specified size per volume",
            "-r": "Recurse into subdirectories when adding files",
            "-y": "Assume yes on all prompts",
            "x": "Extract with full path",
            "e": "Extract to current directory (flat)",
            "-m5": "Set maximum compression",
        },
        "common_patterns": ["rar a archive.rar files/", "rar a -p archive.rar secret/", "rar a -r -m5 archive.rar directory/", "rar t archive.rar"],
        "man_url": "https://linux.die.net/man/1/rar",
        "use_cases": [
            "Create a RAR archive: rar a archive.rar file1.txt file2.txt",
            "Create a password-protected archive: rar a -p archive.rar secret/",
            "Create a split archive: rar a -v100m archive.rar largefile.bin",
            "Update an existing archive: rar u archive.rar newfile.txt",
        ],
        "gotchas": [
            "RAR is a proprietary format; the rar command for creating archives is not free software and requires a license",
            "For extraction only, use unrar which is available as freeware on most Linux distributions",
            "RAR format is less common on Unix systems; prefer tar+gzip/xz/zstd for Unix-to-Unix transfers",
        ],
        "related": ["unrar", "7z", "zip", "tar"],
        "difficulty": "intermediate",
    },
    "readelf": {
        "description": "A utility that displays detailed information about ELF (Executable and Linkable Format) binary files including headers, sections, and symbols. You'd use it to inspect compiled executables, shared libraries, and object files for debugging or reverse engineering.",
        "flags": {
            "-h": "Display the ELF file header",
            "-l": "Display program headers and segment information",
            "-S": "Display section headers",
            "-s": "Display the symbol table",
            "-d": "Display the dynamic section contents",
            "-a": "Display all available information (equivalent to -h -l -S -s -r -d -n)",
            "-W": "Use wide output format for lines exceeding 80 columns",
            "-e": "Display all headers (equivalent to -h -l -S)",
            "-n": "Display the note segments (build ID, etc.)",
            "-V": "Display the version sections",
        },
        "common_patterns": ["readelf -h binary", "readelf -a program", "readelf -s --wide library.so", "readelf -d /usr/lib/libc.so.6"],
        "man_url": "https://sourceware.org/binutils/docs/binutils/readelf.html",
        "use_cases": [
            "Inspect ELF headers to determine architecture with readelf -h binary",
            "List dynamic library dependencies with readelf -d binary | grep NEEDED",
            "View all symbols including their types and sizes with readelf -s --wide program",
        ],
        "gotchas": [
            "readelf only works on ELF binaries (Linux/Unix) -- it cannot read Mach-O (macOS) or PE (Windows) binaries",
            "Use -W (wide) to prevent long symbol names from being truncated in output",
            "readelf -d shows dynamic section including NEEDED (shared library dependencies) and RPATH -- useful for diagnosing library loading issues",
        ],
        "related": ["objdump", "nm", "ldd", "file"],
        "difficulty": "advanced",
    },
    "reboot": {
        "description": "Restart the system by safely shutting down all services and then re-initializing the boot process. Use it when you need to apply kernel updates, recover from system issues, or complete configuration changes that require a fresh boot.",
        "flags": {
            "-f": "Force immediate reboot without contacting init",
            "-w": "Only write the wtmp reboot record without actually rebooting",
            "--no-wall": "Do not send a wall message before rebooting",
            "-p": "Power off after shutdown instead of rebooting"
        },
        "common_patterns": ["sudo reboot", "sudo reboot -f", "reboot --no-wall", "sudo shutdown -r now"],
        "man_url": "https://man7.org/linux/man-pages/man8/reboot.8.html",
        "use_cases": [
            "Restart the system immediately: sudo reboot",
            "Force reboot a hung system: sudo reboot -f (last resort, may cause data loss)",
        ],
        "gotchas": [
            "reboot -f bypasses normal shutdown procedures and can cause data loss; prefer 'shutdown -r now'",
            "On remote servers, ensure you can access the console before forcing a reboot in case it does not come back",
        ],
        "related": ["shutdown", "poweroff", "halt", "systemctl"],
        "difficulty": "beginner",
    },
    "return": {
        "description": "Exit from a shell function or sourced script with an optional return status code, returning control to the caller. Use it to end a function early and pass a numeric status to the caller, where 0 means success and non-zero indicates an error.",
        "flags": {},
        "common_patterns": ["return", "return 0", "return 1", "[[ condition ]] && return"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Return success from a function: return 0",
            "Return error from a function: return 1",
            "Early exit from a sourced script without killing the caller: return",
            "Propagate a command's exit status: command; return $?",
        ],
        "gotchas": [
            "return can only be used inside a function or a sourced script -- anywhere else gives an error",
            "return with no argument returns the exit status of the last command executed",
            "return does NOT print output -- it only sets the exit code; use echo before return to pass data",
            "In a sourced file, return exits the sourcing back to the caller -- it does not exit the shell like exit would",
        ],
        "related": ["exit", "break", "continue"],
        "difficulty": "beginner",
    },
    "ripgrep": {
        "description": "An extremely fast line-oriented search tool that recursively searches directories using regex patterns, typically invoked as rg. Use it as a modern replacement for grep that respects gitignore rules and provides ergonomic defaults for searching codebases.",
        "flags": {
            "-i": "Case-insensitive search",
            "-w": "Match whole words only",
            "-l": "Print only filenames containing matches",
            "-c": "Print only a count of matching lines per file",
            "-t": "Search only files of the specified type",
            "-g": "Include or exclude files matching the given glob pattern",
            "-n": "Show line numbers (enabled by default)",
            "--hidden": "Search hidden files and directories"
        },
        "common_patterns": ["rg pattern", "rg -i pattern /path", "rg -t py 'import'", "rg -l TODO"],
        "man_url": "https://github.com/BurntSushi/ripgrep/blob/master/GUIDE.md",
        "use_cases": [
            "Search for a pattern in only Python files with rg -t py 'import requests'",
            "Find all TODO and FIXME comments with rg -i 'todo|fixme' --glob '!vendor/'",
            "List only files containing matches with rg -l 'deprecated' for batch processing",
        ],
        "gotchas": [
            "ripgrep skips .gitignore-listed files, hidden files, and binary files by default -- use --no-ignore --hidden to override",
            "ripgrep uses Rust regex syntax which does not support backreferences or lookahead",
            "Typically invoked as rg, not ripgrep -- the binary name is rg",
        ],
        "related": ["grep", "ag", "ack", "fd"],
        "difficulty": "beginner",
    },
    "route": {
        "description": "Display and manipulate the kernel IP routing table that determines how network packets are forwarded to their destinations. Use it to add static routes, set default gateways, or debug routing issues, though the ip route command is its modern replacement.",
        "flags": {
            "-n": "Show numerical addresses without resolving hostnames",
            "add": "Add a new route to the routing table",
            "del": "Delete a route from the routing table",
            "-net": "Specify a network destination",
            "-host": "Specify a host destination",
            "default": "Operate on the default gateway route",
            "gw": "Specify the gateway address for a route"
        },
        "common_patterns": ["route -n", "sudo route add default gw 192.168.1.1", "sudo route add -net 10.0.0.0/8 gw 192.168.1.254", "sudo route del default"],
        "man_url": "https://man7.org/linux/man-pages/man8/route.8.html",
        "use_cases": [
            "View the kernel routing table: route -n",
            "Add a default gateway: route add default gw 192.168.1.1",
            "Add a route to a specific network: route add -net 10.0.0.0/8 gw 192.168.1.254",
        ],
        "gotchas": [
            "route is deprecated; use ip route on modern systems for full functionality",
            "Routes added with route are not persistent -- they disappear on reboot unless added to startup scripts",
            "Forgetting -n causes slow output because route tries to reverse-DNS every address",
        ],
        "related": ["ip", "netstat", "traceroute"],
        "difficulty": "intermediate",
    },
    "rpm": {
        "description": "The low-level Red Hat Package Manager that directly installs, queries, and verifies RPM packages on RHEL, Fedora, and CentOS. It handles individual package files without automatic dependency resolution from repositories.",
        "flags": {
            "-i": "Install an RPM package file",
            "-U": "Upgrade a package or install it if not already present",
            "-e": "Erase (uninstall) a package from the system",
            "-q": "Query whether a specific package is installed",
            "-qa": "List all installed packages on the system",
            "-ql": "List all files installed by a specific package",
            "-v": "Print verbose output during operations",
            "-h": "Display hash marks as a progress bar during installation",
            "-qf": "Query which package owns a file",
            "-V": "Verify installed package against RPM database",
            "-K": "Check package signature and integrity",
            "--import": "Import a GPG public key for package verification",
            "-ivh": "Install with verbose output and progress hash marks",
        },
        "common_patterns": ["rpm -ivh package.rpm", "rpm -qa | grep pattern", "rpm -e package_name", "rpm -Uvh package.rpm"],
        "man_url": "https://man7.org/linux/man-pages/man8/rpm.8.html",
        "use_cases": [
            "Install an RPM package file: rpm -ivh package.rpm",
            "Query all installed packages: rpm -qa",
            "Find which package owns a file: rpm -qf /usr/bin/vim",
            "List all files in an installed package: rpm -ql nginx",
            "Verify integrity of installed package files: rpm -V nginx",
        ],
        "gotchas": [
            "rpm does not resolve dependencies -- installing with rpm -i will fail if dependencies are missing; use dnf or yum for dependency resolution",
            "rpm -U (upgrade) removes the old version before installing the new one -- for the kernel, use rpm -i instead so you keep the old kernel as a fallback",
            "rpm -e (erase) will refuse to remove a package if others depend on it -- use --nodeps to force removal, but this can break the system",
        ],
        "related": ["dnf", "yum", "zypper", "rpmbuild"],
        "difficulty": "intermediate",
    },
    "ruby": {
        "description": "The Ruby programming language interpreter that executes Ruby scripts and one-liners from the command line. You'd use it to run Ruby applications, quick text processing tasks, or system administration scripts.",
        "flags": {
            "-e": "Execute a one-line script directly from the command line",
            "-c": "Check syntax of the script without executing it",
            "-w": "Enable warning mode for suspicious code patterns",
            "-v": "Print version and enable verbose mode during execution",
            "-I": "Add a directory to the load path for require statements",
            "-r": "Require a library before executing the script",
            "-n": "Wrap script in a while-gets loop for line-by-line input processing",
            "-p": "Same as -n but also prints each line after processing"
        },
        "common_patterns": ["ruby script.rb", "ruby -e 'puts \"hello\"'", "ruby -c syntax_check.rb", "ruby -ne 'puts $_ if /pattern/' file.txt"],
        "man_url": "https://ruby-doc.org/3.3/",
        "use_cases": [
            "Run a Ruby script with ruby script.rb",
            "Execute a one-liner with ruby -e 'puts RUBY_VERSION'",
            "Process text line by line with ruby -ne 'puts $_ if /ERROR/' logfile.txt",
            "Check syntax without executing with ruby -c script.rb",
        ],
        "gotchas": [
            "Ruby version management requires rbenv or rvm -- system Ruby is often outdated",
            "Ruby's -i flag for in-place editing requires a backup extension on macOS (ruby -i.bak -pe ...) but not on Linux",
            "Ruby's standard library is being extracted into gems in Ruby 3.x -- some imports that worked before may now require gem install",
        ],
        "related": ["gem", "bundle", "irb", "perl"],
        "difficulty": "intermediate",
    },
    "runlevel": {
        "description": "Display the previous and current SysVinit runlevel of the system. Use it on older init systems to verify which runlevel the system is operating in, though on systemd systems the equivalent information comes from systemctl get-default.",
        "flags": {},
        "common_patterns": ["runlevel", "who -r"],
        "man_url": "https://man7.org/linux/man-pages/man8/runlevel.8.html",
        "use_cases": ["Check the current runlevel on a SysVinit system: runlevel"],
        "gotchas": [
            "runlevel is a SysVinit concept; on systemd systems, use systemctl get-default for the equivalent information",
            "Output shows two values: previous and current runlevel; N means no previous runlevel was recorded",
        ],
        "related": ["init", "systemctl"],
        "difficulty": "intermediate",
    },
    "rust": {
        "description": "The Rust toolchain manager (via cargo) that builds, tests, and manages Rust projects with dependency resolution and compilation. You'd use cargo as the primary interface for creating new projects, building code, running tests, and publishing crates.",
        "flags": {
            "--release": "Build with optimizations enabled for production use",
            "--verbose": "Show detailed output including compiler invocations",
            "--jobs": "Set the number of parallel compilation jobs",
            "--target": "Cross-compile for a specific target architecture triple",
            "--features": "Enable specific feature flags defined in Cargo.toml",
            "--all-targets": "Build all targets including tests, benches, and examples",
            "--offline": "Run without accessing the network for dependency resolution",
            "--locked": "Require Cargo.lock is up to date and do not update it",
            "--edition": "Set the Rust edition (2015, 2018, 2021)",
            "clippy": "Run the Rust linter via cargo clippy",
            "fmt": "Format code via cargo fmt",
            "doc": "Generate documentation via cargo doc",
        },
        "common_patterns": ["cargo new myproject", "cargo build --release", "cargo test", "cargo run -- arg1 arg2"],
        "man_url": "https://doc.rust-lang.org/cargo/",
        "use_cases": [
            "Create a new Rust project with cargo new myproject",
            "Build and run a project with cargo run",
            "Build an optimized release binary with cargo build --release",
            "Run tests with cargo test",
        ],
        "gotchas": [
            "The rust entry in most contexts refers to Cargo, the Rust build tool -- the actual compiler is rustc, but cargo is the standard interface",
            "cargo build --release applies optimizations that make binaries dramatically faster -- always benchmark with --release, not debug builds",
            "First compilation downloads and compiles all dependencies which can take several minutes -- subsequent builds use cached artifacts",
            "Rust's borrow checker produces unique errors that require understanding ownership semantics -- read the error messages carefully as they usually suggest fixes",
        ],
        "related": ["rustc", "rustup", "cargo"],
        "difficulty": "intermediate",
    },
    "rustc": {
        "description": "The Rust programming language compiler that translates Rust source code into optimized native executables. You'd use it to compile individual Rust files, though most projects use Cargo which invokes rustc internally.",
        "flags": {
            "--edition": "Specify the Rust edition to use (2015, 2018, 2021)",
            "--crate-type": "Set the type of crate to build (bin, lib, proc-macro)",
            "-o": "Specify the output filename for the compiled binary",
            "-O": "Enable optimizations equivalent to opt-level 2",
            "-g": "Include debug information in the compiled output",
            "--target": "Cross-compile for a different target architecture",
            "--emit": "Control what types of output files the compiler generates",
            "-C": "Set a codegen option like opt-level or lto"
        },
        "common_patterns": ["rustc main.rs", "rustc -O --edition 2021 main.rs -o app", "rustc --crate-type lib mylib.rs", "rustc --target aarch64-unknown-linux-gnu main.rs"],
        "man_url": "https://doc.rust-lang.org/rustc/",
        "use_cases": [
            "Compile a single Rust file with rustc main.rs",
            "Compile with optimizations with rustc -O main.rs -o app",
            "Cross-compile for a different target with rustc --target aarch64-unknown-linux-gnu main.rs",
        ],
        "gotchas": [
            "rustc is rarely invoked directly -- use cargo which manages dependencies, build configuration, and invokes rustc internally",
            "rustc defaults to the 2015 edition unless --edition is specified -- use --edition 2021 for modern Rust features",
            "Cross-compilation with rustc requires the target to be installed via rustup target add -- the linker for the target must also be available",
        ],
        "related": ["rust", "cargo", "rustup"],
        "difficulty": "intermediate",
    },
    "rustup": {
        "description": "The official toolchain manager for the Rust programming language that installs and manages multiple Rust versions. It handles switching between stable, beta, and nightly toolchains and installing additional components.",
        "flags": {
            "update": "Update all installed Rust toolchains and rustup itself",
            "default": "Set the default Rust toolchain used for new shells",
            "show": "Display the currently active and installed toolchains",
            "toolchain": "Manage installed toolchains including install and uninstall",
            "component": "Add or remove individual toolchain components like clippy or rustfmt",
            "target": "Add or remove compilation targets for cross-compilation",
            "override": "Set a directory-specific toolchain override",
            "doc": "Open the Rust documentation in a web browser",
        
            "self update": "Update rustup itself",
        },
        "common_patterns": ["rustup update", "rustup default stable", "rustup component add clippy", "rustup target add wasm32-unknown-unknown"],
        "man_url": "https://rust-lang.github.io/rustup/",
        "use_cases": [
            "Install the stable Rust toolchain: rustup install stable",
            "Switch to the nightly toolchain: rustup default nightly",
            "Add a compilation target for cross-compiling: rustup target add wasm32-unknown-unknown",
            "Update all installed toolchains: rustup update",
            "Install a specific component like Clippy: rustup component add clippy",
        ],
        "gotchas": [
            "rustup override set nightly applies only to the current directory -- it does not change your global default",
            "Nightly toolchains can break between days -- use rustup run nightly-2024-01-15 to pin a specific date",
            "rustup self update updates rustup itself, while rustup update updates the Rust toolchains -- they are different operations",
        ],
        "related": ["cargo", "rustc"],
        "difficulty": "intermediate",
    },
    "sar": {
        "description": "Collect, report, and save system activity information including CPU, memory, disk, and network statistics over time. Use it for historical performance analysis when you need to investigate what happened on a system at a specific time in the past.",
        "flags": {
            "-u": "Report CPU utilization statistics",
            "-r": "Report memory utilization statistics",
            "-b": "Report I/O and transfer rate statistics",
            "-n": "Report network statistics (DEV, EDEV, SOCK, etc.)",
            "-d": "Report activity for each block device",
            "-q": "Report queue length and load averages",
            "-f": "Read data from a specified file instead of current data"
        },
        "common_patterns": ["sar -u 1 5", "sar -r", "sar -n DEV", "sar -f /var/log/sa/sa01"],
        "man_url": "https://man7.org/linux/man-pages/man1/sar.1.html",
        "use_cases": [
            "Review CPU usage from yesterday: sar -u -f /var/log/sa/sa$(date -d yesterday +%d)",
            "Check historical memory usage: sar -r",
            "Monitor network throughput: sar -n DEV 1 5",
            "Investigate a performance incident that happened at 3am: sar -u -s 03:00:00 -e 04:00:00",
        ],
        "gotchas": [
            "sar requires the sysstat package and its data collection service (sadc) must be enabled",
            "Data files are stored in /var/log/sa/ and rotate monthly; older data may be overwritten",
            "sar collects data at 10-minute intervals by default; for finer granularity, adjust the cron job",
        ],
        "related": ["vmstat", "iostat", "mpstat", "atop"],
        "difficulty": "advanced",
    },
    "scala": {
        "description": "The Scala compiler and runner that compiles Scala source code to JVM bytecode or runs Scala scripts and applications. You'd use it to compile functional and object-oriented Scala programs or to launch an interactive Scala REPL.",
        "flags": {
            "-d": "Set the destination directory for generated class files",
            "-classpath": "Specify the classpath for compilation dependencies",
            "-deprecation": "Emit warning and location for usages of deprecated APIs",
            "-feature": "Emit warning and location for usages of features that should be imported",
            "-unchecked": "Enable additional warnings for type erasure related patterns",
            "-Werror": "Treat all warnings as compilation errors",
            "-opt": "Enable optimization passes like inlining"
        },
        "common_patterns": ["scalac Hello.scala", "scala Hello", "scala -classpath lib.jar:. MainApp", "scalac -deprecation -feature Main.scala"],
        "man_url": "https://docs.scala-lang.org/scala3/book/tools-scala.html",
        "use_cases": [
            "Compile a Scala file with scalac Hello.scala then run with scala Hello",
            "Start the Scala REPL for interactive exploration with scala",
            "Run a Scala script directly with scala script.sc (Scala 3)",
        ],
        "gotchas": [
            "Scala 2 and Scala 3 have significant syntax differences -- check which version you are using with scala -version",
            "Scala compilation is notoriously slow -- incremental compilation with sbt or Bloop dramatically improves edit-compile-run cycles",
            "The scala command is both a REPL and a script runner -- behavior depends on whether you pass a file argument",
        ],
        "related": ["java", "javac", "kotlin", "sbt"],
        "difficulty": "advanced",
    },
    "service": {
        "description": "Start, stop, restart, and check the status of system services using the traditional SysVinit interface. Use it on systems that still use init scripts, or as a compatibility wrapper that redirects to systemctl on systemd-based distributions.",
        "flags": {
            "--status-all": "Show the status of all known services",
            "start": "Start the named service",
            "stop": "Stop the named service",
            "restart": "Restart the named service",
            "status": "Show current status of the named service"
        },
        "common_patterns": ["sudo service nginx restart", "service --status-all", "sudo service ssh status", "sudo service mysql start"],
        "man_url": "https://man7.org/linux/man-pages/man8/service.8.html",
        "use_cases": [
            "Restart a service on any Linux system (works with both SysVinit and systemd): service nginx restart",
            "Check the status of all services at once: service --status-all",
        ],
        "gotchas": [
            "On systemd systems, service is a compatibility wrapper that redirects to systemctl -- use systemctl directly for full functionality",
            "service --status-all output uses +/- symbols that may not show the full picture on systemd systems",
        ],
        "related": ["systemctl", "init"],
        "difficulty": "beginner",
    },
    "setfacl": {
        "description": "Set or modify Access Control Lists (ACLs) on files and directories, enabling fine-grained permission control beyond the traditional owner/group/other model. Use it to grant specific users or groups access to files without changing ownership.",
        "flags": {
            "-m": "Modify the ACL by adding or updating entries",
            "-x": "Remove specific ACL entries",
            "-b": "Remove all ACL entries (restore to base permissions)",
            "-R": "Apply ACL changes recursively to directories and their contents",
            "-d": "Apply operations to the default ACL (inherited by new files in a directory)",
            "-k": "Remove the default ACL"
        },
        "common_patterns": ["setfacl -m u:user:rwx file", "setfacl -m g:group:rx directory", "setfacl -R -m u:user:r dir/", "setfacl -x u:user file"],
        "man_url": "https://man7.org/linux/man-pages/man1/setfacl.1.html",
        "use_cases": [
            "Grant a specific user access: setfacl -m u:bob:rwx /shared/project",
            "Set default ACL for new files in a directory: setfacl -d -m g:dev:rw /shared",
            "Remove all ACLs: setfacl -b /shared/project",
        ],
        "gotchas": [
            "The ACL mask limits effective permissions for named users and groups -- set mask explicitly if needed",
            "Default ACLs only apply to newly created files, not existing ones",
            "Some backup tools (tar without --acls) do not preserve ACLs",
        ],
        "related": ["getfacl", "chmod", "chown", "umask"],
        "difficulty": "advanced",
    },
    "shift": {
        "description": "Shift positional parameters to the left by the specified number of positions, discarding the first N and renumbering the rest. Use it in scripts that process command-line arguments one at a time in a while loop.",
        "flags": {},
        "common_patterns": ["shift", "shift 2", "while [[ $# -gt 0 ]]; do case $1 in ...) shift ;; esac; done"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Process command-line arguments one at a time: while [[ $# -gt 0 ]]; do arg=$1; shift; done",
            "Skip processed options: shift 2 to discard both the flag and its value",
            "Implement custom argument parsing in shell scripts",
        ],
        "gotchas": [
            "shift when there are no positional parameters ($# is 0) returns an error and does nothing",
            "shift N where N is greater than $# also returns an error in bash",
            "$0 (the script name) is never shifted -- shift only affects $1, $2, etc.",
            "Shifted parameters are gone permanently -- save them to variables first if you need them later",
        ],
        "related": ["getopts", "set"],
        "difficulty": "beginner",
    },
    "shopt": {
        "description": "Set or unset optional shell behavior options that control features like globbing, history, and error handling in bash. Use it to customize bash behavior, such as enabling recursive globbing with globstar or case-insensitive pattern matching with nocaseglob.",
        "flags": {
            "-s": "Enable (set) the specified shell option",
            "-u": "Disable (unset) the specified shell option",
            "-o": "Restrict options to those settable with set -o",
            "-p": "Print all shell options and their current status",
            "-q": "Quiet mode; suppress output and return status via exit code only"
        },
        "common_patterns": ["shopt -s globstar", "shopt -s nocaseglob", "shopt -u histappend", "shopt -p"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/The-Shopt-Builtin.html",
        "use_cases": [
            "Enable recursive globbing: shopt -s globstar (then **/*.py matches all Python files)",
            "Case-insensitive globbing: shopt -s nocaseglob",
            "Append to history instead of overwriting: shopt -s histappend",
            "Allow cd to correct minor typos: shopt -s cdspell",
            "Include dotfiles in glob expansion: shopt -s dotglob",
            "Check option status quietly: shopt -q globstar && echo 'on'",
        ],
        "gotchas": [
            "shopt options are different from set options -- shopt -s vs set -o control different settings",
            "globstar (**) in bash < 4.0 is not available; bash on macOS defaults to 3.2",
            "shopt -s failglob causes an error when a glob matches nothing, instead of returning the pattern literally",
            "Some shopt settings affect interactive shells only (like cdspell) and are irrelevant in scripts",
        ],
        "related": ["set", "bash"],
        "difficulty": "intermediate",
    },
    "shutdown": {
        "description": "Schedule or immediately perform a system shutdown, reboot, or halt with optional warning messages to logged-in users. Use it instead of poweroff or reboot when you want to give users advance notice or schedule the shutdown for a specific time.",
        "flags": {
            "-h": "Halt or power off after shutdown",
            "-r": "Reboot after shutdown",
            "-c": "Cancel a pending scheduled shutdown",
            "-k": "Send warning messages only without actually shutting down",
            "--no-wall": "Do not send wall messages to users"
        },
        "common_patterns": ["sudo shutdown -h now", "sudo shutdown -r +10 'Rebooting for updates'", "sudo shutdown -c", "sudo shutdown -h 22:00"],
        "man_url": "https://man7.org/linux/man-pages/man8/shutdown.8.html",
        "use_cases": [
            "Shut down immediately: shutdown -h now",
            "Schedule a reboot with user warning: shutdown -r +10 'Rebooting for kernel update'",
            "Cancel a pending shutdown: shutdown -c",
        ],
        "gotchas": [
            "shutdown sends wall messages to logged-in users; use --no-wall to suppress in automated scenarios",
            "On systemd systems, 'shutdown +5' creates a transient timer; systemctl status shutdown.target shows the scheduled time",
        ],
        "related": ["reboot", "poweroff", "halt", "systemctl"],
        "difficulty": "beginner",
    },
    "snap": {
        "description": "The package manager for snap packages on Ubuntu and other Linux distributions with automatic updates and sandboxed isolation. It provides a universal packaging format that bundles applications with all their dependencies.",
        "flags": {
            "install": "Install a snap package from the Snap Store",
            "remove": "Remove an installed snap package from the system",
            "refresh": "Update installed snaps to their latest available versions",
            "list": "List all currently installed snap packages",
            "find": "Search the Snap Store for available packages",
            "--classic": "Install a snap with classic confinement allowing full system access",
            "--channel": "Specify the release channel to install from (stable, beta, edge)",
            "--devmode": "Install with relaxed security confinement for development",
            "info": "Show detailed information about a snap",
            "connections": "Show interface connections for a snap",
        },
        "common_patterns": ["snap install package_name", "snap list", "snap refresh", "snap remove package_name"],
        "man_url": "https://snapcraft.io/docs",
        "use_cases": [
            "Install an application as a snap: snap install vlc",
            "List all installed snaps and their versions: snap list",
            "Update all installed snaps to latest versions: snap refresh",
            "Remove a snap application: snap remove vlc",
            "Revert a snap to its previous version after a bad update: snap revert vlc",
        ],
        "gotchas": [
            "Snaps auto-update in the background, which can restart running applications unexpectedly -- use snap refresh --hold to pause updates",
            "Snaps run in a sandboxed environment and may not have access to all system files -- use snap connect to grant additional permissions",
            "Snap applications may start slower than native packages because they mount a squashfs image on each launch",
            "The snap store is Canonical-controlled; not all snaps are open-source even if the snap format is",
        ],
        "related": ["flatpak", "apt", "apt-get"],
        "difficulty": "beginner",
    },
    "socat": {
        "description": "A multipurpose relay tool that establishes two bidirectional byte streams and transfers data between them, supporting TCP, UDP, Unix sockets, SSL, and more. Use it as a more powerful alternative to netcat for complex scenarios like SSL tunneling, proxy forwarding, and socket type conversion.",
        "flags": {
            "-d": "Increase verbosity level (use -d -d for more detail)",
            "-v": "Write data to stderr in a human-readable format",
            "-x": "Write data to stderr in hexadecimal format",
            "-u": "Unidirectional mode from left to right address only",
            "-T": "Set inactivity timeout in seconds",
        
            "-4": "Use IPv4 only",
            "-6": "Use IPv6 only",
            "-t": "Set EOF timeout in seconds",
            "-b": "Set data transfer block size (default 8192)",
        },
        "common_patterns": ["socat TCP-LISTEN:8080,fork TCP:remote:80", "socat - TCP:host:port", "socat TCP-LISTEN:443,fork,reuseaddr OPENSSL:target:443", "socat UNIX-LISTEN:/tmp/sock,fork TCP:localhost:8080"],
        "man_url": "https://man7.org/linux/man-pages/man1/socat.1.html",
        "use_cases": [
            "Forward a local TCP port to a remote host: socat TCP-LISTEN:8080,fork TCP:remote:80",
            "Create an SSL-encrypted tunnel: socat TCP-LISTEN:443,fork,reuseaddr OPENSSL:target:443",
            "Bridge a Unix socket to a TCP port for remote access to Docker or database sockets",
            "Connect two different socket types, like converting a serial port to a TCP stream",
        ],
        "gotchas": [
            "socat address syntax is powerful but complex -- the learning curve is steep compared to netcat",
            "Forgetting the fork option on a listener means it handles only one connection then exits",
            "The reuseaddr option is often needed to avoid 'address already in use' errors on quick restarts",
        ],
        "related": ["nc", "ncat", "ssh", "openssl"],
        "difficulty": "advanced",
    },
    "su": {
        "description": "Switch the current user identity to another user account, launching a new shell as that user. Use it when you need to perform tasks as a different user, especially root, without logging out of your current session.",
        "flags": {
            "-": "Start a login shell with the target user's full environment",
            "-l": "Start a login shell (same as -)",
            "-c": "Pass a single command to the shell instead of starting an interactive session",
            "-s": "Specify the shell to run instead of the target user's default shell",
            "-m": "Preserve the current environment variables instead of resetting them",
            "-p": "Same as -m; do not reset environment variables"
        },
        "common_patterns": ["su -", "su - root", "su -c 'command' user", "su -l username"],
        "man_url": "https://man7.org/linux/man-pages/man1/su.1.html",
        "use_cases": [
            "Switch to root: su -",
            "Run a command as another user: su -c 'whoami' postgres",
            "Open a login shell as another user: su - deploy",
        ],
        "gotchas": [
            "su without - does not set a login environment -- PATH and other variables remain from the original user",
            "su requires the target user's password, while sudo requires your own password",
            "su to root leaves no audit trail of which user invoked it -- sudo provides better accountability",
        ],
        "related": ["sudo", "doas", "runuser", "newgrp"],
        "difficulty": "intermediate",
    },
    "sudo": {
        "description": "Execute a command as another user, typically root, after authenticating with your own password according to the sudoers policy. Use it to perform privileged operations without switching to the root account or sharing the root password.",
        "flags": {
            "-u": "Run the command as the specified user instead of root",
            "-i": "Simulate an initial login shell for the target user",
            "-s": "Run the target user's shell",
            "-l": "List the allowed (and forbidden) commands for the invoking user",
            "-k": "Invalidate the cached credentials, forcing re-authentication next time",
            "-E": "Preserve the current environment variables",
            "-n": "Non-interactive mode; do not prompt for a password",
            "-b": "Run the command in the background"
        },
        "common_patterns": ["sudo command", "sudo -i", "sudo -u user command", "sudo -l"],
        "man_url": "https://man7.org/linux/man-pages/man8/sudo.8.html",
        "use_cases": [
            "Run a command as root: sudo apt update",
            "Edit a protected file: sudo -e /etc/hosts (uses sudoedit)",
            "Run as another user: sudo -u postgres psql",
            "List allowed commands: sudo -l",
        ],
        "gotchas": [
            "sudo caches credentials for a timeout period -- use sudo -k to invalidate the cache",
            "Environment variables are reset by default -- use sudo -E or specific env_keep in sudoers to preserve them",
            "Piping with sudo fails: 'sudo echo x > /etc/file' -- use 'echo x | sudo tee /etc/file' instead",
        ],
        "related": ["su", "doas", "visudo", "pkexec"],
        "difficulty": "intermediate",
    },
    "swift": {
        "description": "The Swift programming language interpreter and REPL that can run Swift scripts directly or launch an interactive coding session. You'd use it to quickly prototype Swift code, run scripts, or test language features without creating a full Xcode project.",
        "flags": {
            "-O": "Compile with optimizations enabled",
            "-g": "Emit debug information for use with debuggers",
            "-v": "Show verbose output including underlying compiler commands",
            "-I": "Add a directory to the import search path",
            "-L": "Add a directory to the library search path",
            "-target": "Generate code for the specified target triple"
        },
        "common_patterns": ["swift script.swift", "swift -e 'print(\"hello\")'", "swift build", "swift package init --type executable"],
        "man_url": "https://www.swift.org/documentation/",
        "use_cases": [
            "Run a Swift script directly with swift script.swift",
            "Create a new executable package with swift package init --type executable",
            "Build a package in release mode with swift build -c release",
        ],
        "gotchas": [
            "Swift on Linux requires the Swift toolchain to be installed separately -- it is not included in standard Linux distributions",
            "swift build uses Swift Package Manager (SPM) not Xcode build settings -- project structure must follow SPM conventions",
            "Swift REPL is started with just swift (no arguments) -- it can be slow to launch on first use due to compilation",
        ],
        "related": ["swiftc", "xcode", "lldb"],
        "difficulty": "intermediate",
    },
    "swiftc": {
        "description": "The Swift compiler that compiles Swift source files into native executables, libraries, or object files. You'd use it to compile Swift code directly from the command line when you need more control than swift build provides.",
        "flags": {
            "-o": "Specify the output file name for the compiled binary",
            "-O": "Compile with optimizations enabled for release builds",
            "-g": "Generate debug information for use with lldb",
            "-emit-library": "Generate a dynamic library instead of an executable",
            "-emit-object": "Generate object files without linking",
            "-module-name": "Set the name of the Swift module being built",
            "-Werror": "Treat all warnings as compilation errors",
            "-parse-as-library": "Parse the input as a library instead of a script"
        },
        "common_patterns": ["swiftc main.swift -o app", "swiftc -O -o release_app main.swift", "swiftc -emit-library -o libutils.dylib utils.swift", "swiftc -g -o debug_app main.swift utils.swift"],
        "man_url": "https://www.swift.org/documentation/",
        "use_cases": [
            "Compile a Swift file to an executable with swiftc main.swift -o app",
            "Compile with optimizations for release with swiftc -O main.swift -o release_app",
            "Create a dynamic library with swiftc -emit-library -o libutils.dylib utils.swift",
        ],
        "gotchas": [
            "swiftc compiles individual files -- for multi-file projects with dependencies, use Swift Package Manager (swift build) instead",
            "Swift ABI stability (Swift 5.0+) means the runtime is part of the OS on macOS but must be bundled on Linux",
            "swiftc error messages can be long for generic type errors -- look for 'note:' lines that explain the root cause",
        ],
        "related": ["swift", "clang", "lldb"],
        "difficulty": "intermediate",
    },
    "telnet": {
        "description": "Connect to a remote host over an unencrypted TCP connection for interactive communication with network services. Use it for testing and debugging plain-text protocols like SMTP, HTTP, and POP3, though SSH should always be used instead for remote login.",
        "flags": {
            "-l": "Specify the user to log in as",
            "-a": "Attempt automatic login",
            "-e": "Set the escape character"
        },
        "common_patterns": ["telnet host 80", "telnet smtp.example.com 25", "telnet localhost 6379", "telnet host 443"],
        "man_url": "https://man7.org/linux/man-pages/man1/telnet.1.html",
        "use_cases": [
            "Test if a web server is responding: telnet host 80 then type GET / HTTP/1.0",
            "Debug SMTP mail delivery by connecting to port 25 and issuing EHLO, MAIL FROM, RCPT TO commands",
            "Verify a Redis server is accessible: telnet host 6379 then type PING",
            "Check if a specific port is reachable through a firewall when nc is not installed",
        ],
        "gotchas": [
            "telnet transmits everything including passwords in plain text -- never use it for actual remote login; use SSH instead",
            "telnet is not installed by default on many modern distributions; you may need to install it explicitly",
            "The escape character (default Ctrl-]) is needed to close a telnet session; just closing the terminal may leave the connection open",
        ],
        "related": ["ssh", "nc", "curl", "openssl"],
        "difficulty": "beginner",
    },
    "terraform": {
        "description": "An infrastructure-as-code tool that provisions and manages cloud resources through declarative configuration files. You'd use it to create reproducible infrastructure across AWS, Azure, GCP, and many other providers.",
        "flags": {
            "-auto-approve": "Skip interactive approval before applying changes",
            "-var": "Set a variable value on the command line",
            "-var-file": "Load variable values from a file",
            "-target": "Target a specific resource for the operation",
            "-lock": "Control whether state locking is used during operations",
            "-input": "Disable interactive prompts for missing variable values",
            "-json": "Output results in machine-readable JSON format",
            "-parallelism": "Limit the number of concurrent resource operations",
            "-compact-warnings": "Show warnings in a compact single-line format",
            "-refresh-only": "Update state to match real infrastructure without changing resources",
            "state": "Advanced state management subcommand (mv, rm, list, show)",
            "import": "Import existing infrastructure into Terraform management",
        },
        "common_patterns": ["terraform init", "terraform plan -out=tfplan", "terraform apply -auto-approve", "terraform destroy -target=aws_instance.main"],
        "man_url": "https://developer.hashicorp.com/terraform/cli",
        "use_cases": [
            "Initialize a project and download providers with terraform init",
            "Preview infrastructure changes before applying with terraform plan -out=tfplan",
            "Apply infrastructure changes with terraform apply tfplan",
            "Tear down all managed infrastructure with terraform destroy (use with extreme caution)",
        ],
        "gotchas": [
            "Terraform state is critical -- losing the state file means Terraform no longer knows about your infrastructure. Use remote backends (S3, GCS) not local state",
            "terraform destroy destroys ALL resources in the state -- there is no undo. Always use -target for selective destruction",
            "State locking prevents concurrent modifications -- if a lock gets stuck, use terraform force-unlock (dangerous)",
            "Terraform plan can show no changes but apply can still fail due to API errors, permissions, or rate limits",
        ],
        "related": ["ansible", "kubectl", "docker"],
        "difficulty": "intermediate",
    },
    "tftp": {
        "description": "Transfer files using the Trivial File Transfer Protocol, a simplified version of FTP that uses UDP and provides no authentication. Use it for network booting (PXE), firmware updates on embedded devices, or transferring files in simple network environments where security is not a concern.",
        "flags": {
            "-v": "Verbose mode showing additional transfer details",
            "-m": "Set the transfer mode (binary or ascii)",
            "get": "Download a file from the TFTP server",
            "put": "Upload a file to the TFTP server"
        },
        "common_patterns": ["tftp 192.168.1.1", "tftp -v 192.168.1.1 -c get firmware.bin", "echo 'get config.txt' | tftp 192.168.1.1", "tftp -m binary 10.0.0.1"],
        "man_url": "https://man7.org/linux/man-pages/man1/tftp.1.html",
        "use_cases": [
            "Network boot (PXE) servers use TFTP to deliver boot images to diskless clients",
            "Push firmware updates to network switches and routers that support TFTP",
            "Transfer configuration files to embedded devices with minimal network stacks",
        ],
        "gotchas": [
            "TFTP has no authentication whatsoever -- anyone on the network can read or write files if the server allows it",
            "TFTP uses UDP port 69 and has a maximum file size of 32MB in the original protocol (extensions exist but are not universal)",
            "The TFTP server directory must be pre-configured; you cannot browse or list files like FTP",
        ],
        "related": ["ftp", "scp", "curl"],
        "difficulty": "intermediate",
    },
    "tig": {
        "description": "Ncurses-based text-mode interface for browsing Git repositories with interactive views for logs, diffs, blame, and status. You use tig as a terminal-friendly alternative to gitk when you want a visual Git browser without leaving the command line.",
        "flags": {
            "log": "Start in log view showing git-log output",
            "show": "Open diff view using git-show options",
            "blame": "Show file annotations by commit (like git blame)",
            "status": "Show working tree status with staging support",
            "stash": "Browse stash entries",
            "grep": "Search through repository content interactively",
            "refs": "Browse all references (branches, tags)"
        },
        "common_patterns": ["tig", "tig blame file.py", "tig log --since='1 month ago'", "tig status"],
        "man_url": "https://jonas.github.io/tig/doc/tig.1.html",
        "use_cases": [
            "Browse commit history interactively: tig",
            "View blame annotation for a file: tig blame file.py",
            "Check working tree status with staging support: tig status",
            "View stash entries: tig stash",
            "Browse commits for a specific file: tig -- path/to/file",
        ],
        "gotchas": [
            "tig is read-mostly -- you can stage changes from the status view but most operations still require the git CLI",
            "Navigation uses Vim-like keys (j/k for movement, Enter to open, q to quit) which can be unfamiliar",
            "tig requires ncurses and may not be available by default on minimal server installs",
        ],
        "related": ["git", "gitk", "gh"],
        "difficulty": "intermediate",
    },
    "timedatectl": {
        "description": "Query and change the system clock, timezone, and NTP synchronization settings using systemd. Use it to configure time-related settings on modern Linux systems instead of manually editing timezone files or running ntpd.",
        "flags": {
            "status": "Show current time, timezone, and NTP status",
            "set-time": "Set the system time manually",
            "set-timezone": "Set the system timezone",
            "set-ntp": "Enable or disable NTP synchronization",
            "list-timezones": "List all available timezones"
        },
        "common_patterns": ["timedatectl", "sudo timedatectl set-timezone America/New_York", "timedatectl list-timezones", "sudo timedatectl set-ntp true"],
        "man_url": "https://man7.org/linux/man-pages/man1/timedatectl.1.html",
        "use_cases": [
            "Check current time, timezone, and NTP sync status: timedatectl",
            "Set the timezone: sudo timedatectl set-timezone America/New_York",
            "Enable NTP synchronization: sudo timedatectl set-ntp true",
        ],
        "gotchas": [
            "timedatectl requires systemd and conflicts with running ntpd or chrony in some configurations",
            "Setting time manually with set-time disables NTP; re-enable with set-ntp true afterward",
        ],
        "related": ["date", "hostnamectl", "localectl"],
        "difficulty": "beginner",
    },
    "times": {
        "description": "Print the accumulated user and system CPU times for the shell and all of its child processes. Use it to get a rough measure of how much CPU time your shell session and its commands have consumed.",
        "flags": {},
        "common_patterns": ["times"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Measure total CPU time used by a shell session: times",
            "Check how much user vs system time scripts consumed",
            "Quick profiling to see if your session is CPU-intensive",
        ],
        "gotchas": [
            "times shows cumulative time for the shell AND all child processes, not individual command times -- use time for that",
            "Output has two lines: first line is the shell itself, second line is all child processes",
            "times takes no arguments -- it always reports on the current shell",
            "The values are only meaningful for long-running sessions; short sessions show 0m0.000s",
        ],
        "related": ["time", "ps"],
        "difficulty": "intermediate",
    },
    "tracepath": {
        "description": "Trace the network path to a destination host, discovering MTU along the route without requiring root privileges. Use it as a simpler alternative to traceroute that automatically discovers the path MTU, which helps diagnose packet fragmentation issues.",
        "flags": {
            "-n": "Do not resolve IP addresses to hostnames",
            "-b": "Print both hostname and IP address",
            "-l": "Set the initial packet length",
            "-m": "Set the maximum number of hops",
            "-p": "Set the initial destination port"
        },
        "common_patterns": ["tracepath example.com", "tracepath -n 8.8.8.8", "tracepath -b example.com", "tracepath -m 30 example.com"],
        "man_url": "https://man7.org/linux/man-pages/man8/tracepath.8.html",
        "use_cases": [
            "Trace a network path without root privileges when traceroute is not available",
            "Discover the Path MTU to a destination to diagnose packet fragmentation issues",
            "Quick network path diagnosis on servers where you do not have sudo access",
        ],
        "gotchas": [
            "tracepath does not support all the protocol options that traceroute has (no TCP mode, no ICMP mode)",
            "Path MTU discovery may report incorrect values if ICMP 'need fragmentation' messages are blocked by intermediate firewalls",
        ],
        "related": ["traceroute", "mtr", "ping"],
        "difficulty": "beginner",
    },
    "typeset": {
        "description": "Declare variables with specific types and attributes, serving as an older synonym for the declare builtin in bash. Use it to set integer attributes, make variables readonly, create associative arrays, or restrict values to specific types.",
        "flags": {
            "-i": "Give the variable the integer attribute so assignments are evaluated as arithmetic",
            "-r": "Make the variable readonly (cannot be unset or reassigned)",
            "-a": "Declare the variable as an indexed array",
            "-A": "Declare the variable as an associative array",
            "-x": "Export the variable so it is available to child processes",
            "-l": "Convert the variable's value to lowercase on assignment",
            "-u": "Convert the variable's value to uppercase on assignment"
        },
        "common_patterns": ["typeset -i count=0", "typeset -r CONST='value'", "typeset -A mymap", "typeset -x PATH"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "use_cases": [
            "Ksh-compatible integer variable: typeset -i counter=0",
            "Cross-shell scripting where ksh compatibility is needed",
            "Uppercase variable: typeset -u STATUS; STATUS='ok' stores 'OK'",
        ],
        "gotchas": [
            "typeset is considered deprecated in bash since version 4.0 -- use declare instead",
            "typeset exists in bash primarily for ksh compatibility -- new scripts should avoid it",
            "Functionally identical to declare in bash, but declare is the documented and preferred form",
        ],
        "related": ["declare", "local", "readonly"],
        "difficulty": "intermediate",
    },
    "umount": {
        "description": "Detach a mounted filesystem from the directory tree, making the device safely removable. You use umount before physically disconnecting external drives or when you need to perform maintenance like fsck on a partition.",
        "flags": {
            "-a": "Unmount all filesystems listed in /proc/self/mountinfo",
            "-f": "Force unmount even if the filesystem is busy (useful for unreachable NFS mounts)",
            "-l": "Lazy unmount: detach immediately, clean up references when no longer in use",
            "-d": "Free the loop device if the unmounted device was a loop device",
            "-R": "Recursively unmount a target and all its submounts",
            "-v": "Verbose mode, print actions as they happen"
        },
        "common_patterns": ["umount /mnt/usb", "umount -l /mnt/stuck", "umount -a"],
        "man_url": "https://man7.org/linux/man-pages/man8/umount.8.html",
        "use_cases": [
            "Unmount a filesystem: umount /mnt/usb",
            "Force unmount a busy filesystem: umount -f /mnt/stuck",
            "Lazy unmount that detaches when no longer busy: umount -l /mnt/busy",
        ],
        "gotchas": [
            "Cannot unmount if any process has open files on it; use lsof or fuser to find them",
            "Lazy unmount (-l) hides the mount immediately but data may not be flushed yet",
        ],
        "related": ["mount", "lsof", "fuser", "lsblk"],
        "difficulty": "intermediate",
    },
    "unalias": {
        "description": "Remove one or more alias definitions from the current shell session. Use it to undo aliases that override standard command behavior, such as removing a cautious rm alias to run the real rm.",
        "flags": {
            "-a": "Remove all alias definitions at once"
        },
        "common_patterns": ["unalias ll", "unalias -a", "unalias ls"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html",
        "use_cases": [
            "Remove a specific alias: unalias ll",
            "Clear all aliases in the current session: unalias -a",
            "Undo a safety alias to run the real command: unalias rm",
        ],
        "gotchas": [
            "unalias only affects the current shell session -- aliases in .bashrc will return on next login",
            "unalias on a non-existent alias produces an error unless you redirect stderr",
            "To temporarily bypass an alias without removing it, prefix with backslash: \rm file",
        ],
        "related": ["alias", "command", "builtin"],
        "difficulty": "beginner",
    },
    "uncompress": {
        "description": "Decompress files created by the compress utility, restoring .Z files to their original form. You use uncompress to handle legacy compressed files in the older LZW (.Z) format still found on some Unix systems.",
        "flags": {
            "-f": "Force overwrite of existing output files",
            "-c": "Write decompressed data to stdout, leaving the original file intact",
            "-v": "Verbose mode showing compression statistics",
            "-r": "Recursively decompress files in directories"
        },
        "common_patterns": ["uncompress file.Z", "uncompress -c file.Z > file.txt", "uncompress *.Z"],
        "man_url": "https://linux.die.net/man/1/uncompress",
        "use_cases": [
            "Decompress a .Z file: uncompress file.Z",
            "Decompress to stdout for piping: uncompress -c file.Z | grep pattern",
        ],
        "gotchas": [
            "uncompress is equivalent to compress -d -- it decompresses .Z files created by the compress command",
            "If you encounter .Z files, gzip can also decompress them: gunzip file.Z",
        ],
        "related": ["compress", "gunzip"],
        "difficulty": "intermediate",
    },
    "unrar": {
        "description": "Extract files from RAR archives, supporting all RAR format versions including encrypted and multi-volume archives. You use unrar to open .rar files received from others, since RAR is a popular archive format on Windows.",
        "flags": {
            "x": "Extract files with full directory paths preserved",
            "e": "Extract files to current directory without recreating directory structure",
            "l": "List the contents of the archive with sizes and dates",
            "t": "Test archive integrity without extracting",
            "-o+": "Overwrite existing files without prompting",
            "-o-": "Do not overwrite existing files",
            "-p": "Set password for encrypted archives",
            "-y": "Assume yes on all prompts"
        },
        "common_patterns": ["unrar x archive.rar", "unrar l archive.rar", "unrar x archive.rar /destination/", "unrar t archive.rar"],
        "man_url": "https://linux.die.net/man/1/unrar",
        "use_cases": [
            "Extract a RAR archive: unrar x archive.rar",
            "Extract to a specific directory: unrar x archive.rar /tmp/output/",
            "List contents of a RAR archive: unrar l archive.rar",
            "Test archive integrity: unrar t archive.rar",
        ],
        "gotchas": [
            "unrar x preserves directory structure; unrar e extracts all files flat to the current directory",
            "unrar is freeware but not open source (there is also an open-source unrar-free with less format support)",
        ],
        "related": ["rar", "7z", "unzip"],
        "difficulty": "beginner",
    },
    "unset": {
        "description": "Remove shell variables or functions, freeing the associated name so it is no longer defined. Use it to clean up temporary variables in scripts or remove environment variables that should not be inherited by child processes.",
        "flags": {
            "-v": "Treat each name as a variable name (default)",
            "-f": "Treat each name as a function name",
            "-n": "Treat each name as a nameref variable and unset the reference itself"
        },
        "common_patterns": ["unset VARNAME", "unset -f functionname", "unset -v TEMP"],
        "man_url": "https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html",
        "use_cases": [
            "Remove a temporary variable after use: unset temp_file",
            "Clear an environment variable to prevent child processes from inheriting it: unset DATABASE_URL",
            "Remove a function definition: unset -f my_helper",
            "Clean up associative array entries: unset 'mymap[key]'",
        ],
        "gotchas": [
            "unset cannot remove readonly variables -- you get an error and the variable persists for the shell's lifetime",
            "unset on a nameref (-n) variable unsets the reference, not the target -- use unset -n to remove the nameref itself",
            "Without -v or -f, unset tries the name as a variable first, then as a function -- be explicit with the flag",
            "Unsetting positional parameters ($1, $2) is not possible with unset -- use shift instead",
        ],
        "related": ["set", "export", "declare", "readonly"],
        "difficulty": "beginner",
    },
    "unxz": {
        "description": "Decompress files compressed with xz, which provides the highest compression ratio among common Linux tools. You use unxz to extract .xz files such as kernel tarballs and software distribution archives.",
        "flags": {
            "-k": "Keep the original .xz file after decompression",
            "-f": "Force overwrite of existing output files",
            "-c": "Write decompressed data to standard output",
            "-t": "Test the integrity of compressed files without decompressing",
            "-l": "List information about the compressed file (ratio, sizes, checksums)",
            "-v": "Verbose mode showing progress and compression details"
        },
        "common_patterns": ["unxz file.xz", "unxz -k archive.xz", "unxz -v *.xz"],
        "man_url": "https://man7.org/linux/man-pages/man1/xz.1.html",
        "use_cases": [
            "Decompress an .xz file: unxz file.txt.xz",
            "Decompress while keeping the original: unxz -k file.txt.xz",
        ],
        "gotchas": [
            "unxz is equivalent to xz --decompress -- they are the same program",
            "unxz removes the .xz file after decompression by default",
        ],
        "related": ["xz", "xzcat", "gunzip", "bunzip2"],
        "difficulty": "beginner",
    },
    "updatedb": {
        "description": "Scan the filesystem and update the database used by the locate command for fast filename searches. You run updatedb periodically (usually via cron) so that locate results stay current with filesystem changes.",
        "flags": {
            "-v": "Verbose mode, output path names of files as they are found",
            "-U": "Only scan the filesystem subtree rooted at the specified path",
            "-o": "Write the database to the specified file instead of the default location",
            "--prunefs": "Whitespace-separated list of filesystem types to skip",
            "--prunepaths": "Whitespace-separated list of directory paths to skip",
            "--prunenames": "Whitespace-separated list of directory names to skip"
        },
        "common_patterns": ["sudo updatedb", "updatedb -v", "updatedb --prunepaths='/tmp /var/spool'"],
        "man_url": "https://man7.org/linux/man-pages/man8/updatedb.8.html",
        "use_cases": [
            "Refresh the locate database: sudo updatedb",
            "Update with specific paths excluded: updatedb --prunepaths='/tmp /proc'",
            "Schedule via cron for daily index updates",
        ],
        "gotchas": [
            "updatedb can be slow on large filesystems and generates significant I/O",
            "The database is stale between updates -- newly created files won't appear until next updatedb run",
            "By default only indexes paths accessible to the user running updatedb",
        ],
        "related": ["locate", "mlocate", "plocate", "find"],
        "difficulty": "intermediate",
    },
    "useradd": {
        "description": "Create a new user account on the system with specified attributes like home directory, shell, and group membership. Use it when provisioning new users on a Linux system, typically as root or via sudo.",
        "flags": {
            "-m": "Create the user's home directory if it does not exist",
            "-d": "Specify the home directory path for the new user",
            "-s": "Set the login shell for the new user",
            "-g": "Set the primary group for the new user",
            "-G": "Add the user to supplementary groups (comma-separated)",
            "-r": "Create a system account with no aging information and no home directory",
            "-e": "Set the account expiration date (YYYY-MM-DD)",
            "-c": "Set the GECOS comment field (typically the user's full name)"
        },
        "common_patterns": ["useradd -m username", "useradd -m -s /bin/bash -G sudo username", "useradd -r -s /sbin/nologin serviceuser"],
        "man_url": "https://man7.org/linux/man-pages/man8/useradd.8.html",
        "use_cases": [
            "Create a new user with home directory: useradd -m -s /bin/bash newuser",
            "Create a system user for a service: useradd -r -s /usr/sbin/nologin appuser",
            "Create user with specific UID and groups: useradd -u 1500 -G docker,dev newuser",
        ],
        "gotchas": [
            "useradd does not create a home directory by default on many distros -- always use -m explicitly",
            "useradd does not set a password -- run passwd username afterward",
            "Debian/Ubuntu adduser is a friendlier wrapper -- useradd is the low-level tool",
        ],
        "related": ["userdel", "usermod", "passwd", "adduser"],
        "difficulty": "intermediate",
    },
    "userdel": {
        "description": "Delete a user account and optionally remove the user's home directory and mail spool. Use it when deprovisioning a user from the system, making sure to handle their files appropriately.",
        "flags": {
            "-r": "Remove the user's home directory and mail spool along with the account",
            "-f": "Force removal even if the user is still logged in",
            "-Z": "Remove any SELinux user mapping for the user"
        },
        "common_patterns": ["userdel username", "userdel -r username", "sudo userdel -rf username"],
        "man_url": "https://man7.org/linux/man-pages/man8/userdel.8.html",
        "use_cases": [
            "Remove a user account: userdel olduser",
            "Remove user and their home directory: userdel -r olduser",
            "Clean up deactivated accounts during offboarding",
        ],
        "gotchas": [
            "userdel without -r leaves the home directory and mail spool behind -- orphaned files remain",
            "Cannot delete a user who is currently logged in -- use kill or loginctl to terminate sessions first",
            "Files owned by the deleted UID outside /home will show a numeric UID in ls -l",
        ],
        "related": ["useradd", "usermod", "passwd", "find"],
        "difficulty": "intermediate",
    },
    "usermod": {
        "description": "Modify an existing user account's attributes such as group membership, home directory, shell, or login name. Use it to update user configuration without deleting and recreating the account.",
        "flags": {
            "-aG": "Append the user to supplementary groups without removing existing memberships",
            "-d": "Change the user's home directory",
            "-s": "Change the user's login shell",
            "-l": "Change the user's login name",
            "-L": "Lock the user account (disable password login)",
            "-U": "Unlock the user account",
            "-g": "Change the user's primary group",
            "-e": "Set the account expiration date (YYYY-MM-DD)"
        },
        "common_patterns": ["usermod -aG sudo username", "usermod -s /bin/zsh username", "usermod -L username", "usermod -d /new/home username"],
        "man_url": "https://man7.org/linux/man-pages/man8/usermod.8.html",
        "use_cases": [
            "Add user to a group: usermod -aG docker username",
            "Change login shell: usermod -s /bin/zsh username",
            "Lock an account: usermod -L username",
            "Rename a user: usermod -l newname oldname",
        ],
        "gotchas": [
            "usermod -G WITHOUT -a replaces all supplementary groups -- always use -aG to append",
            "Changes to groups do not take effect until the user logs out and back in",
            "Renaming a user (-l) does not rename the home directory -- use -d -m to move it",
        ],
        "related": ["useradd", "userdel", "passwd", "groups"],
        "difficulty": "intermediate",
    },
    "users": {
        "description": "Print the login names of all users currently logged into the system, one per entry on a single line. Use it for a minimal quick check of who is on the system when you do not need the detail of who or w.",
        "flags": {},
        "common_patterns": ["users", "users | wc -w"],
        "man_url": "https://man7.org/linux/man-pages/man1/users.1.html",
        "use_cases": [
            "List currently logged-in usernames: users",
            "Quick check if anyone is logged in: users | wc -w",
            "Simple alternative to who when you only need usernames",
        ],
        "gotchas": [
            "users reads /var/run/utmp which may not include all sessions (e.g., tmux/screen sub-sessions)",
            "Duplicate names appear if a user has multiple sessions",
        ],
        "related": ["who", "w", "last", "id"],
        "difficulty": "beginner",
    },
    "uv": {
        "description": "An extremely fast Python package and project manager written in Rust by Astral. It serves as a drop-in replacement for pip, pip-tools, and virtualenv with dramatically faster resolution and installation speeds.",
        "flags": {
            "init": "Create a new Python project with a pyproject.toml file",
            "add": "Add a dependency to the project",
            "remove": "Remove a dependency from the project",
            "sync": "Synchronize the environment with the lockfile",
            "run": "Run a command in the project environment",
            "pip install": "Install packages using the pip-compatible interface",
            "venv": "Create a virtual environment for the project",
            "--python": "Specify which Python version to use",
        
            "pip compile": "Compile requirements.in to requirements.txt",
            "pip sync": "Sync environment to match requirements exactly",
            "lock": "Generate a lockfile for the project",
            "python": "Manage Python installations",
            "tool": "Install and run Python CLI tools (like pipx)",
        },
        "common_patterns": ["uv init project_name", "uv add package_name", "uv run python script.py", "uv sync"],
        "man_url": "https://docs.astral.sh/uv/",
        "use_cases": [
            "Create a virtual environment and install packages extremely fast: uv venv && uv pip install flask",
            "Install packages from requirements.txt: uv pip install -r requirements.txt",
            "Create a new Python project: uv init my-project",
            "Run a Python script with automatic dependency resolution: uv run script.py",
            "Install and manage Python versions: uv python install 3.12",
        ],
        "gotchas": [
            "uv is written in Rust and is 10-100x faster than pip, but it is a newer tool and may have edge cases with complex dependency trees",
            "uv pip compile generates locked requirements from pyproject.toml, similar to pip-tools -- but the output format may differ slightly",
            "uv automatically downloads Python versions if needed, which is convenient but may be unexpected in air-gapped environments",
        ],
        "related": ["pip", "poetry", "pipx", "conda"],
        "difficulty": "beginner",
    },
    "vagrant": {
        "description": "A tool for building and managing portable, reproducible virtual machine environments using simple configuration files. You'd use it to create consistent development environments that match production, eliminating works-on-my-machine issues across teams.",
        "flags": {
            "--provider": "Specify the virtualization provider (virtualbox, vmware, libvirt)",
            "-f": "Force the operation without prompting for confirmation",
            "--provision": "Force provisioners to run on an already running machine",
            "--provision-with": "Run only the named provisioners",
            "--parallel": "Bring up multiple machines in parallel",
            "--no-destroy-on-error": "Do not destroy the VM if a fatal error occurs"
        },
        "common_patterns": ["vagrant up", "vagrant ssh", "vagrant halt", "vagrant destroy -f"],
        "man_url": "https://developer.hashicorp.com/vagrant/docs",
        "use_cases": [
            "Create a reproducible development VM with vagrant init ubuntu/jammy64 && vagrant up",
            "SSH into the development VM with vagrant ssh",
            "Re-run provisioning scripts with vagrant provision after updating your Vagrantfile",
        ],
        "gotchas": [
            "Vagrant requires a hypervisor (VirtualBox, VMware, or libvirt) -- install one before using Vagrant",
            "vagrant destroy permanently deletes the VM and all its data -- use vagrant halt for a temporary stop",
            "Synced folders use VirtualBox shared folders by default which can be slow -- use NFS or rsync for better performance",
        ],
        "related": ["docker", "terraform", "ansible"],
        "difficulty": "intermediate",
    },
    "valgrind": {
        "description": "A dynamic analysis framework that detects memory leaks, buffer overflows, and threading errors in compiled programs. You'd use it to find memory management bugs in C/C++ applications that would otherwise cause crashes or data corruption.",
        "flags": {
            "--tool": "Select the analysis tool to use (memcheck, cachegrind, callgrind)",
            "--leak-check": "Enable detailed memory leak reporting (yes, full, summary)",
            "--track-origins": "Track the origin of uninitialized values for better diagnostics",
            "--show-reachable": "Report all types of memory leaks including reachable blocks",
            "--log-file": "Write output to the specified file instead of stderr",
            "--num-callers": "Set the depth of stack traces in error reports",
            "--suppressions": "Load a file of known false-positive suppressions",
            "--track-fds": "Track and report open file descriptors at exit",
            "-v": "Verbose mode with more details about each error",
            "--gen-suppressions": "Generate suppression entries for each error (all or yes)",
            "--vgdb": "Enable gdb to connect to valgrind for interactive debugging",
        },
        "common_patterns": ["valgrind ./program", "valgrind --leak-check=full --track-origins=yes ./app", "valgrind --tool=callgrind ./program", "valgrind --log-file=valgrind.log ./app"],
        "man_url": "https://valgrind.org/docs/manual/manual.html",
        "use_cases": [
            "Check for memory leaks with valgrind --leak-check=full --track-origins=yes ./program",
            "Profile cache usage with valgrind --tool=cachegrind ./program",
            "Generate a call graph for profiling with valgrind --tool=callgrind ./program then view with kcachegrind",
        ],
        "gotchas": [
            "Programs run 10-30x slower under valgrind -- reduce input sizes for testing or it may take hours",
            "Compile with -g -O0 for accurate line numbers -- optimized code (-O2+) causes valgrind to report false positives for uninitialized values",
            "Valgrind doubles memory usage (1.25x allocation + ~120 bytes overhead per malloc) -- you may need to reduce parallel workers or input sizes",
            "Valgrind only works on Linux and macOS x86_64 -- it does not support ARM64 on macOS (Apple Silicon) natively",
            "Use --suppressions to ignore known false positives from system libraries",
        ],
        "related": ["gdb", "gcc", "clang"],
        "difficulty": "intermediate",
    },
    "vi": {
        "description": "The classic Unix visual text editor that operates in command and insert modes for efficient keyboard-driven editing. You'd use it to edit files on virtually any Unix or Linux system, as it is almost universally installed.",
        "flags": {
            "-R": "Open the file in read-only mode",
            "-r": "Recover a file after an editor or system crash",
            "-c": "Execute an ex command after loading the first file",
            "+": "Start editing at the end of the file or at a specific line number",
            "-b": "Open in binary mode for editing non-text files",
            "-l": "Enter lisp mode for editing Lisp source code"
        },
        "common_patterns": ["vi filename.txt", "vi +100 file.c", "vi -R /etc/config", "vi -r recovered_file.txt"],
        "man_url": "https://man7.org/linux/man-pages/man1/vi.1p.html",
        "use_cases": [
            "Edit a file on any Unix system where vim may not be installed with vi filename.txt",
            "Use as a fallback editor during system recovery when only base utilities are available",
        ],
        "gotchas": [
            "On most modern systems vi is a symlink to vim or vim in compatible mode -- behavior may differ slightly from POSIX vi",
            "vi has fewer features than vim -- no syntax highlighting, no multiple undo levels, and limited plugin support",
            "vi is always available because POSIX requires it -- it is the editor of last resort for emergency system repairs",
        ],
        "related": ["vim", "nvim", "nano", "ed"],
        "difficulty": "intermediate",
    },
    "vigr": {
        "description": "Safely edit the /etc/group file by locking it against simultaneous edits and validating syntax upon save. Use it instead of directly editing group files to prevent corruption from concurrent access.",
        "flags": {
            "-s": "Edit the shadow group file /etc/gshadow instead of /etc/group"
        },
        "common_patterns": ["vigr", "vigr -s", "sudo vigr"],
        "man_url": "https://man7.org/linux/man-pages/man8/vigr.8.html",
        "use_cases": [
            "Safely edit /etc/group with locking: vigr",
            "Edit /etc/gshadow: vigr -s",
            "Prevent concurrent edits to group files by multiple admins",
        ],
        "gotchas": [
            "Must be run as root",
            "Uses the $EDITOR or $VISUAL environment variable -- set these to your preferred editor",
            "Always run grpck after manual edits to verify file integrity",
        ],
        "related": ["vipw", "grpck", "groupmod", "groupadd"],
        "difficulty": "advanced",
    },
    "vipw": {
        "description": "Safely edit the /etc/passwd file by locking it against concurrent edits and validating syntax on save. Use it instead of directly editing password files to prevent data corruption and ensure consistency.",
        "flags": {
            "-s": "Edit the shadow password file /etc/shadow instead of /etc/passwd"
        },
        "common_patterns": ["vipw", "vipw -s", "sudo vipw"],
        "man_url": "https://man7.org/linux/man-pages/man8/vipw.8.html",
        "use_cases": [
            "Safely edit /etc/passwd with locking: vipw",
            "Edit /etc/shadow: vipw -s",
            "Prevent corruption from concurrent edits to password files",
        ],
        "gotchas": [
            "Must be run as root",
            "Always run pwck after manual edits to verify file integrity",
            "Syntax errors in /etc/passwd can lock all users out -- be very careful",
        ],
        "related": ["vigr", "pwck", "passwd", "usermod"],
        "difficulty": "advanced",
    },
    "w": {
        "description": "Show who is logged in and what they are doing, combining output similar to who, uptime, and per-user process information. Use it for a quick overview of system load and active user sessions.",
        "flags": {
            "-h": "Suppress the header line",
            "-s": "Use short format, omitting login time, JCPU, and PCPU columns",
            "-f": "Toggle the display of the FROM (remote host) field",
            "-i": "Display IP addresses instead of hostnames"
        },
        "common_patterns": ["w", "w -h", "w username", "w -s"],
        "man_url": "https://man7.org/linux/man-pages/man1/w.1.html",
        "use_cases": [
            "See who is logged in and what they are doing: w",
            "Check system load and uptime at a glance",
            "Monitor idle times to find inactive sessions",
        ],
        "gotchas": [
            "The WHAT column shows the current foreground process, which may not represent what the user is actually doing",
            "IDLE time resets on any terminal activity including background output",
        ],
        "related": ["who", "uptime", "last", "users"],
        "difficulty": "beginner",
    },
    "wait": {
        "description": "Pause the current shell until background processes or specified jobs complete and return their exit statuses. Use it in scripts to synchronize parallel tasks, ensuring all background jobs finish before proceeding to dependent steps.",
        "flags": {
            "-n": "Wait for any single background job to finish and return its exit status",
            "-f": "Wait for the process to actually terminate, not just change state",
            "-p": "Store the PID of the job that was waited for into a variable"
        },
        "common_patterns": ["command1 & command2 & wait", "wait $PID", "wait %1", "wait -n"],
        "man_url": "https://www.gnu.org/software/bash/manual/bash.html#index-wait",
        "use_cases": [
            "Wait for all background jobs to finish: wait",
            "Wait for a specific PID: wait $pid",
            "Capture exit status of a background process: wait $pid; echo $?",
        ],
        "gotchas": [
            "wait only works for children of the current shell -- it cannot wait for arbitrary PIDs from other processes",
            "In pipelines, $! gives the PID of the last command only -- store PIDs explicitly for multiple background jobs",
            "wait returns immediately with an error for PIDs that are not children of the current shell",
        ],
        "related": ["jobs", "bg", "fg", "kill"],
        "difficulty": "intermediate",
    },
    "whatis": {
        "description": "Display a one-line summary description of a command from the manual page database. Use it to quickly find out what a command does without reading its full man page.",
        "flags": {
            "-s": "Limit the search to the specified manual section(s)",
            "-r": "Interpret the name as a regular expression",
            "-w": "Interpret the name as a wildcard pattern",
            "-l": "Do not trim output to terminal width"
        },
        "common_patterns": ["whatis ls", "whatis -s 1 printf", "whatis -w 'git*'"],
        "man_url": "https://man7.org/linux/man-pages/man1/whatis.1.html",
        "use_cases": [
            "Quickly check what a command does with whatis tar before reading the full man page",
            "Get one-line descriptions of multiple commands at once with whatis ls cp mv rm",
            "Verify which man page section a command belongs to with whatis printf to see both the shell builtin and C library versions",
        ],
        "gotchas": [
            "whatis requires the man database to be built -- if it returns nothing, run sudo mandb",
            "whatis only shows exact name matches by default -- use apropos (man -k) for keyword searches across descriptions",
        ],
        "related": ["apropos", "man", "help", "info"],
        "difficulty": "beginner",
    },
    "who": {
        "description": "Display information about users who are currently logged into the system. Use it to see login names, terminal lines, login times, and remote hostnames for active sessions.",
        "flags": {
            "-a": "Show all available information (equivalent to -b -d --login -p -r -t -T -u)",
            "-b": "Show the time of last system boot",
            "-H": "Print column headings",
            "-q": "Show only login names and count of logged-in users",
            "-u": "Show idle time for each user",
            "-m": "Show only the hostname and user associated with stdin"
        },
        "common_patterns": ["who", "who -a", "who -Hu", "who am i"],
        "man_url": "https://man7.org/linux/man-pages/man1/who.1.html",
        "use_cases": [
            "List logged-in users with terminal info: who",
            "Show current user and terminal: who am i",
            "Check system boot time: who -b",
        ],
        "gotchas": [
            "who reads utmp, which may not include pseudo-terminals from screen/tmux on all systems",
            "who am i may show nothing if not connected via a real login session (e.g., in a script)",
        ],
        "related": ["w", "users", "last", "id"],
        "difficulty": "beginner",
    },
    "whois": {
        "description": "Query WHOIS databases to look up registration and ownership information for domain names and IP addresses. Use it to find out who owns a domain, when it was registered, when it expires, and what nameservers it uses.",
        "flags": {
            "-h": "Specify the WHOIS server to query",
            "-p": "Specify the port to connect to on the WHOIS server",
            "-H": "Suppress the legal disclaimers in the output"
        },
        "common_patterns": ["whois example.com", "whois 8.8.8.8", "whois -h whois.ripe.net 192.0.2.1", "whois example.org"],
        "man_url": "https://man7.org/linux/man-pages/man1/whois.1.html",
        "use_cases": [
            "Find out who owns a domain: whois example.com",
            "Check domain expiration date before it lapses",
            "Look up the organization responsible for an IP address: whois 8.8.8.8",
            "Determine the registrar and nameservers for a domain",
        ],
        "gotchas": [
            "Many domain registrars now use privacy protection services that hide the real owner information",
            "WHOIS rate limiting may block you if you run too many queries in succession",
            "The output format varies significantly between different TLD registries",
        ],
        "related": ["dig", "nslookup", "host"],
        "difficulty": "beginner",
    },
    "wireshark": {
        "description": "A graphical network protocol analyzer that captures and interactively inspects network traffic at the packet level with deep protocol dissection. Use it when you need visual inspection of network conversations, protocol debugging, or detailed packet-by-packet analysis that tcpdump's text output makes difficult.",
        "flags": {
            "-i": "Specify the network interface to capture on",
            "-k": "Start capturing immediately after launch",
            "-f": "Set a capture filter using BPF syntax",
            "-Y": "Set a display filter to show only matching packets",
            "-r": "Read packets from a previously saved capture file",
            "-w": "Write captured packets to a file",
            "-T": "Set output format for tshark (fields, json, pdml)",
        },
        "common_patterns": ["sudo wireshark", "wireshark -i eth0 -k", "wireshark -r capture.pcap", "wireshark -i any -f 'port 80' -k"],
        "man_url": "https://www.wireshark.org/docs/man-pages/wireshark.html",
        "use_cases": [
            "Analyze a pcap file captured with tcpdump to visually inspect protocol conversations",
            "Debug TLS handshake failures by examining the Certificate and ServerHello messages",
            "Filter and follow a specific TCP stream to reconstruct an HTTP conversation",
            "Identify network performance issues using the IO graphs and expert information features",
        ],
        "gotchas": [
            "Wireshark's GUI requires a display server (X11/Wayland); use tshark for CLI-based analysis on headless servers",
            "Capturing on a busy network generates massive pcap files quickly -- use capture filters (BPF) to reduce volume",
            "Display filters (applied after capture) use different syntax from capture filters (BPF syntax applied during capture)",
        ],
        "related": ["tcpdump", "nmap", "ss"],
        "difficulty": "advanced",
    },
    "xmllint": {
        "description": "A command-line XML parser and validator that checks well-formedness, validates against schemas, and reformats XML documents. You'd use it to validate XML files, extract data with XPath, or pretty-print XML for readability.",
        "flags": {
            "--valid": "Validate the document against its DTD",
            "--schema": "Validate against a W3C XML Schema file",
            "--relaxng": "Validate against a RelaxNG schema file",
            "--noout": "Suppress output of the parsed document",
            "--format": "Reformat and indent the XML output for readability",
            "--xpath": "Evaluate an XPath expression and print matching nodes",
            "--html": "Parse the input as HTML instead of XML",
            "--noent": "Substitute entity values for entity references",
            "--c14n": "Canonicalize XML output for consistent comparison",
            "--dtdvalid": "Validate against an external DTD file",
            "--recover": "Try to recover from malformed XML",
        },
        "common_patterns": ["xmllint --noout --schema schema.xsd file.xml", "xmllint --format input.xml > formatted.xml", "xmllint --xpath '//element/@attr' file.xml", "xmllint --valid --noout document.xml"],
        "man_url": "http://xmlsoft.org/xmllint.html",
        "use_cases": [
            "Validate an XML file against its schema with xmllint --noout --schema schema.xsd file.xml",
            "Pretty-print an XML file with xmllint --format messy.xml > formatted.xml",
            "Extract data with XPath with xmllint --xpath '//item/@name' data.xml",
        ],
        "gotchas": [
            "xmllint requires libxml2 to be installed -- it is usually available as part of the libxml2-utils package",
            "--xpath with namespaces requires explicit namespace declarations which can be very verbose",
            "xmllint --format adds a newline at the end of the file -- this may matter for exact binary comparison of XML files",
        ],
        "related": ["xsltproc", "jq", "yq"],
        "difficulty": "intermediate",
    },
    "xsltproc": {
        "description": "A command-line XSLT processor that transforms XML documents using XSLT stylesheets into HTML, text, or other XML formats. You'd use it to convert XML data into presentation formats like HTML or to restructure XML documents for different consumers.",
        "flags": {
            "-o": "Write the transformation output to the specified file",
            "--html": "Parse the input document as HTML instead of XML",
            "--noout": "Suppress the output of the transformation result",
            "--nonet": "Do not fetch DTDs or entities from the network",
            "--novalid": "Skip loading and validating the document DTD",
            "--timing": "Display timing information for each processing phase",
            "--xinclude": "Process XInclude directives in the input document",
            "--param": "Pass a named parameter value to the stylesheet"
        },
        "common_patterns": ["xsltproc style.xsl data.xml", "xsltproc -o output.html transform.xsl input.xml", "xsltproc --param name \"'value'\" style.xsl data.xml", "xsltproc --nonet --novalid style.xsl input.xml"],
        "man_url": "http://xmlsoft.org/xsltproc.html",
        "use_cases": [
            "Transform XML to HTML with xsltproc style.xsl data.xml > output.html",
            "Generate documentation from XML sources with xsltproc -o doc.html docbook.xsl manual.xml",
            "Pass parameters to stylesheets with xsltproc --param version \"'2.0'\" transform.xsl input.xml",
        ],
        "gotchas": [
            "String parameters passed with --param must be wrapped in extra quotes: --param name \"'value'\" (outer quotes for shell, inner for XPath)",
            "xsltproc only supports XSLT 1.0 -- for XSLT 2.0 or 3.0 you need Saxon or another processor",
            "Network access for DTDs and external entities can be slow or fail -- use --nonet to disable",
        ],
        "related": ["xmllint", "jq", "sed"],
        "difficulty": "advanced",
    },
    "xzcat": {
        "description": "Display the contents of xz-compressed files on standard output without permanently decompressing them. You use xzcat to inspect or pipe xz archives into other commands while keeping disk usage minimal.",
        "flags": {
            "-f": "Force output even if the file does not have an .xz suffix",
            "-k": "Keep the input files (default behavior for xzcat)",
            "-q": "Suppress warnings and decrease verbosity",
            "-v": "Verbose mode showing compression details"
        },
        "common_patterns": ["xzcat file.xz", "xzcat data.xz | grep 'pattern'", "xzcat archive.xz | tar xf -"],
        "man_url": "https://man7.org/linux/man-pages/man1/xz.1.html",
        "use_cases": [
            "View an xz-compressed file without decompressing: xzcat file.xz",
            "Pipe compressed data to grep: xzcat data.xz | grep pattern",
            "Extract a tar archive compressed with xz: xzcat archive.tar.xz | tar xf -",
        ],
        "gotchas": [
            "xzcat is equivalent to xz --decompress --stdout -- it does not modify the original file",
        ],
        "related": ["xz", "unxz", "zcat", "bzcat"],
        "difficulty": "beginner",
    },
    "yarn": {
        "description": "A fast and reliable JavaScript package manager that caches every downloaded package for offline use. It uses a lockfile to ensure deterministic installs across all machines.",
        "flags": {
            "add": "Add a new dependency to the project",
            "remove": "Remove a dependency from the project",
            "install": "Install all dependencies from package.json and yarn.lock",
            "--dev": "Add a package as a development dependency",
            "--global": "Install a package globally for system-wide use",
            "--frozen-lockfile": "Abort if the lockfile needs to be updated during install",
            "--production": "Install only production dependencies, skipping devDependencies",
            "--verbose": "Print detailed information during command execution",
            "why": "Show why a package is installed (dependency chain)",
            "workspace": "Run a command in a specific workspace",
            "dlx": "Download and execute a package (like npx) in Yarn Berry",
            "dedupe": "Deduplicate dependencies in the lockfile",
            "info": "Show information about a package",
        },
        "common_patterns": ["yarn install", "yarn add package_name", "yarn remove package_name", "yarn upgrade"],
        "man_url": "https://yarnpkg.com/getting-started",
        "use_cases": [
            "Install all project dependencies: yarn install",
            "Add a new package to the project: yarn add express",
            "Add a development dependency: yarn add --dev typescript",
            "Run a script defined in package.json: yarn run build",
            "Upgrade all dependencies to latest: yarn upgrade-interactive",
        ],
        "gotchas": [
            "Yarn Classic (v1) and Yarn Berry (v2+) have significantly different behaviors -- Berry uses Plug'n'Play by default which eliminates node_modules and may break tools expecting it",
            "yarn install --frozen-lockfile should be used in CI to fail fast if the lockfile is out of date rather than silently updating it",
            "Mixing yarn and npm in the same project creates conflicting lockfiles (yarn.lock vs package-lock.json) -- pick one and stick with it",
            "Yarn workspaces require proper configuration in package.json; forgetting to declare a workspace means its dependencies are not hoisted",
        ],
        "related": ["npm", "pnpm", "bun", "npx"],
        "difficulty": "beginner",
    },
    "yay": {
        "description": "An AUR helper for Arch Linux written in Go that wraps pacman to add AUR support. It provides a familiar pacman-like interface for searching, installing, and managing AUR packages.",
        "flags": {
            "-S": "Synchronize and install a package from repos or AUR",
            "-Syu": "Perform a full system upgrade including AUR packages",
            "-Sua": "Upgrade only AUR packages without touching repo packages",
            "-R": "Remove an installed package from the system",
            "-Ss": "Search for a package in repos and AUR by name or description",
            "-Sc": "Clean old and uninstalled packages from the cache",
            "-c": "Remove unneeded dependencies",
            "--gendb": "Generate a development package database for devel updates",
            "--devel": "Check development packages for updates using git",
            "--cleanafter": "Remove build files after installation",
            "--editmenu": "Show a menu to edit PKGBUILDs before building",
        },
        "common_patterns": ["yay -S package_name", "yay -Syu", "yay search_term", "yay -R package_name"],
        "man_url": "https://github.com/Jguer/yay",
        "use_cases": [
            "Install a package from AUR or official repos: yay -S package-name",
            "Full system upgrade including AUR packages: yay -Syu",
            "Search for packages across repos and AUR: yay search-term",
            "Upgrade only AUR packages: yay -Sua",
            "Remove a package: yay -R package-name",
        ],
        "gotchas": [
            "AUR packages are user-submitted and not officially reviewed -- always inspect the PKGBUILD before installing to avoid malicious code",
            "yay builds AUR packages from source, which can take significant time and disk space for large projects",
            "Running yay without arguments triggers a full -Syu upgrade, which may not be intended",
        ],
        "related": ["pacman", "paru", "makepkg"],
        "difficulty": "intermediate",
    },
    "yq": {
        "description": "A portable command-line processor for YAML, JSON, XML, CSV, and TOML files using jq-like expression syntax. You'd use it to query, filter, and transform structured data files from shell scripts and CI/CD pipelines.",
        "flags": {
            "-i": "Update the file in-place instead of printing to stdout",
            "-o": "Set the output format (yaml, json, xml, csv, tsv, props)",
            "-p": "Set the input format for parsing (yaml, json, xml, csv, toml)",
            "-P": "Pretty-print output with idiomatic formatting",
            "-C": "Force colorized output for terminal display",
            "-M": "Force monochrome output without colors",
            "-n": "Do not read input, evaluate the expression from scratch",
            "-N": "Do not print document separator markers",
            "-e": "Set exit status based on whether results exist",
            "eval-all": "Evaluate across all YAML documents in the input",
            "--front-matter": "Process YAML front matter in markdown files",
        },
        "common_patterns": ["yq '.key' file.yaml", "yq -i '.version = \"2.0\"' config.yaml", "yq -o json file.yaml", "yq eval-all 'select(.kind == \"Deployment\")' k8s.yaml"],
        "man_url": "https://mikefarah.gitbook.io/yq/",
        "use_cases": [
            "Extract a value from a YAML file with yq '.metadata.name' deployment.yaml",
            "Update a value in-place with yq -i '.image.tag = \"v2.0\"' values.yaml",
            "Convert YAML to JSON with yq -o json config.yaml for tools that only accept JSON",
            "Merge multiple YAML files with yq eval-all '. as $item ireduce ({}; . * $item)' a.yaml b.yaml",
        ],
        "gotchas": [
            "There are two different tools called yq -- the Go version (mikefarah/yq) and the Python version (kislyuk/yq) with different syntax. Check which you have with yq --version",
            "yq -i modifies files in-place with no backup -- pipe to a new file or use version control before editing",
            "YAML anchors and aliases may not round-trip perfectly through yq -- test with complex YAML before automating",
            "yq uses jq-like syntax but is not fully jq-compatible -- some jq filters work differently or are unsupported",
        ],
        "related": ["jq", "xmllint", "sed"],
        "difficulty": "intermediate",
    },
    "yum": {
        "description": "The legacy package manager for RHEL, CentOS, and older Fedora systems that manages RPM packages from repositories. It resolves dependencies automatically and has been replaced by dnf on newer systems.",
        "flags": {
            "install": "Install one or more packages and their dependencies",
            "remove": "Remove a package from the system",
            "update": "Update all packages or a specific package to the latest version",
            "search": "Search package names and descriptions for a keyword",
            "list": "List available, installed, or updatable packages",
            "-y": "Automatically answer yes to all prompts during operations",
            "--enablerepo": "Temporarily enable a disabled repository for one transaction",
            "--exclude": "Exclude specific packages from the transaction by name or glob",
            "info": "Show detailed information about a package",
            "provides": "Find which package provides a given file or capability",
            "groupinstall": "Install a group of related packages",
            "clean all": "Remove all cached package data",
            "history": "View or undo past transactions",
        },
        "common_patterns": ["yum install package_name", "yum update", "yum search keyword", "yum remove package_name"],
        "man_url": "https://man7.org/linux/man-pages/man8/yum.8.html",
        "use_cases": [
            "Install a package with automatic dependency resolution: yum install httpd",
            "Update all packages on the system: yum update -y",
            "Search for a package by keyword: yum search web server",
            "List available updates: yum check-update",
            "View transaction history to audit changes: yum history",
        ],
        "gotchas": [
            "yum is replaced by dnf on Fedora 22+ and RHEL 8+ -- on newer systems 'yum' is often just a symlink to dnf",
            "yum localinstall is deprecated; use yum install ./package.rpm instead to install local RPM files",
            "yum update will update the kernel too -- use yum update --exclude=kernel* to skip kernel updates if needed",
        ],
        "related": ["dnf", "rpm", "zypper"],
        "difficulty": "beginner",
    },
    "zcat": {
        "description": "Display the contents of gzip-compressed files on standard output without permanently decompressing them. You use zcat to read compressed log files or data files without creating uncompressed copies on disk.",
        "flags": {
            "-f": "Force display even if the file is not in gzip format",
            "-l": "List compression statistics (compressed size, ratio, original name)",
            "-q": "Suppress all warnings",
            "-v": "Display the name of each file as it is processed"
        },
        "common_patterns": ["zcat file.gz", "zcat access.log.gz | grep 'error'", "zcat *.gz | wc -l"],
        "man_url": "https://www.gnu.org/software/gzip/manual/gzip.html",
        "use_cases": [
            "View compressed log file without decompressing: zcat access.log.gz",
            "Pipe compressed data to grep: zcat file.gz | grep pattern",
            "Count lines in a compressed file: zcat file.gz | wc -l",
        ],
        "gotchas": [
            "zcat is equivalent to gzip -dc (decompress to stdout) -- it does not modify the original .gz file",
            "On some systems (macOS), zcat expects a .Z suffix; use gzcat or gzip -dc for .gz files instead",
        ],
        "related": ["gzip", "gunzip", "bzcat", "xzcat"],
        "difficulty": "beginner",
    },
    "zypper": {
        "description": "The command-line package manager for openSUSE and SLES that manages RPM packages and repositories. It provides powerful dependency resolution, pattern-based installation, and patch management for enterprise Linux systems.",
        "flags": {
            "install": "Install one or more packages and resolve dependencies",
            "remove": "Remove a package from the system",
            "update": "Update installed packages to newer available versions",
            "search": "Search for packages by name or description",
            "refresh": "Refresh all enabled repositories and their metadata",
            "--non-interactive": "Run without prompting for user confirmation",
            "--dry-run": "Simulate the operation without making any changes",
            "dist-upgrade": "Perform a full distribution upgrade to the latest release",
            "lr": "List all configured repositories",
            "ar": "Add a new repository",
            "rr": "Remove a repository",
            "patch": "Install available patches",
            "se": "Shorthand for search",
            "in": "Shorthand for install",
        },
        "common_patterns": ["zypper install package_name", "zypper refresh", "zypper update", "zypper search pattern"],
        "man_url": "https://en.opensuse.org/SDB:Zypper_manual",
        "use_cases": [
            "Install a package on openSUSE: zypper install nginx",
            "Refresh all repositories: zypper refresh",
            "Update all installed packages: zypper update",
            "Search for packages by pattern: zypper search pattern",
            "Perform a full distribution upgrade: zypper dist-upgrade",
        ],
        "gotchas": [
            "zypper dist-upgrade (dup) can change vendors and remove packages -- always review the proposed changes and use --dry-run first",
            "zypper locks can prevent packages from being updated -- use zypper locks list to see if any are blocking upgrades",
            "Unlike apt, zypper refresh must be run manually to update repository metadata before searching or installing",
        ],
        "related": ["rpm", "dnf", "yum"],
        "difficulty": "intermediate",
    },
}


# =============================================================================
# OPERATORS DATABASE
# =============================================================================

OPERATORS: Dict[str, Dict[str, str]] = {
    "|": {
        "name": "Pipe",
        "description": "Send stdout of left command to stdin of right command",
        "example": "ls -la | grep '.txt'",
        "use_case": "Chain commands together, filtering or transforming output",
    },
    ">": {
        "name": "Redirect stdout (overwrite)",
        "description": "Redirect stdout to file, overwriting existing content",
        "example": "echo 'hello' > file.txt",
        "use_case": "Save command output to file, replacing previous content",
    },
    ">>": {
        "name": "Redirect stdout (append)",
        "description": "Redirect stdout to file, appending to existing content",
        "example": "echo 'new line' >> file.txt",
        "use_case": "Add command output to end of file without losing existing data",
    },
    "2>": {
        "name": "Redirect stderr",
        "description": "Redirect stderr to file",
        "example": "command 2> errors.log",
        "use_case": "Capture error messages separately from normal output",
    },
    "2>&1": {
        "name": "Redirect stderr to stdout",
        "description": "Send stderr to the same destination as stdout",
        "example": "command > output.log 2>&1",
        "use_case": "Capture both normal output and errors in same file/stream",
    },
    "&>": {
        "name": "Redirect both stdout and stderr",
        "description": "Redirect both stdout and stderr to file (bash shorthand)",
        "example": "command &> all_output.log",
        "use_case": "Capture all output in one file (bash 4+ only)",
    },
    "&&": {
        "name": "AND operator",
        "description": "Execute right command only if left command succeeds (exit code 0)",
        "example": "mkdir dir && cd dir",
        "use_case": "Chain dependent commands; second runs only if first succeeds",
    },
    "||": {
        "name": "OR operator",
        "description": "Execute right command only if left command fails (non-zero exit)",
        "example": "git pull || echo 'Pull failed'",
        "use_case": "Provide fallback action when command fails",
    },
    ";": {
        "name": "Command separator",
        "description": "Execute commands sequentially regardless of exit status",
        "example": "cd /tmp; ls; cd -",
        "use_case": "Run multiple commands in sequence, ignoring failures",
    },
    "&": {
        "name": "Background operator",
        "description": "Run command in background, returning control to shell",
        "example": "long_running_command &",
        "use_case": "Start process without waiting for it to complete",
    },
    "$()": {
        "name": "Command substitution",
        "description": "Execute command and substitute its output in place",
        "example": "echo \"Today is $(date)\"",
        "use_case": "Use command output as argument or in string",
    },
    "``": {
        "name": "Command substitution (legacy)",
        "description": "Legacy syntax for command substitution (prefer $())",
        "example": "echo \"Today is `date`\"",
        "use_case": "Same as $() but less readable; avoid in new scripts",
    },
    "<": {
        "name": "Input redirect",
        "description": "Use file as stdin for command",
        "example": "sort < unsorted.txt",
        "use_case": "Feed file content as input to command",
    },
    "<<": {
        "name": "Here document",
        "description": "Multi-line input until delimiter is encountered",
        "example": "cat << EOF\\nline 1\\nline 2\\nEOF",
        "use_case": "Embed multi-line text or create config files in scripts",
    },
    "<<<": {
        "name": "Here string",
        "description": "Pass string as stdin to command",
        "example": "grep 'pattern' <<< 'search in this text'",
        "use_case": "Pass string to command expecting stdin without echo pipe",
    },
    "|&": {
        "name": "Pipe stdout and stderr",
        "description": "Pipe both stdout and stderr to next command",
        "example": "command |& tee output.log",
        "use_case": "Process both output streams together",
    },
}


# =============================================================================
# BASH CONCEPTS
# =============================================================================

CONCEPTS: Dict[str, Dict[str, Any]] = {
    "pipes": {
        "title": "Pipes and Pipelines",
        "description": "Pipes connect the output of one command to the input of another, allowing you to chain commands together into powerful data processing pipelines.",
        "key_points": [
            "Pipes connect stdout to stdin",
            "Data flows left to right through the pipeline",
            "Each command in the pipeline runs in its own process",
            "Exit status is typically that of the last command",
        ],
        "examples": [
            {"code": "cat file.txt | grep 'pattern' | sort | uniq -c", "explanation": "Read file, filter lines, sort, count unique"},
            {"code": "ps aux | grep python | awk '{print $2}'", "explanation": "List processes, filter for python, extract PID"},
        ],
    },
    "redirects": {
        "title": "I/O Redirection",
        "description": "Redirection allows you to control where command input comes from and where output goes.",
        "key_points": [
            "File descriptors: 0=stdin, 1=stdout, 2=stderr",
            "> overwrites file, >> appends to file",
            "< reads from file as stdin",
            "2>&1 redirects stderr to stdout destination",
        ],
        "examples": [
            {"code": "command > output.txt 2>&1", "explanation": "Send both stdout and stderr to output.txt"},
            {"code": "command 2>/dev/null", "explanation": "Discard error messages"},
        ],
    },
    "exit_codes": {
        "title": "Exit Codes and Status",
        "description": "Every command returns an exit status (0-255). By convention, 0 means success and non-zero indicates failure.",
        "key_points": [
            "Exit 0 = success, non-zero = failure",
            "$? contains the exit status of the last command",
            "&& executes next command only if previous succeeded",
            "|| executes next command only if previous failed",
        ],
        "common_codes": {
            0: "Success",
            1: "General error",
            2: "Misuse of shell builtin",
            126: "Command invoked cannot execute",
            127: "Command not found",
            130: "Terminated by Ctrl+C (128+2)",
        },
    },
    "globbing": {
        "title": "Glob Patterns (Wildcards)",
        "description": "Glob patterns allow matching multiple files using wildcards. The shell expands globs before passing arguments to commands.",
        "key_points": [
            "* matches any characters (except leading dot)",
            "? matches exactly one character",
            "[abc] matches any character in brackets",
            "[a-z] matches any character in range",
            "** matches directories recursively (with globstar)",
        ],
        "examples": [
            {"code": "ls *.txt", "explanation": "List all .txt files"},
            {"code": "rm file?.log", "explanation": "Remove file1.log, file2.log, etc."},
        ],
    },
    "quoting": {
        "title": "Quoting and Escaping",
        "description": "Quoting controls how the shell interprets special characters.",
        "key_points": [
            "Single quotes: everything is literal (no expansion)",
            "Double quotes: variables and commands expand, spaces preserved",
            "Backslash: escape single character",
            "Always quote variables: \"$var\" not $var",
        ],
        "examples": [
            {"code": "echo '$HOME'", "explanation": "Prints literal $HOME"},
            {"code": "echo \"$HOME\"", "explanation": "Prints the value of HOME variable"},
        ],
    },
    "variable_expansion": {
        "title": "Variable and Parameter Expansion",
        "description": "Variables store values that can be expanded in commands. Bash provides powerful parameter expansion features.",
        "key_points": [
            "Set: VAR=value (no spaces around =)",
            "Use: $VAR or ${VAR}",
            "Export for child processes: export VAR",
            "Special variables: $?, $#, $@, $*, $$, $!",
        ],
        "expansions": {
            "${VAR:-default}": "Use default if VAR is unset or null",
            "${VAR:=default}": "Set and use default if VAR is unset or null",
            "${#VAR}": "Length of variable value",
            "${VAR%pattern}": "Remove shortest suffix match",
            "${VAR##pattern}": "Remove longest prefix match",
        },
    },
}


# =============================================================================
# CATEGORY DESCRIPTIONS
# =============================================================================

CATEGORY_DESCRIPTIONS: Dict[str, str] = {
    "File System": "Commands for navigating, viewing, creating, and managing files and directories",
    "Text Processing": "Commands for viewing, searching, filtering, and transforming text content",
    "Git": "Version control system commands for tracking changes and collaboration",
    "Package Management": "Package managers for installing, updating, and managing software dependencies",
    "Process & System": "Commands for monitoring, managing, and controlling running processes",
    "Networking": "Commands for network operations, file transfers, and remote access",
    "Permissions": "Commands for managing file ownership and access permissions",
    "Compression": "Commands for compressing, archiving, and extracting files",
    "Development": "Development tools for building, testing, and running code",
    "Shell Builtins": "Built-in shell commands for scripting and interactive use",
    "Search & Navigation": "Commands for finding files and navigating the filesystem",
}


# =============================================================================
# HELPER FUNCTIONS
# =============================================================================

def get_command_info(name: str) -> Dict[str, Any] | None:
    """Get comprehensive command information by name."""
    return COMMAND_DB.get(name)


def get_operator(symbol: str) -> Dict[str, str] | None:
    """Get operator information by symbol."""
    return OPERATORS.get(symbol)


def get_concept(name: str) -> Dict[str, Any] | None:
    """Get concept explanation by name."""
    return CONCEPTS.get(name)


def get_flags_for_command(command: str) -> Dict[str, str]:
    """Get all flags for a command."""
    cmd = COMMAND_DB.get(command, {})
    return cmd.get("flags", {})


def get_common_patterns(command: str) -> List[str]:
    """Get common usage patterns for a command."""
    cmd = COMMAND_DB.get(command, {})
    return cmd.get("common_patterns", [])


def search_commands(query: str) -> List[str]:
    """Search commands by name or description."""
    query_lower = query.lower()
    results = []
    for name, info in COMMAND_DB.items():
        if query_lower in name.lower():
            results.append(name)
        elif query_lower in info.get("description", "").lower():
            results.append(name)
    return results


def get_stats() -> Dict[str, int]:
    """Get statistics about the knowledge base."""
    total_flags = sum(len(cmd.get("flags", {})) for cmd in COMMAND_DB.values())
    total_patterns = sum(len(cmd.get("common_patterns", [])) for cmd in COMMAND_DB.values())
    return {
        "total_commands": len(COMMAND_DB),
        "total_operators": len(OPERATORS),
        "total_concepts": len(CONCEPTS),
        "total_categories": len(set(CATEGORY_MAPPINGS.keys())),
        "total_flags": total_flags,
        "total_patterns": total_patterns,
    }


if __name__ == "__main__":
    stats = get_stats()
    print("Knowledge Base Statistics:")
    print(f"  Commands in COMMAND_DB: {stats['total_commands']}")
    print(f"  Operators: {stats['total_operators']}")
    print(f"  Concepts: {stats['total_concepts']}")
    print(f"  Categories: {stats['total_categories']}")
    print(f"  Total flags documented: {stats['total_flags']}")
    print(f"  Total patterns: {stats['total_patterns']}")
